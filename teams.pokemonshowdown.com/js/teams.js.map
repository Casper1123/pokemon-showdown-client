{"version":3,"file":"teams.js","names":["PSRouter","_class","routes","_proto","prototype","setRoutes","Object","assign","redir","path","location","href","go","params","pathname","split","args","Element","k","matched","routeParts","i","length","_routeParts$i","part","startsWith","slice","trim","Config","teams","preact","render","h","document","getElementById","window","matchMedia","matches","localStorage","setItem","getItem","_document$querySelect","querySelector","classList","add","TeamViewer","TeamIndex","TeamSearcher"],"sources":["../src/teams.tsx"],"sourcesContent":["/** @jsx preact.h */\r\nimport preact from '../../play.pokemonshowdown.com/js/lib/preact';\r\nimport { TeamViewer } from './teams-view';\r\nimport { TeamIndex } from './teams-index';\r\nimport { TeamSearcher } from './teams-search';\r\n\r\ndeclare const Config: any;\r\nexport type PageProps = { args: Record<string, string> };\r\n\r\nexport const PSRouter = new class {\r\n\troutes: Record<string, (new (props: PageProps) => preact.Component<PageProps>)> = {};\r\n\r\n\tsetRoutes(routes: typeof PSRouter['routes']) {\r\n\t\tObject.assign(this.routes, routes);\r\n\t}\r\n\r\n\t// @ts-expect-error 'no reachable end point' YES THERE IS changing href stops execution after it\r\n\tredir(path: string): never {\r\n\t\tlocation.href = path;\r\n\t}\r\n\r\n\tgo() {\r\n\t\tconst params = location.pathname.split('/');\r\n\t\tlet args: PageProps['args'] = {};\r\n\t\tlet Element;\r\n\t\tfor (const k in this.routes) {\r\n\t\t\tlet matched = false;\r\n\t\t\tconst routeParts = k.split('/');\r\n\t\t\tfor (let i = 0; i < routeParts.length; i++) {\r\n\t\t\t\tconst part = params[i];\r\n\t\t\t\tif (routeParts[i].startsWith('?')) {\r\n\t\t\t\t\trouteParts[i] = routeParts[i].slice(1);\r\n\t\t\t\t\tif (!part.trim()) break; // can end here\r\n\t\t\t\t}\r\n\t\t\t\tif (routeParts[i]?.startsWith(':')) {\r\n\t\t\t\t\targs[routeParts[i].slice(1)] = part;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (part !== routeParts[i]) {\r\n\t\t\t\t\tmatched = false;\r\n\t\t\t\t\targs = {}; // don't accidentally dupe over args\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmatched = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (matched) {\r\n\t\t\t\tElement = this.routes[k];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!Element) {\r\n\t\t\tthis.redir('//' + Config.routes.teams + \"/404.html\");\r\n\t\t} else {\r\n\t\t\tpreact.render(<Element args={args} />, document.getElementById('main')!);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nif (window.matchMedia?.('(prefers-color-scheme: dark)').matches) {\r\n\tlocalStorage.setItem('darkmode', 'true');\r\n}\r\nif (localStorage.getItem('darkmode')) {\r\n\tdocument.querySelector('html')?.classList.add('dark');\r\n}\r\n\r\nPSRouter.setRoutes({\r\n\t'/view/:id': TeamViewer,\r\n\t'/': TeamIndex,\r\n\t'/search/?:type/?:val': TeamSearcher,\r\n\t'/search': TeamSearcher,\r\n\t'/browse': TeamSearcher,\r\n});\r\nPSRouter.go();\r\n"],"mappings":";;;;;;;;;AASO,GAAM,CAAAA,QAAQ,CAAG,wBAAAC,OAAA;AACvBC,MAAM,CAA4E,CAAC,CAAC,MAAAC,MAAA,CAAAF,MAAA,CAAAG,SAAA,CAAAD,MAAA;;AAEpFE,SAAS,CAAT,SAAAA,SAASA,CAACH,MAAiC,CAAE;AAC5CI,MAAM,CAACC,MAAM,CAAC,IAAI,CAACL,MAAM,CAAEA,MAAM,CAAC;AACnC,CAAC,CAAAC,MAAA;;;AAGDK,KAAK,CAAL,SAAAA,KAAKA,CAACC,IAAY,CAAS;AAC1BC,QAAQ,CAACC,IAAI,CAAGF,IAAI;AACrB,CAAC,CAAAN,MAAA;;AAEDS,EAAE,CAAF,SAAAA,EAAEA,CAAA,CAAG;AACJ,GAAM,CAAAC,MAAM,CAAGH,QAAQ,CAACI,QAAQ,CAACC,KAAK,CAAC,GAAG,CAAC;AAC3C,GAAI,CAAAC,IAAuB,CAAG,CAAC,CAAC;AAChC,GAAI,CAAAC,OAAO;AACX,IAAK,GAAM,CAAAC,CAAC,GAAI,KAAI,CAAChB,MAAM,CAAE;AAC5B,GAAI,CAAAiB,OAAO,CAAG,KAAK;AACnB,GAAM,CAAAC,UAAU,CAAGF,CAAC,CAACH,KAAK,CAAC,GAAG,CAAC;AAC/B,IAAK,GAAI,CAAAM,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGD,UAAU,CAACE,MAAM,CAAED,CAAC,EAAE,CAAE,KAAAE,aAAA;AAC3C,GAAM,CAAAC,IAAI,CAAGX,MAAM,CAACQ,CAAC,CAAC;AACtB,GAAID,UAAU,CAACC,CAAC,CAAC,CAACI,UAAU,CAAC,GAAG,CAAC,CAAE;AAClCL,UAAU,CAACC,CAAC,CAAC,CAAGD,UAAU,CAACC,CAAC,CAAC,CAACK,KAAK,CAAC,CAAC,CAAC;AACtC,GAAI,CAACF,IAAI,CAACG,IAAI,CAAC,CAAC,CAAE;AACnB;AACA,IAAAJ,aAAA,CAAIH,UAAU,CAACC,CAAC,CAAC,SAAbE,aAAA,CAAeE,UAAU,CAAC,GAAG,CAAC,CAAE;AACnCT,IAAI,CAACI,UAAU,CAACC,CAAC,CAAC,CAACK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAGF,IAAI;AACnC;AACD;AACA,GAAIA,IAAI,GAAKJ,UAAU,CAACC,CAAC,CAAC,CAAE;AAC3BF,OAAO,CAAG,KAAK;AACfH,IAAI,CAAG,CAAC,CAAC;AACT;AACD,CAAC,IAAM;AACNG,OAAO,CAAG,IAAI;AACf;AACD;AACA,GAAIA,OAAO,CAAE;AACZF,OAAO,CAAG,IAAI,CAACf,MAAM,CAACgB,CAAC,CAAC;AACxB;AACD;AACD;AACA,GAAI,CAACD,OAAO,CAAE;AACb,IAAI,CAACT,KAAK,CAAC,IAAI,CAAGoB,MAAM,CAAC1B,MAAM,CAAC2B,KAAK,CAAG,WAAW,CAAC;AACrD,CAAC,IAAM;AACNC,MAAM,CAACC,MAAM,CAACD,MAAA,CAAAE,CAAA,CAACf,OAAO,EAACD,IAAI,CAAEA,IAAK,CAAE,CAAC,CAAEiB,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAE,CAAC;AACzE;AACD,CAAC,QAAAjC,MAAA;AACF,CAAC;;AAED,GAAIkC,MAAM,CAACC,UAAU,QAAjBD,MAAM,CAACC,UAAU,CAAG,8BAA8B,CAAC,CAACC,OAAO,CAAE;AAChEC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAE,MAAM,CAAC;AACzC;AACA,GAAID,YAAY,CAACE,OAAO,CAAC,UAAU,CAAC,CAAE,KAAAC,qBAAA;AACrC,CAAAA,qBAAA,CAAAR,QAAQ,CAACS,aAAa,CAAC,MAAM,CAAC,SAA9BD,qBAAA,CAAgCE,SAAS,CAACC,GAAG,CAAC,MAAM,CAAC;AACtD;;AAEA5C,QAAQ,CAACK,SAAS,CAAC;AAClB,WAAW,CAAEwC,UAAU;AACvB,GAAG,CAAEC,SAAS;AACd,sBAAsB,CAAEC,YAAY;AACpC,SAAS,CAAEA,YAAY;AACvB,SAAS,CAAEA;AACZ,CAAC,CAAC;AACF/C,QAAQ,CAACY,EAAE,CAAC,CAAC","ignoreList":[]}