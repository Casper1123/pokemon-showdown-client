{"version":3,"file":"panel-battle.js","names":["BattlesRoom","_PSRoom","options","_this","call","classType","format","filters","battles","refresh","PS","prefs","bwgfx","Dex","loadSpriteData","_inheritsLoose","_proto","prototype","setFormat","update","send","toID","PSRoom","BattlesPanel","_PSRoomPanel","_this2","_len","arguments","length","args","Array","_key","apply","concat","props","room","changeFormat","e","value","target","applyFilters","_this2$base","_this2$base2","preventDefault","minElo","base","querySelector","searchPrefix","_proto2","renderBattleLink","battle","id","split","minEloMessage","preact","h","key","href","style","p1","p2","render","_this3","PSPanelWrapper","scrollable","name","onClick","getPokemonIcon","title","FormatDropdown","onChange","placeholder","onSubmit","type","Fragment","map","PSRoomPanel","routes","Model","location","icon","BattleRoom","_ChatRoom","_this4","_len2","_key2","side","request","choices","autoTimerActivated","_proto3","loadReplay","_this5","replayid","slice","Net","get","then","data","replay","JSON","parse","players","join","stepQueue","log","atQueueEnd","pause","seekTurn","connected","_unused","receiveLine","ChatRoom","BattleDiv","_preact$Component","_proto4","shouldComponentUpdate","componentDidMount","replaceChild","scene","$frame","firstChild","Component","TimerButton","_preact$Component2","_this6","_len3","_key3","timerInterval","_proto5","componentWillUnmount","clearInterval","secondsToTime","seconds","minutes","Math","floor","_this7","time","kickingInactive","setInterval","graceTimeLeft","totalTimeLeft","forceUpdate","timerTicking","requestType","isDone","secondsLeft","totalTime","position","right","role","BattlePanel","_PSRoomPanel2","_this8","_len4","_key4","team","text","elem","focusIfNoSelection","_window$getSelection","window","getSelection","focus","onKey","keyCode","chatLog","getElementsByClassName","scrollTop","offsetHeight","toggleBoostedMove","checkbox","currentTarget","current","mega","checked","megax","megay","ultra","z","max","tera","battleHeight","handleDownloadReplay","filename","tier","replace","date","Date","getFullYear","getMonth","getDate","BattleLog","createReplayFileHref","download","stopPropagation","handleDrop","ev","_ev$dataTransfer","file","dataTransfer","files","roomNum","rooms","html","titleStart","indexOf","titleEnd","colonIndex","hyphenIndex","lastIndexOf","substring","index1","index2","alert","index3","receive","_proto6","_room$backlog","_this9","$elem","$","formatId","startsWith","idChunks","Battle","find","$logFrame","backlog","getHighlight","handleHighlight","tooltips","listen","Infinity","FormatModMapping","modId","dex","mod","console","debug","modid","forFormat","subscribe","updateLayout","width","offsetWidth","_room$battle","scale","css","round","_room$battle2","receiveRequest","instantAdd","BattleChoiceBuilder","add","noanim","autotimer","fixRequest","myPokemon","pokemon","setViewpoint","notifyRequest","_room$request","oName","farSide","notify","body","renderControls","ended","renderAfterBattleControls","renderPlayerControls","atStart","started","atEnd","paused","renderMoveButton","disabled","pp","moveData","maxpp","cmd","tooltip","renderPokemonButton","hpColorClass","BattleScene","getHPColor","PSIcon","noHPBar","fainted","hp","maxhp","status","renderMoveMenu","moveRequest","currentMoveRequest","canDynamax","alreadyMax","canMegaEvo","alreadyMega","canMegaEvoX","canMegaEvoY","canZMove","zMoves","alreadyZ","canUltraBurst","canTerastallize","maybeDisabled","maybeLocked","renderMoveControls","gigantamax","dangerouslySetInnerHTML","__html","getTypeIcon","active","_this0","pokemonIndex","index","activeIndex","mySide","n","pokemonControlled","serverPokemon","valueTracker","ModifiableValue","nearSide","maxMoves","gmax","moves","i","move","moveType","getMoveType","maxMoveData","getMaxMoveFromType","gmaxTooltip","zMoveData","specialMove","exists","special","moveSpecial","renderMoveTargetControls","_choices$currentMove","_this1","moveTarget","currentMove","gameType","moveChoice","stringChoice","userSlot","userSlotCross","_pokemon","abs","reverse","_pokemon2","renderSwitchMenu","ignoreTrapping","_choices$currentMoveR","_choices$currentMoveR2","_this10","numActive","requestLength","maybeTrapped","trapped","cantSwitch","alreadySwitchingIn","includes","renderTeamPreviewChooser","_this11","renderTeamList","_this12","renderChosenTeam","_this13","slot","renderOldChoices","isEmpty","buf","noCancel","choiceString","push","choice","parseChoice","err","message","choiceType","_choices$currentMove2","targetLoc","targetPokemon","renderPlayerWaitingControls","_choices$currentMove3","moveName","canShift","isNotTiny","Config","replays","_room$battle3","hardcoreStyle","hardcoreMode","focusClick","ChatLog","top","noSubscription","ChatTextEntry","onMessage","left","ChatUserList","minimized","user","userid","addRoomType"],"sources":["../src/panel-battle.tsx"],"sourcesContent":["/**\r\n * Battle panel\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\nimport preact from \"../js/lib/preact\";\r\nimport { PS, PSRoom, type RoomOptions, type RoomID, Config } from \"./client-main\";\r\nimport { PSIcon, PSPanelWrapper, PSRoomPanel } from \"./panels\";\r\nimport { ChatLog, ChatRoom, ChatTextEntry, ChatUserList } from \"./panel-chat\";\r\nimport { FormatDropdown } from \"./panel-mainmenu\";\r\nimport { Battle, type Pokemon, type ServerPokemon } from \"./battle\";\r\nimport { BattleScene } from \"./battle-animations\";\r\nimport { Dex, toID, type ID } from \"./battle-dex\";\r\nimport {\r\n\tBattleChoiceBuilder, type BattleRequestActivePokemon, type BattleRequestSideInfo,\r\n\ttype BattleRequest, type BattleMoveRequest, type BattleSwitchRequest, type BattleTeamRequest,\r\n} from \"./battle-choices\";\r\nimport type { Args } from \"./battle-text-parser\";\r\nimport { ModifiableValue } from \"./battle-tooltips\";\r\nimport { Net } from \"./client-connection\";\r\n\r\ntype BattleDesc = {\r\n\tid: RoomID,\r\n\tminElo?: number | string,\r\n\tp1?: string,\r\n\tp2?: string,\r\n\tp3?: string,\r\n\tp4?: string,\r\n};\r\n\r\nexport class BattlesRoom extends PSRoom {\r\n\toverride readonly classType = 'battles';\r\n\t/** null means still loading */\r\n\tformat = '';\r\n\tfilters = '';\r\n\tbattles: BattleDesc[] | null = null;\r\n\tconstructor(options: RoomOptions) {\r\n\t\tsuper(options);\r\n\t\tthis.refresh();\r\n\t\t// If graphics preference is set to use BW sprites\r\n\t\tif (PS.prefs.bwgfx) {\r\n\t\t\tDex.loadSpriteData('bw');\r\n\t\t}\r\n\t}\r\n\tsetFormat(format: string) {\r\n\t\tif (format === this.format) return this.refresh();\r\n\t\tthis.battles = null;\r\n\t\tthis.format = format;\r\n\t\tthis.update(null);\r\n\t\tthis.refresh();\r\n\t}\r\n\trefresh() {\r\n\t\tPS.send(`/cmd roomlist ${toID(this.format)}, ${this.filters}`);\r\n\t}\r\n}\r\n\r\nclass BattlesPanel extends PSRoomPanel<BattlesRoom> {\r\n\tstatic readonly id = 'battles';\r\n\tstatic readonly routes = ['battles'];\r\n\tstatic readonly Model = BattlesRoom;\r\n\tstatic readonly location = 'right';\r\n\tstatic readonly icon = <i class=\"fa fa-caret-square-o-right\" aria-hidden></i>;\r\n\tstatic readonly title = 'Battles';\r\n\trefresh = () => {\r\n\t\tthis.props.room.refresh();\r\n\t};\r\n\tchangeFormat = (e: Event) => {\r\n\t\tconst value = (e.target as HTMLButtonElement).value;\r\n\t\tthis.props.room.setFormat(value);\r\n\t};\r\n\tapplyFilters = (e: Event) => {\r\n\t\te.preventDefault();\r\n\t\tconst minElo = this.base?.querySelector<HTMLInputElement>(`select[name=elofilter]`)?.value;\r\n\t\tconst searchPrefix = this.base?.querySelector<HTMLInputElement>(`input[name=prefixsearch]`)?.value;\r\n\t\tthis.props.room.filters = `${minElo || ''},${searchPrefix || ''}`;\r\n\t\tthis.refresh();\r\n\t};\r\n\trenderBattleLink(battle: BattleDesc) {\r\n\t\tconst format = battle.id.split('-')[1];\r\n\t\tconst minEloMessage = typeof battle.minElo === 'number' ? `rated ${battle.minElo}` : battle.minElo;\r\n\t\treturn <div key={battle.id}><a href={`/${battle.id}`} class=\"blocklink\">\r\n\t\t\t{minEloMessage && <small style=\"float:right\">({minEloMessage})</small>}\r\n\t\t\t<small>[{format}]</small><br />\r\n\t\t\t<em class=\"p1\">{battle.p1}</em> <small class=\"vs\">vs.</small> <em class=\"p2\">{battle.p2}</em>\r\n\t\t</a></div>;\r\n\t}\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\treturn <PSPanelWrapper room={room} scrollable><div class=\"pad\">\r\n\t\t\t<button class=\"button\" style=\"float:right;font-size:10pt;margin-top:3px\" name=\"closeRoom\">\r\n\t\t\t\t<i class=\"fa fa-times\" aria-hidden></i> Close\r\n\t\t\t</button>\r\n\t\t\t<div class=\"roomlist\">\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<button class=\"button\" name=\"refresh\" onClick={this.refresh}>\r\n\t\t\t\t\t\t<i class=\"fa fa-refresh\" aria-hidden></i> Refresh\r\n\t\t\t\t\t</button> {}\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tstyle={Dex.getPokemonIcon('meloetta-pirouette') + ';display:inline-block;vertical-align:middle'} class=\"picon\"\r\n\t\t\t\t\t\ttitle=\"Meloetta is PS's mascot! The Pirouette forme is Fighting-type, and represents our battles.\"\r\n\t\t\t\t\t></span>\r\n\t\t\t\t</p>\r\n\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<label class=\"label\">Format:</label><FormatDropdown onChange={this.changeFormat} placeholder=\"(All formats)\" />\r\n\t\t\t\t</p>\r\n\t\t\t\t<label>\r\n\t\t\t\t\tMinimum Elo: <select name=\"elofilter\" onChange={this.applyFilters}>\r\n\t\t\t\t\t\t<option value=\"none\">None</option><option value=\"1100\">1100</option><option value=\"1300\">1300</option>\r\n\t\t\t\t\t\t<option value=\"1500\">1500</option><option value=\"1700\">1700</option><option value=\"1900\">1900</option>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</label>\r\n\r\n\t\t\t\t<form class=\"search\" onSubmit={this.applyFilters}>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<input type=\"text\" name=\"prefixsearch\" class=\"textbox\" placeholder=\"Username prefix\" />\r\n\t\t\t\t\t\t<button type=\"submit\" class=\"button\">Search</button>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</form>\r\n\t\t\t\t<div class=\"list\">{!room.battles ? (\r\n\t\t\t\t\t<p>Loading...</p>\r\n\t\t\t\t) : !room.battles.length ? (\r\n\t\t\t\t\t<p>No battles are going on</p>\r\n\t\t\t\t) : (<>\r\n\t\t\t\t\t<p>{room.battles.length === 100 ?\r\n\t\t\t\t\t\t`100+` : room.battles.length} {room.battles.length > 1 ? `battles` : `battle`}</p>\r\n\t\t\t\t\t{room.battles.map(battle => this.renderBattleLink(battle))}\r\n\t\t\t\t</>\r\n\t\t\t\t)}</div>\r\n\t\t\t</div>\r\n\t\t</div></PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nexport class BattleRoom extends ChatRoom {\r\n\toverride readonly classType = 'battle';\r\n\tdeclare pmTarget: null;\r\n\tdeclare challengeMenuOpen: false;\r\n\tdeclare challengingFormat: null;\r\n\tdeclare challengedFormat: null;\r\n\r\n\toverride battle: Battle = null!;\r\n\t/** null if spectator, otherwise current player's info */\r\n\tside: BattleRequestSideInfo | null = null;\r\n\trequest: BattleRequest | null = null;\r\n\tchoices: BattleChoiceBuilder | null = null;\r\n\tautoTimerActivated: boolean | null = null;\r\n\r\n\tloadReplay() {\r\n\t\tconst replayid = this.id.slice(7);\r\n\t\tNet(`https://replay.pokemonshowdown.com/${replayid}.json`).get().catch().then(data => {\r\n\t\t\ttry {\r\n\t\t\t\tconst replay = JSON.parse(data);\r\n\t\t\t\tthis.title = `[${replay.format}] ${replay.players.join(' vs. ')}`;\r\n\t\t\t\tthis.battle.stepQueue = replay.log.split('\\n');\r\n\t\t\t\tthis.battle.atQueueEnd = false;\r\n\t\t\t\tthis.battle.pause();\r\n\t\t\t\tthis.battle.seekTurn(0);\r\n\t\t\t\tthis.connected = 'client-only';\r\n\t\t\t\tthis.update(null);\r\n\t\t\t} catch {\r\n\t\t\t\tthis.receiveLine(['error', 'Battle not found']);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nclass BattleDiv extends preact.Component<{ room: BattleRoom }> {\r\n\toverride shouldComponentUpdate() {\r\n\t\treturn false;\r\n\t}\r\n\toverride componentDidMount() {\r\n\t\tconst room = this.props.room;\r\n\t\tif (room.battle) {\r\n\t\t\tthis.base!.replaceChild(room.battle.scene.$frame![0], this.base!.firstChild!);\r\n\t\t}\r\n\t}\r\n\toverride render() {\r\n\t\treturn <div><div class=\"battle\"></div></div>;\r\n\t}\r\n}\r\n\r\nclass TimerButton extends preact.Component<{ room: BattleRoom }> {\r\n\ttimerInterval: number | null = null;\r\n\toverride componentWillUnmount() {\r\n\t\tif (this.timerInterval) {\r\n\t\t\tclearInterval(this.timerInterval);\r\n\t\t\tthis.timerInterval = null;\r\n\t\t}\r\n\t}\r\n\tsecondsToTime(seconds: number | true) {\r\n\t\tif (seconds === true) return '-:--';\r\n\t\tconst minutes = Math.floor(seconds / 60);\r\n\t\tseconds -= minutes * 60;\r\n\t\treturn `${minutes}:${(seconds < 10 ? '0' : '')}${seconds}`;\r\n\t}\r\n\trender() {\r\n\t\tlet time = 'Timer';\r\n\t\tconst room = this.props.room;\r\n\t\tif (!this.timerInterval && room.battle.kickingInactive) {\r\n\t\t\t// @ts-ignore\r\n\t\t\tthis.timerInterval = setInterval(() => {\r\n\t\t\t\tif (typeof room.battle.kickingInactive === 'number' && room.battle.kickingInactive > 1) {\r\n\t\t\t\t\troom.battle.kickingInactive--;\r\n\t\t\t\t\tif (room.battle.graceTimeLeft) room.battle.graceTimeLeft--;\r\n\t\t\t\t\telse if (room.battle.totalTimeLeft) room.battle.totalTimeLeft--;\r\n\t\t\t\t}\r\n\t\t\t\tthis.forceUpdate();\r\n\t\t\t}, 1000);\r\n\t\t} else if (this.timerInterval && !room.battle.kickingInactive) {\r\n\t\t\tclearInterval(this.timerInterval);\r\n\t\t\tthis.timerInterval = null;\r\n\t\t}\r\n\r\n\t\tlet timerTicking = (room.battle.kickingInactive &&\r\n\t\t\troom.request && room.request.requestType !== \"wait\" && (room.choices && !room.choices.isDone())) ?\r\n\t\t\t' timerbutton-on' : '';\r\n\r\n\t\tif (room.battle.kickingInactive) {\r\n\t\t\tconst secondsLeft = room.battle.kickingInactive;\r\n\t\t\ttime = this.secondsToTime(secondsLeft);\r\n\t\t\tif (secondsLeft !== true) {\r\n\t\t\t\tif (secondsLeft <= 10 && timerTicking) {\r\n\t\t\t\t\ttimerTicking = ' timerbutton-critical';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (room.battle.totalTimeLeft) {\r\n\t\t\t\t\tconst totalTime = this.secondsToTime(room.battle.totalTimeLeft);\r\n\t\t\t\t\ttime += ` |  ${totalTime} total`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn <button\r\n\t\t\tstyle={{ position: \"absolute\", right: '10px' }} data-href=\"battletimer\" class={`button${timerTicking}`} role=\"timer\"\r\n\t\t>\r\n\t\t\t<i class=\"fa fa-hourglass-start\" aria-hidden></i> {time}\r\n\t\t</button>;\r\n\t}\r\n};\r\n\r\nclass BattlePanel extends PSRoomPanel<BattleRoom> {\r\n\tstatic readonly id = 'battle';\r\n\tstatic readonly routes = ['battle-*'];\r\n\tstatic readonly Model = BattleRoom;\r\n\tstatic handleDrop(ev: DragEvent) {\r\n\t\tconst file = ev.dataTransfer?.files?.[0];\r\n\t\tif (file?.type === 'text/html') {\r\n\t\t\tlet roomNum = 1;\r\n\t\t\tfor (; roomNum < 100; roomNum++) {\r\n\t\t\t\tif (!PS.rooms[`battle-uploaded-${roomNum}`]) break;\r\n\t\t\t}\r\n\t\t\tfile.text().then(html => {\r\n\t\t\t\tconst titleStart = html.indexOf('<title>');\r\n\t\t\t\tconst titleEnd = html.indexOf('</title>');\r\n\t\t\t\tlet title = 'Uploaded Replay';\r\n\t\t\t\tif (titleStart >= 0 && titleEnd > titleStart) {\r\n\t\t\t\t\ttitle = html.slice(titleStart + 7, titleEnd - 1);\r\n\t\t\t\t\tconst colonIndex = title.indexOf(':');\r\n\t\t\t\t\tconst hyphenIndex = title.lastIndexOf('-');\r\n\t\t\t\t\tif (hyphenIndex > colonIndex + 2) {\r\n\t\t\t\t\t\ttitle = title.substring(colonIndex + 2, hyphenIndex - 1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttitle = title.substring(colonIndex + 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconst index1 = html.indexOf('<script type=\"text/plain\" class=\"battle-log-data\">');\r\n\t\t\t\tconst index2 = html.indexOf('<script type=\"text/plain\" class=\"log\">');\r\n\t\t\t\tif (index1 < 0 && index2 < 0) {\r\n\t\t\t\t\tPS.alert(\"Unrecognized HTML file: Only replay files are supported.\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (index1 >= 0) {\r\n\t\t\t\t\thtml = html.slice(index1 + 50);\r\n\t\t\t\t} else if (index2 >= 0) {\r\n\t\t\t\t\thtml = html.slice(index2 + 38);\r\n\t\t\t\t}\r\n\t\t\t\tconst index3 = html.indexOf('</script>');\r\n\t\t\t\thtml = html.slice(0, index3);\r\n\t\t\t\thtml = html.replace(/\\\\\\//g, '/');\r\n\r\n\t\t\t\tPS.join(`battle-uploaded-${roomNum}` as RoomID);\r\n\t\t\t\tconst room = PS.rooms[`battle-uploaded-${roomNum}`] as BattleRoom;\r\n\t\t\t\tif (!room) return;\r\n\r\n\t\t\t\troom.title = title;\r\n\t\t\t\troom.connected = 'client-only';\r\n\t\t\t\tPS.receive(`>battle-uploaded-${roomNum}\\n${html}`);\r\n\t\t\t});\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\t/** last displayed team. will not show the most recent request until the last one is gone. */\r\n\tteam: ServerPokemon[] | null = null;\r\n\tsend = (text: string, elem?: HTMLElement) => {\r\n\t\tthis.props.room.send(text, elem);\r\n\t};\r\n\tfocusIfNoSelection = () => {\r\n\t\tif (window.getSelection?.()?.type === 'Range') return;\r\n\t\tthis.focus();\r\n\t};\r\n\tonKey = (e: KeyboardEvent) => {\r\n\t\tif (e.keyCode === 33) { // Pg Up key\r\n\t\t\tconst chatLog = this.base!.getElementsByClassName('chat-log')[0] as HTMLDivElement;\r\n\t\t\tchatLog.scrollTop = chatLog.scrollTop - chatLog.offsetHeight + 60;\r\n\t\t\treturn true;\r\n\t\t} else if (e.keyCode === 34) { // Pg Dn key\r\n\t\t\tconst chatLog = this.base!.getElementsByClassName('chat-log')[0] as HTMLDivElement;\r\n\t\t\tchatLog.scrollTop = chatLog.scrollTop + chatLog.offsetHeight - 60;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\ttoggleBoostedMove = (e: Event) => {\r\n\t\tconst checkbox = e.currentTarget as HTMLInputElement;\r\n\t\tconst choices = this.props.room.choices;\r\n\t\tif (!choices) return; // shouldn't happen\r\n\t\tswitch (checkbox.name) {\r\n\t\tcase 'mega':\r\n\t\t\tchoices.current.mega = checkbox.checked;\r\n\t\t\tbreak;\r\n\t\tcase 'megax':\r\n\t\t\tchoices.current.megax = checkbox.checked;\r\n\t\t\tchoices.current.megay = false;\r\n\t\t\tbreak;\r\n\t\tcase 'megay':\r\n\t\t\tchoices.current.megay = checkbox.checked;\r\n\t\t\tchoices.current.megax = false;\r\n\t\t\tbreak;\r\n\t\tcase 'ultra':\r\n\t\t\tchoices.current.ultra = checkbox.checked;\r\n\t\t\tbreak;\r\n\t\tcase 'z':\r\n\t\t\tchoices.current.z = checkbox.checked;\r\n\t\t\tbreak;\r\n\t\tcase 'max':\r\n\t\t\tchoices.current.max = checkbox.checked;\r\n\t\t\tbreak;\r\n\t\tcase 'tera':\r\n\t\t\tchoices.current.tera = checkbox.checked;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.props.room.update(null);\r\n\t};\r\n\toverride componentDidMount() {\r\n\t\tconst room = this.props.room;\r\n\t\tconst $elem = $(this.base!);\r\n\r\n\t\tlet formatId = room.id as string;\r\n\t\tif (room.id.startsWith('battle-')) {\r\n\t\t\tconst idChunks = room.id.slice(7).split('-');\r\n\t\t\tformatId = idChunks[0];\r\n\t\t}\r\n\r\n\t\tconst battle = (room.battle ||= new Battle({\r\n\t\t\tid: room.id as any,\r\n\t\t\t$frame: $elem.find('.battle'),\r\n\t\t\t$logFrame: $elem.find('.battle-log'),\r\n\t\t\tlog: room.backlog?.map(args => '|' + args.join('|')),\r\n\t\t\tformatId: formatId\r\n\t\t}));\r\n\r\n\t\tconst scene = battle.scene as BattleScene;\r\n\t\troom.backlog = null;\r\n\t\troom.log ||= scene.log;\r\n\t\troom.log.getHighlight = room.handleHighlight;\r\n\t\tscene.tooltips.listen($elem.find('.battle-controls-container'));\r\n\t\tscene.tooltips.listen(scene.log.elem);\r\n\t\tsuper.componentDidMount();\r\n\t\tbattle.seekTurn(Infinity);\r\n\r\n\t\tif (window.FormatModMapping && window.FormatModMapping[formatId]) {\r\n\t\t\tconst modId = window.FormatModMapping[formatId];\r\n\t\t\tbattle.dex = Dex.mod(modId);\r\n\t\t\tconsole.debug('Battle dex set to custom mod:', battle.dex.modid, 'for format:', formatId);\r\n\t\t} else {\r\n\t\t\tbattle.dex = Dex.forFormat(formatId);\r\n\t\t\tconsole.debug('Using default dex for format:', formatId);\r\n\t\t}\r\n\t\tbattle.subscribe(() => this.forceUpdate());\r\n\r\n\t}\r\n\tbattleHeight = 360;\r\n\tupdateLayout() {\r\n\t\tif (!this.base) return;\r\n\t\tconst room = this.props.room;\r\n\t\tconst width = this.base.offsetWidth;\r\n\t\tif (width && width < 640) {\r\n\t\t\tconst scale = (width / 640);\r\n\t\t\troom.battle?.scene.$frame!.css('transform', `scale(${scale})`);\r\n\t\t\tthis.battleHeight = Math.round(360 * scale);\r\n\t\t} else {\r\n\t\t\troom.battle?.scene.$frame!.css('transform', 'none');\r\n\t\t\tthis.battleHeight = 360;\r\n\t\t}\r\n\t}\r\n\toverride receiveLine(args: Args) {\r\n\t\tconst room = this.props.room;\r\n\t\tswitch (args[0]) {\r\n\t\tcase 'initdone':\r\n\t\t\troom.battle.seekTurn(Infinity);\r\n\t\t\treturn;\r\n\t\tcase 'request':\r\n\t\t\tthis.receiveRequest(args[1] ? JSON.parse(args[1]) : null);\r\n\t\t\treturn;\r\n\t\tcase 'win': case 'tie':\r\n\t\t\tthis.receiveRequest(null);\r\n\t\t\tbreak;\r\n\t\tcase 'c': case 'c:': case 'chat': case 'chatmsg': case 'inactive':\r\n\t\t\troom.battle.instantAdd('|' + args.join('|'));\r\n\t\t\treturn;\r\n\t\tcase 'error':\r\n\t\t\tif (args[1].startsWith('[Invalid choice]') && room.request) {\r\n\t\t\t\troom.choices = new BattleChoiceBuilder(room.request);\r\n\t\t\t\troom.update(null);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\troom.battle.add('|' + args.join('|'));\r\n\t\tif (PS.prefs.noanim) this.props.room.battle.seekTurn(Infinity);\r\n\t}\r\n\treceiveRequest(request: BattleRequest | null) {\r\n\t\tconst room = this.props.room;\r\n\t\tif (!request) {\r\n\t\t\troom.request = null;\r\n\t\t\troom.choices = null;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (PS.prefs.autotimer && !room.battle.kickingInactive && !room.autoTimerActivated) {\r\n\t\t\tthis.send('/timer on');\r\n\t\t\troom.autoTimerActivated = true;\r\n\t\t}\r\n\r\n\t\tBattleChoiceBuilder.fixRequest(request, room.battle);\r\n\r\n\t\tif (request.side) {\r\n\t\t\troom.battle.myPokemon = request.side.pokemon;\r\n\t\t\troom.battle.setViewpoint(request.side.id);\r\n\t\t\troom.side = request.side;\r\n\t\t}\r\n\r\n\t\troom.request = request;\r\n\t\troom.choices = new BattleChoiceBuilder(request);\r\n\t\tthis.notifyRequest();\r\n\t\troom.update(null);\r\n\t}\r\n\tnotifyRequest() {\r\n\t\tconst room = this.props.room;\r\n\t\tlet oName = room.battle.farSide.name;\r\n\t\tif (oName) oName = \" against \" + oName;\r\n\t\tswitch (room.request?.requestType) {\r\n\t\tcase 'move':\r\n\t\t\troom.notify({ title: \"Your move!\", body: \"Move in your battle\" + oName });\r\n\t\t\tbreak;\r\n\t\tcase 'switch':\r\n\t\t\troom.notify({ title: \"Your switch!\", body: \"Switch in your battle\" + oName });\r\n\t\t\tbreak;\r\n\t\tcase 'team':\r\n\t\t\troom.notify({ title: \"Team preview!\", body: \"Choose your team order in your battle\" + oName });\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\trenderControls() {\r\n\t\tconst room = this.props.room;\r\n\t\tif (!room.battle) return null;\r\n\t\tif (room.battle.ended) return this.renderAfterBattleControls();\r\n\t\tif (room.side && room.request) {\r\n\t\t\treturn this.renderPlayerControls(room.request);\r\n\t\t}\r\n\t\tconst atStart = !room.battle.started;\r\n\t\tconst atEnd = room.battle.atQueueEnd;\r\n\t\treturn <div class=\"controls\">\r\n\t\t\t<p>\r\n\t\t\t\t{atEnd ? (\r\n\t\t\t\t\t<button class=\"button disabled\" aria-disabled data-cmd=\"/play\" style=\"min-width:4.5em\">\r\n\t\t\t\t\t\t<i class=\"fa fa-play\" aria-hidden></i><br />Play\r\n\t\t\t\t\t</button>\r\n\t\t\t\t) : room.battle.paused ? (\r\n\t\t\t\t\t<button class=\"button\" data-cmd=\"/play\" style=\"min-width:4.5em\">\r\n\t\t\t\t\t\t<i class=\"fa fa-play\" aria-hidden></i><br />Play\r\n\t\t\t\t\t</button>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<button class=\"button\" data-cmd=\"/pause\" style=\"min-width:4.5em\">\r\n\t\t\t\t\t\t<i class=\"fa fa-pause\" aria-hidden></i><br />Pause\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)} {}\r\n\t\t\t\t<button class={\"button button-first\" + (atStart ? \" disabled\" : \"\")} data-cmd=\"/ffto 0\" style=\"margin-right:2px\">\r\n\t\t\t\t\t<i class=\"fa fa-undo\" aria-hidden></i><br />First turn\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class={\"button button-first\" + (atStart ? \" disabled\" : \"\")} data-cmd=\"/ffto -1\">\r\n\t\t\t\t\t<i class=\"fa fa-step-backward\" aria-hidden></i><br />Prev turn\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class={\"button button-last\" + (atEnd ? \" disabled\" : \"\")} data-cmd=\"/ffto +1\" style=\"margin-right:2px\">\r\n\t\t\t\t\t<i class=\"fa fa-step-forward\" aria-hidden></i><br />Skip turn\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class={\"button button-last\" + (atEnd ? \" disabled\" : \"\")} data-cmd=\"/ffto end\">\r\n\t\t\t\t\t<i class=\"fa fa-fast-forward\" aria-hidden></i><br />Skip to end\r\n\t\t\t\t</button>\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t<button class=\"button\" data-cmd=\"/switchsides\">\r\n\t\t\t\t\t<i class=\"fa fa-random\" aria-hidden></i> Switch viewpoint\r\n\t\t\t\t</button>\r\n\t\t\t</p>\r\n\t\t</div>;\r\n\t}\r\n\trenderMoveButton(props: {\r\n\t\tname: string,\r\n\t\tcmd: string, type: Dex.TypeName, tooltip: string, moveData: { pp?: number, maxpp?: number, disabled?: boolean },\r\n\t} | null) {\r\n\t\tif (!props) {\r\n\t\t\treturn <button class=\"movebutton\" disabled>&nbsp;</button>;\r\n\t\t}\r\n\t\tconst pp = props.moveData.maxpp ? `${props.moveData.pp!}/${props.moveData.maxpp}` : '\\u2014';\r\n\t\treturn <button\r\n\t\t\tdata-cmd={props.cmd} data-tooltip={props.tooltip}\r\n\t\t\tclass={`movebutton has-tooltip ${props.moveData.disabled ? 'disabled' : `type-${props.type}`}`}\r\n\t\t\taria-disabled={props.moveData.disabled}\r\n\t\t>\r\n\t\t\t{props.name}<br />\r\n\t\t\t<small class=\"type\">{props.type}</small> <small class=\"pp\">{pp}</small>&nbsp;\r\n\t\t</button>;\r\n\t}\r\n\trenderPokemonButton(props: {\r\n\t\tpokemon: Pokemon | ServerPokemon | null, cmd: string, noHPBar?: boolean, disabled?: boolean | 'fade', tooltip: string,\r\n\t}) {\r\n\t\tconst pokemon = props.pokemon;\r\n\t\tif (!pokemon) {\r\n\t\t\treturn <button\r\n\t\t\t\tdata-cmd={props.cmd} class={`${props.disabled ? 'disabled ' : ''}has-tooltip`}\r\n\t\t\t\taria-disabled={props.disabled}\r\n\t\t\t\tstyle={props.disabled === 'fade' ? 'opacity: 0.5' : ''} data-tooltip={props.tooltip}\r\n\t\t\t>\r\n\t\t\t\t(empty slot)\r\n\t\t\t</button>;\r\n\t\t}\r\n\r\n\t\tlet hpColorClass;\r\n\t\tswitch (BattleScene.getHPColor(pokemon)) {\r\n\t\tcase 'y': hpColorClass = 'hpbar hpbar-yellow'; break;\r\n\t\tcase 'r': hpColorClass = 'hpbar hpbar-red'; break;\r\n\t\tdefault: hpColorClass = 'hpbar'; break;\r\n\t\t}\r\n\r\n\t\treturn <button\r\n\t\t\tdata-cmd={props.cmd} class={`${props.disabled ? 'disabled ' : ''}has-tooltip`}\r\n\t\t\taria-disabled={props.disabled}\r\n\t\t\tstyle={props.disabled === 'fade' ? 'opacity: 0.5' : ''} data-tooltip={props.tooltip}\r\n\t\t>\r\n\t\t\t{PSIcon({ pokemon })}\r\n\t\t\t{pokemon.name}\r\n\t\t\t{\r\n\t\t\t\t!props.noHPBar && !pokemon.fainted &&\r\n\t\t\t\t<span class={hpColorClass}>\r\n\t\t\t\t\t<span style={{ width: Math.round(pokemon.hp * 92 / pokemon.maxhp) || 1 }}></span>\r\n\t\t\t\t</span>\r\n\t\t\t}\r\n\t\t\t{!props.noHPBar && pokemon.status && <span class={`status ${pokemon.status}`}></span>}\r\n\t\t</button>;\r\n\t}\r\n\trenderMoveMenu(choices: BattleChoiceBuilder) {\r\n\t\tconst moveRequest = choices.currentMoveRequest()!;\r\n\r\n\t\tconst canDynamax = moveRequest.canDynamax && !choices.alreadyMax;\r\n\t\tconst canMegaEvo = moveRequest.canMegaEvo && !choices.alreadyMega;\r\n\t\tconst canMegaEvoX = moveRequest.canMegaEvoX && !choices.alreadyMega;\r\n\t\tconst canMegaEvoY = moveRequest.canMegaEvoY && !choices.alreadyMega;\r\n\t\tconst canZMove = moveRequest.zMoves && !choices.alreadyZ;\r\n\t\tconst canUltraBurst = moveRequest.canUltraBurst;\r\n\t\tconst canTerastallize = moveRequest.canTerastallize;\r\n\r\n\t\tconst maybeDisabled = moveRequest.maybeDisabled;\r\n\t\tconst maybeLocked = moveRequest.maybeLocked;\r\n\r\n\t\treturn <div class=\"movemenu\">\r\n\t\t\t{maybeDisabled && <p><em class=\"movewarning\">\r\n\t\t\t\tYou <strong>might</strong> have some moves disabled, so you won't be able to cancel an attack!\r\n\t\t\t</em></p>}\r\n\t\t\t{maybeLocked && <p><em class=\"movewarning\">\r\n\t\t\t\tYou <strong>might</strong> be locked into a move. {}\r\n\t\t\t\t<button class=\"button\" data-cmd=\"/choose testfight\">Try Fight button</button> {}\r\n\t\t\t\t(prevents switching if you're locked)\r\n\t\t\t</em></p>}\r\n\t\t\t{this.renderMoveControls(moveRequest, choices)}\r\n\t\t\t<div class=\"megaevo-box\">\r\n\t\t\t\t{canDynamax && <label class={`megaevo${choices.current.max ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"max\" checked={choices.current.max} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\t{moveRequest.gigantamax ? 'Gigantamax' : 'Dynamax'}\r\n\t\t\t\t</label>}\r\n\t\t\t\t{canMegaEvo && <label class={`megaevo${choices.current.mega ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"mega\" checked={choices.current.mega} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\tMega Evolution\r\n\t\t\t\t</label>}\r\n\t\t\t\t{canMegaEvoX && <label class={`megaevo${choices.current.mega ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"megax\" checked={choices.current.megax} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\tMega Evolution X\r\n\t\t\t\t</label>}\r\n\t\t\t\t{canMegaEvoY && <label class={`megaevo${choices.current.mega ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"megay\" checked={choices.current.megay} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\tMega Evolution Y\r\n\t\t\t\t</label>}\r\n\t\t\t\t{canUltraBurst && <label class={`megaevo${choices.current.ultra ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"ultra\" checked={choices.current.ultra} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\tUltra Burst\r\n\t\t\t\t</label>}\r\n\t\t\t\t{canZMove && <label class={`megaevo${choices.current.z ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"z\" checked={choices.current.z} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\tZ-Power\r\n\t\t\t\t</label>}\r\n\t\t\t\t{canTerastallize && <label class={`megaevo${choices.current.tera ? ' cur' : ''}`}>\r\n\t\t\t\t\t<input type=\"checkbox\" name=\"tera\" checked={choices.current.tera} onChange={this.toggleBoostedMove} /> {}\r\n\t\t\t\t\tTerastallize<br /><span dangerouslySetInnerHTML={{ __html: Dex.getTypeIcon(canTerastallize) }} />\r\n\t\t\t\t</label>}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\trenderMoveControls(active: BattleRequestActivePokemon, choices: BattleChoiceBuilder) {\r\n\t\tconst battle = this.props.room.battle;\r\n\t\tconst dex = battle.dex;\r\n\t\tconst pokemonIndex = choices.index();\r\n\t\tconst activeIndex = battle.mySide.n > 1 ? pokemonIndex + battle.pokemonControlled : pokemonIndex;\r\n\t\tconst serverPokemon = choices.request.side!.pokemon[pokemonIndex];\r\n\t\tconst valueTracker = new ModifiableValue(battle, battle.nearSide.active[activeIndex]!, serverPokemon);\r\n\t\tconst tooltips = (battle.scene as BattleScene).tooltips;\r\n\r\n\t\tif (choices.current.max || (active.maxMoves && !active.canDynamax)) {\r\n\t\t\tif (!active.maxMoves) {\r\n\t\t\t\treturn <div class=\"message-error\">Maxed with no max moves</div>;\r\n\t\t\t}\r\n\t\t\tconst gmax = active.gigantamax && dex.moves.get(active.gigantamax);\r\n\t\t\treturn active.moves.map((moveData, i) => {\r\n\t\t\t\tconst move = dex.moves.get(moveData.name);\r\n\t\t\t\tconst moveType = tooltips.getMoveType(move, valueTracker, gmax || true)[0];\r\n\t\t\t\tlet maxMoveData: { name: string, id: ID } = active.maxMoves![i];\r\n\t\t\t\tif (maxMoveData.name !== 'Max Guard') {\r\n\t\t\t\t\tmaxMoveData = tooltips.getMaxMoveFromType(moveType, gmax);\r\n\t\t\t\t}\r\n\t\t\t\tconst gmaxTooltip = maxMoveData.id.startsWith('gmax') ? `|${maxMoveData.id}` : ``;\r\n\t\t\t\tconst tooltip = `maxmove|${moveData.name}|${pokemonIndex}${gmaxTooltip}`;\r\n\t\t\t\treturn this.renderMoveButton({\r\n\t\t\t\t\tname: maxMoveData.name,\r\n\t\t\t\t\tcmd: `/move ${i + 1} max`,\r\n\t\t\t\t\ttype: moveType,\r\n\t\t\t\t\ttooltip,\r\n\t\t\t\t\tmoveData,\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (choices.current.z) {\r\n\t\t\tif (!active.zMoves) {\r\n\t\t\t\treturn <div class=\"message-error\">No Z moves</div>;\r\n\t\t\t}\r\n\t\t\treturn active.moves.map((moveData, i) => {\r\n\t\t\t\tconst zMoveData = active.zMoves![i];\r\n\t\t\t\tif (!zMoveData) {\r\n\t\t\t\t\treturn this.renderMoveButton(null);\r\n\t\t\t\t}\r\n\t\t\t\tconst specialMove = dex.moves.get(zMoveData.name);\r\n\t\t\t\tconst move = specialMove.exists ? specialMove : dex.moves.get(moveData.name);\r\n\t\t\t\tconst moveType = tooltips.getMoveType(move, valueTracker)[0];\r\n\t\t\t\tconst tooltip = `zmove|${moveData.name}|${pokemonIndex}`;\r\n\t\t\t\treturn this.renderMoveButton({\r\n\t\t\t\t\tname: zMoveData.name,\r\n\t\t\t\t\tcmd: `/move ${i + 1} zmove`,\r\n\t\t\t\t\ttype: moveType,\r\n\t\t\t\t\ttooltip,\r\n\t\t\t\t\tmoveData: { pp: 1, maxpp: 1 },\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst special = choices.moveSpecial(choices.current);\r\n\t\treturn active.moves.map((moveData, i) => {\r\n\t\t\tconst move = dex.moves.get(moveData.name);\r\n\t\t\tconst moveType = tooltips.getMoveType(move, valueTracker)[0];\r\n\t\t\tconst tooltip = `move|${moveData.name}|${pokemonIndex}`;\r\n\t\t\treturn this.renderMoveButton({\r\n\t\t\t\tname: move.name,\r\n\t\t\t\tcmd: `/move ${i + 1}${special}`,\r\n\t\t\t\ttype: moveType,\r\n\t\t\t\ttooltip,\r\n\t\t\t\tmoveData,\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\trenderMoveTargetControls(request: BattleMoveRequest, choices: BattleChoiceBuilder) {\r\n\t\tconst battle = this.props.room.battle;\r\n\t\tlet moveTarget = choices.currentMove()?.target;\r\n\t\tif ((moveTarget === 'adjacentAlly' || moveTarget === 'adjacentFoe') && battle.gameType === 'freeforall') {\r\n\t\t\tmoveTarget = 'normal';\r\n\t\t}\r\n\t\tconst moveChoice = choices.stringChoice(choices.current);\r\n\r\n\t\tconst userSlot = choices.index() + Math.floor(battle.mySide.n / 2) * battle.pokemonControlled;\r\n\t\tconst userSlotCross = battle.farSide.active.length - 1 - userSlot;\r\n\r\n\t\treturn [\r\n\t\t\tbattle.farSide.active.map((pokemon, i) => {\r\n\t\t\t\tlet disabled = false;\r\n\t\t\t\tif (moveTarget === 'adjacentAlly' || moveTarget === 'adjacentAllyOrSelf') {\r\n\t\t\t\t\tdisabled = true;\r\n\t\t\t\t} else if (moveTarget === 'normal' || moveTarget === 'adjacentFoe') {\r\n\t\t\t\t\tif (Math.abs(userSlotCross - i) > 1) disabled = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (pokemon?.fainted) pokemon = null;\r\n\t\t\t\treturn this.renderPokemonButton({\r\n\t\t\t\t\tpokemon,\r\n\t\t\t\t\tcmd: disabled ? `` : `/${moveChoice} +${i + 1}`,\r\n\t\t\t\t\tdisabled: disabled && 'fade',\r\n\t\t\t\t\ttooltip: `activepokemon|1|${i}`,\r\n\t\t\t\t});\r\n\t\t\t}).reverse(),\r\n\t\t\t<div style=\"clear: left\"></div>,\r\n\t\t\tbattle.nearSide.active.map((pokemon, i) => {\r\n\t\t\t\tlet disabled = false;\r\n\t\t\t\tif (moveTarget === 'adjacentFoe') {\r\n\t\t\t\t\tdisabled = true;\r\n\t\t\t\t} else if (moveTarget === 'normal' || moveTarget === 'adjacentAlly' || moveTarget === 'adjacentAllyOrSelf') {\r\n\t\t\t\t\tif (Math.abs(userSlot - i) > 1) disabled = true;\r\n\t\t\t\t}\r\n\t\t\t\tif (moveTarget !== 'adjacentAllyOrSelf' && userSlot === i) disabled = true;\r\n\r\n\t\t\t\tif (pokemon?.fainted) pokemon = null;\r\n\t\t\t\treturn this.renderPokemonButton({\r\n\t\t\t\t\tpokemon,\r\n\t\t\t\t\tcmd: disabled ? `` : `/${moveChoice} -${i + 1}`,\r\n\t\t\t\t\tdisabled: disabled && 'fade',\r\n\t\t\t\t\ttooltip: `activepokemon|0|${i}`,\r\n\t\t\t\t});\r\n\t\t\t}),\r\n\t\t];\r\n\t}\r\n\trenderSwitchMenu(\r\n\t\trequest: BattleMoveRequest | BattleSwitchRequest, choices: BattleChoiceBuilder, ignoreTrapping?: boolean\r\n\t) {\r\n\t\tconst numActive = choices.requestLength();\r\n\t\tconst maybeTrapped = !ignoreTrapping && choices.currentMoveRequest()?.maybeTrapped;\r\n\t\tconst trapped = !ignoreTrapping && !maybeTrapped && choices.currentMoveRequest()?.trapped;\r\n\r\n\t\treturn <div class=\"switchmenu\">\r\n\t\t\t{maybeTrapped && <em class=\"movewarning\">\r\n\t\t\t\tYou <strong>might</strong> be trapped, so you won't be able to cancel a switch!<br />\r\n\t\t\t</em>}\r\n\t\t\t{trapped && <em class=\"movewarning\">\r\n\t\t\t\tYou're <strong>trapped</strong> and cannot switch!<br />\r\n\t\t\t</em>}\r\n\t\t\t{request.side.pokemon.map((serverPokemon, i) => {\r\n\t\t\t\tconst cantSwitch = trapped || i < numActive || choices.alreadySwitchingIn.includes(i + 1) || serverPokemon.fainted;\r\n\t\t\t\treturn this.renderPokemonButton({\r\n\t\t\t\t\tpokemon: serverPokemon,\r\n\t\t\t\t\tcmd: `/switch ${i + 1}`,\r\n\t\t\t\t\tdisabled: cantSwitch,\r\n\t\t\t\t\ttooltip: `switchpokemon|${i}`,\r\n\t\t\t\t});\r\n\t\t\t})}\r\n\t\t</div>;\r\n\t}\r\n\trenderTeamPreviewChooser(request: | BattleTeamRequest, choices: BattleChoiceBuilder) {\r\n\t\treturn request.side.pokemon.map((serverPokemon, i) => {\r\n\t\t\tconst cantSwitch = choices.alreadySwitchingIn.includes(i + 1);\r\n\t\t\treturn this.renderPokemonButton({\r\n\t\t\t\tpokemon: serverPokemon,\r\n\t\t\t\tcmd: `/switch ${i + 1}`,\r\n\t\t\t\tdisabled: cantSwitch && 'fade',\r\n\t\t\t\ttooltip: `switchpokemon|${i}`,\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\trenderTeamList() {\r\n\t\tconst team = this.team;\r\n\t\tif (!team) return;\r\n\t\treturn <div class=\"switchcontrols\">\r\n\t\t\t<h3 class=\"switchselect\">Team</h3>\r\n\t\t\t<div class=\"switchmenu\">\r\n\t\t\t\t{team.map((serverPokemon, i) => {\r\n\t\t\t\t\treturn this.renderPokemonButton({\r\n\t\t\t\t\t\tpokemon: serverPokemon,\r\n\t\t\t\t\t\tcmd: \"\",\r\n\t\t\t\t\t\tdisabled: true,\r\n\t\t\t\t\t\ttooltip: `switchpokemon|${i}`,\r\n\t\t\t\t\t});\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\trenderChosenTeam(request: BattleTeamRequest, choices: BattleChoiceBuilder) {\r\n\t\treturn choices.alreadySwitchingIn.map(slot => {\r\n\t\t\tconst serverPokemon = request.side.pokemon[slot - 1];\r\n\t\t\treturn this.renderPokemonButton({\r\n\t\t\t\tpokemon: serverPokemon,\r\n\t\t\t\tcmd: `/switch ${slot}`,\r\n\t\t\t\tdisabled: true,\r\n\t\t\t\ttooltip: `switchpokemon|${slot - 1}`,\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\trenderOldChoices(request: BattleRequest, choices: BattleChoiceBuilder) {\r\n\t\tif (!choices) return null; // should not happen\r\n\t\tif (request.requestType !== 'move' && request.requestType !== 'switch' && request.requestType !== 'team') return;\r\n\t\tif (choices.isEmpty()) return null;\r\n\r\n\t\tlet buf: preact.ComponentChild[] = [\r\n\t\t\t<button data-cmd=\"/cancel\" class=\"button\"><i class=\"fa fa-chevron-left\" aria-hidden></i> Back</button>, ' ',\r\n\t\t];\r\n\t\tif (choices.isDone() && choices.noCancel) {\r\n\t\t\tbuf = ['Waiting for opponent...', <br />];\r\n\t\t} else if (choices.isDone() && choices.choices.length <= 1) {\r\n\t\t\tbuf = [];\r\n\t\t}\r\n\r\n\t\tconst battle = this.props.room.battle;\r\n\t\tfor (let i = 0; i < choices.choices.length; i++) {\r\n\t\t\tconst choiceString = choices.choices[i];\r\n\t\t\tif (choiceString === \"testfight\") {\r\n\t\t\t\tbuf.push(`${request.side.pokemon[i].name} is locked into a move.`);\r\n\t\t\t\treturn buf;\r\n\t\t\t}\r\n\t\t\tlet choice;\r\n\t\t\ttry {\r\n\t\t\t\tchoice = choices.parseChoice(choiceString, i);\r\n\t\t\t} catch (err: any) {\r\n\t\t\t\tbuf.push(<span class=\"message-error\">{err.message}</span>);\r\n\t\t\t}\r\n\t\t\tif (!choice) continue;\r\n\t\t\tconst pokemon = request.side.pokemon[i];\r\n\t\t\tconst active = request.requestType === 'move' ? request.active[i] : null;\r\n\t\t\tif (choice.choiceType === 'move') {\r\n\t\t\t\tbuf.push(`${pokemon.name} will `);\r\n\t\t\t\tif (choice.mega) buf.push(<strong>Mega</strong>, ` Evolve and `);\r\n\t\t\t\tif (choice.megax) buf.push(<strong>Mega</strong>, ` Evolve (X) and `);\r\n\t\t\t\tif (choice.megay) buf.push(<strong>Mega</strong>, ` Evolve (Y) and `);\r\n\t\t\t\tif (choice.ultra) buf.push(<strong>Ultra</strong>, ` Burst and `);\r\n\t\t\t\tif (choice.tera) buf.push(`Terastallize (`, <strong>{active?.canTerastallize || '???'}</strong>, `) and `);\r\n\t\t\t\tif (choice.max && active?.canDynamax) buf.push(active?.gigantamax ? `Gigantamax and ` : `Dynamax and `);\r\n\t\t\t\tbuf.push(`use `, <strong>{choices.currentMove(choice, i)?.name}</strong>);\r\n\t\t\t\tif (choice.targetLoc > 0) {\r\n\t\t\t\t\tconst target = battle.farSide.active[choice.targetLoc - 1];\r\n\t\t\t\t\tif (!target) {\r\n\t\t\t\t\t\tbuf.push(` at slot ${choice.targetLoc}`);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbuf.push(` at ${target.name}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (choice.targetLoc < 0) {\r\n\t\t\t\t\tconst target = battle.nearSide.active[-choice.targetLoc - 1];\r\n\t\t\t\t\tif (!target) {\r\n\t\t\t\t\t\tbuf.push(` at ally slot ${choice.targetLoc}`);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbuf.push(` at ally ${target.name}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (choice.choiceType === 'switch') {\r\n\t\t\t\tconst target = request.side.pokemon[choice.targetPokemon - 1];\r\n\t\t\t\tbuf.push(`${pokemon.name} will switch to `, <strong>{target.name}</strong>);\r\n\t\t\t} else if (choice.choiceType === 'shift') {\r\n\t\t\t\tbuf.push(`${pokemon.name} will `, <strong>shift</strong>, ` to the center`);\r\n\t\t\t} else if (choice.choiceType === 'team') {\r\n\t\t\t\tconst target = request.side.pokemon[choice.targetPokemon - 1];\r\n\t\t\t\tbuf.push(`You picked `, <strong>{target.name}</strong>);\r\n\t\t\t}\r\n\t\t\tbuf.push(<br />);\r\n\t\t}\r\n\t\treturn buf;\r\n\t}\r\n\trenderPlayerWaitingControls() {\r\n\t\treturn <div class=\"controls\">\r\n\t\t\t<div class=\"whatdo\">\r\n\t\t\t\t<button class=\"button\" data-cmd=\"/ffto end\">Skip animation <i class=\"fa fa-fast-forward\" aria-hidden></i></button>\r\n\t\t\t</div>\r\n\t\t\t{this.renderTeamList()}\r\n\t\t</div>;\r\n\t}\r\n\trenderPlayerControls(request: BattleRequest) {\r\n\t\tconst room = this.props.room;\r\n\t\tconst atEnd = room.battle.atQueueEnd;\r\n\t\tif (!atEnd) return this.renderPlayerWaitingControls();\r\n\r\n\t\tlet choices = room.choices;\r\n\t\tif (!choices) return 'Error: Missing BattleChoiceBuilder';\r\n\t\tif (choices.request !== request) {\r\n\t\t\tchoices = new BattleChoiceBuilder(request);\r\n\t\t\troom.choices = choices;\r\n\t\t}\r\n\r\n\t\tif (choices.isDone()) {\r\n\t\t\treturn <div class=\"controls\">\r\n\t\t\t\t<div class=\"whatdo\">\r\n\t\t\t\t\t{this.renderOldChoices(request, choices)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"pad\">\r\n\t\t\t\t\t{choices.noCancel ? null : <button data-cmd=\"/cancel\" class=\"button\">Cancel</button>}\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.renderTeamList()}\r\n\t\t\t</div>;\r\n\t\t}\r\n\t\tif (request.side) {\r\n\t\t\troom.battle.myPokemon = request.side.pokemon;\r\n\t\t\tthis.team = request.side.pokemon;\r\n\t\t}\r\n\t\tswitch (request.requestType) {\r\n\t\tcase 'move': {\r\n\t\t\tconst index = choices.index();\r\n\t\t\tconst pokemon = request.side.pokemon[index];\r\n\r\n\t\t\tif (choices.current.move) {\r\n\t\t\t\tconst moveName = choices.currentMove()?.name;\r\n\t\t\t\treturn <div class=\"controls\">\r\n\t\t\t\t\t<div class=\"whatdo\">\r\n\t\t\t\t\t\t{this.renderOldChoices(request, choices)}\r\n\t\t\t\t\t\t{pokemon.name} should use <strong>{moveName}</strong> at where? {}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"switchcontrols\">\r\n\t\t\t\t\t\t<div class=\"switchmenu\">\r\n\t\t\t\t\t\t\t{this.renderMoveTargetControls(request, choices)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\r\n\t\t\tconst canShift = room.battle.gameType === 'triples' && index !== 1;\r\n\r\n\t\t\treturn <div class=\"controls\">\r\n\t\t\t\t<div class=\"whatdo\">\r\n\t\t\t\t\t{this.renderOldChoices(request, choices)}\r\n\t\t\t\t\tWhat will <strong>{pokemon.name}</strong> do?\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"movecontrols\">\r\n\t\t\t\t\t<h3 class=\"moveselect\">Attack</h3>\r\n\t\t\t\t\t{this.renderMoveMenu(choices)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"switchcontrols\">\r\n\t\t\t\t\t{canShift && [\r\n\t\t\t\t\t\t<h3 class=\"shiftselect\">Shift</h3>,\r\n\t\t\t\t\t\t<button data-cmd=\"/shift\">Move to center</button>,\r\n\t\t\t\t\t]}\r\n\t\t\t\t\t<h3 class=\"switchselect\">Switch</h3>\r\n\t\t\t\t\t{this.renderSwitchMenu(request, choices)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t} case 'switch': {\r\n\t\t\tconst pokemon = request.side.pokemon[choices.index()];\r\n\t\t\treturn <div class=\"controls\">\r\n\t\t\t\t<div class=\"whatdo\">\r\n\t\t\t\t\t{this.renderOldChoices(request, choices)}\r\n\t\t\t\t\tWhat will <strong>{pokemon.name}</strong> do?\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"switchcontrols\">\r\n\t\t\t\t\t<h3 class=\"switchselect\">Switch</h3>\r\n\t\t\t\t\t{this.renderSwitchMenu(request, choices, true)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t} case 'team': {\r\n\t\t\treturn <div class=\"controls\">\r\n\t\t\t\t<div class=\"whatdo\">\r\n\t\t\t\t\t{choices.alreadySwitchingIn.length > 0 ? (\r\n\t\t\t\t\t\t[<button data-cmd=\"/cancel\" class=\"button\"><i class=\"fa fa-chevron-left\" aria-hidden></i> Back</button>,\r\n\t\t\t\t\t\t\t\" What about the rest of your team? \"]\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\"How will you start the battle? \"\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"switchcontrols\">\r\n\t\t\t\t\t<h3 class=\"switchselect\">\r\n\t\t\t\t\t\tChoose {choices.alreadySwitchingIn.length <= 0 ? `lead` : `slot ${choices.alreadySwitchingIn.length + 1}`}\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<div class=\"switchmenu\">\r\n\t\t\t\t\t\t{this.renderTeamPreviewChooser(request, choices)}\r\n\t\t\t\t\t\t<div style=\"clear:left\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"switchcontrols\">\r\n\t\t\t\t\t{choices.alreadySwitchingIn.length > 0 && <h3 class=\"switchselect\">Team so far</h3>}\r\n\t\t\t\t\t<div class=\"switchmenu\">\r\n\t\t\t\t\t\t{this.renderChosenTeam(request, choices)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\trenderAfterBattleControls() {\r\n\t\tconst room = this.props.room;\r\n\t\tconst isNotTiny = room.width > 700;\r\n\t\treturn <div class=\"controls\">\r\n\t\t\t<p>\r\n\t\t\t\t<span style=\"float: right\">\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\tonClick={this.handleDownloadReplay}\r\n\t\t\t\t\t\thref={`//${Config.routes.replays}/download`}\r\n\t\t\t\t\t\tclass=\"button replayDownloadButton\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<i class=\"fa fa-download\" aria-hidden></i> Download replay</a>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<button class=\"button\" data-cmd=\"/savereplay\">\r\n\t\t\t\t\t\t<i class=\"fa fa-upload\" aria-hidden></i> Upload and share replay\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</span>\r\n\r\n\t\t\t\t<button class=\"button\" data-cmd=\"/play\" style=\"min-width:4.5em\">\r\n\t\t\t\t\t<i class=\"fa fa-undo\" aria-hidden></i><br />Replay\r\n\t\t\t\t</button> {}\r\n\t\t\t\t{isNotTiny && <button class=\"button button-first\" data-cmd=\"/ffto 0\" style=\"margin-right:2px\">\r\n\t\t\t\t\t<i class=\"fa fa-undo\" aria-hidden></i><br />First turn\r\n\t\t\t\t</button>}\r\n\t\t\t\t{isNotTiny && <button class=\"button button-first\" data-cmd=\"/ffto -1\">\r\n\t\t\t\t\t<i class=\"fa fa-step-backward\" aria-hidden></i><br />Prev turn\r\n\t\t\t\t</button>}\r\n\t\t\t</p>\r\n\t\t\t{room.side ? (\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<button class=\"button\" data-cmd=\"/close\">\r\n\t\t\t\t\t\t<strong>Main menu</strong><br /><small>(closes this battle)</small>\r\n\t\t\t\t\t</button> {}\r\n\t\t\t\t\t<button class=\"button\" data-cmd={`/closeand /challenge ${room.battle.farSide.id},${room.battle.tier}`}>\r\n\t\t\t\t\t\t<strong>Rematch</strong><br /><small>(closes this battle)</small>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</p>\r\n\t\t\t) : (\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<button class=\"button\" data-cmd=\"/switchsides\"><i class=\"fa fa-random\" aria-hidden></i> Switch viewpoint</button>\r\n\t\t\t\t</p>\r\n\t\t\t)}\r\n\t\t</div>;\r\n\t}\r\n\r\n\thandleDownloadReplay = (e: MouseEvent) => {\r\n\t\tlet room = this.props.room;\r\n\t\tconst target = e.currentTarget as HTMLAnchorElement;\r\n\t\t// download replay\r\n\t\tlet filename = (room.battle.tier || 'Battle').replace(/[^A-Za-z0-9]/g, '');\r\n\t\tlet date = new Date();\r\n\t\tfilename += `-${date.getFullYear()}`;\r\n\t\tfilename += `-${date.getMonth() >= 9 ? '' : '0'}${date.getMonth() + 1}`;\r\n\t\tfilename += `-${date.getDate() >= 10 ? '' : '0'}${date.getDate()}`;\r\n\t\tfilename += '-' + toID(room.battle.p1.name);\r\n\t\tfilename += '-' + toID(room.battle.p2.name);\r\n\t\ttarget.href = window.BattleLog.createReplayFileHref(room);\r\n\t\ttarget.download = filename + '.html';\r\n\t\te.stopPropagation();\r\n\t};\r\n\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\tthis.updateLayout();\r\n\t\tconst id = `room-${room.id}`;\r\n\t\tconst hardcoreStyle = room.battle?.hardcoreMode ? <style\r\n\t\t\tdangerouslySetInnerHTML={{ __html: `#${id} .battle .turn, #${id} .battle-history { display: none !important; }` }}\r\n\t\t></style> : null;\r\n\r\n\t\tif (room.width < 700) {\r\n\t\t\treturn <PSPanelWrapper room={room} focusClick scrollable=\"hidden\">\r\n\t\t\t\t{hardcoreStyle}\r\n\t\t\t\t<BattleDiv room={room} />\r\n\t\t\t\t<ChatLog\r\n\t\t\t\t\tclass=\"battle-log hasuserlist\" room={room} top={this.battleHeight} noSubscription\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\"battle-controls\" role=\"complementary\" aria-label=\"Battle Controls\">\r\n\t\t\t\t\t\t{this.renderControls()}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</ChatLog>\r\n\t\t\t\t<ChatTextEntry room={room} onMessage={this.send} onKey={this.onKey} left={0} />\r\n\t\t\t\t<ChatUserList room={room} top={this.battleHeight} minimized />\r\n\t\t\t\t<button\r\n\t\t\t\t\tdata-href=\"battleoptions\" class=\"button\"\r\n\t\t\t\t\tstyle={{ position: 'absolute', right: '75px', top: this.battleHeight }}\r\n\t\t\t\t>\r\n\t\t\t\t\tBattle options\r\n\t\t\t\t</button>\r\n\t\t\t\t{(room.battle && !room.battle.ended && room.request && room.battle.mySide.id === PS.user.userid) &&\r\n\t\t\t\t\t<TimerButton room={room} />}\r\n\t\t\t\t<div class=\"battle-controls-container\"></div>\r\n\t\t\t</PSPanelWrapper>;\r\n\t\t}\r\n\r\n\t\treturn <PSPanelWrapper room={room} focusClick scrollable=\"hidden\">\r\n\t\t\t{hardcoreStyle}\r\n\t\t\t<BattleDiv room={room} />\r\n\t\t\t<ChatLog\r\n\t\t\t\tclass=\"battle-log hasuserlist\" room={room} left={640} noSubscription\r\n\t\t\t>\r\n\t\t\t\t{}\r\n\t\t\t</ChatLog>\r\n\t\t\t<ChatTextEntry room={room} onMessage={this.send} onKey={this.onKey} left={640} />\r\n\t\t\t<ChatUserList room={room} left={640} minimized />\r\n\t\t\t<button\r\n\t\t\t\tdata-href=\"battleoptions\" class=\"button\"\r\n\t\t\t\tstyle={{ position: 'absolute', right: '15px' }}\r\n\t\t\t>\r\n\t\t\t\tBattle options\r\n\t\t\t</button>\r\n\t\t\t<div class=\"battle-controls-container\">\r\n\t\t\t\t<div class=\"battle-controls\" role=\"complementary\" aria-label=\"Battle Controls\" style=\"top: 370px;\">\r\n\t\t\t\t\t{(room.battle && !room.battle.ended && room.request && room.battle.mySide.id === PS.user.userid) &&\r\n\t\t\t\t\t\t<TimerButton room={room} />}\r\n\t\t\t\t\t{this.renderControls()}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nPS.addRoomType(BattlePanel, BattlesPanel);\r\n"],"mappings":"sSAAA;AACA;AACA;AACA;AACA;AACA,GALA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCaA,WAAW,UAAAC,OAAA;;;;;;AAMvB,SAAAD,YAAYE,OAAoB,CAAE,KAAAC,KAAA;AACjCA,KAAA,CAAAF,OAAA,CAAAG,IAAA,MAAMF,OAAO,CAAC,OAACC,KAAA,CANEE,SAAS,CAAG,SAAS,CAAAF,KAAA,CAEvCG,MAAM,CAAG,EAAE,CAAAH,KAAA,CACXI,OAAO,CAAG,EAAE,CAAAJ,KAAA,CACZK,OAAO,CAAwB,IAAI;AAGlCL,KAAA,CAAKM,OAAO,CAAC,CAAC;;AAEd,GAAIC,EAAE,CAACC,KAAK,CAACC,KAAK,CAAE;AACnBC,GAAG,CAACC,cAAc,CAAC,IAAI,CAAC;AACzB,CAAC,OAAAX,KAAA;AACF,CAACY,cAAA,CAAAf,WAAA,CAAAC,OAAA,MAAAe,MAAA,CAAAhB,WAAA,CAAAiB,SAAA,CAAAD,MAAA;AACDE,SAAS,CAAT,SAAAA,SAASA,CAACZ,MAAc,CAAE;AACzB,GAAIA,MAAM,GAAK,IAAI,CAACA,MAAM,CAAE,MAAO,KAAI,CAACG,OAAO,CAAC,CAAC;AACjD,IAAI,CAACD,OAAO,CAAG,IAAI;AACnB,IAAI,CAACF,MAAM,CAAGA,MAAM;AACpB,IAAI,CAACa,MAAM,CAAC,IAAI,CAAC;AACjB,IAAI,CAACV,OAAO,CAAC,CAAC;AACf,CAAC,CAAAO,MAAA;AACDP,OAAO,CAAP,SAAAA,OAAOA,CAAA,CAAG;AACTC,EAAE,CAACU,IAAI,kBAAkBC,IAAI,CAAC,IAAI,CAACf,MAAM,CAAC,MAAK,IAAI,CAACC,OAAS,CAAC;AAC/D,CAAC,QAAAP,WAAA,GAvB+BsB,MAAM;;;AA0BjCC,YAAY,UAAAC,YAAA,WAAAD,aAAA,MAAAE,MAAA,SAAAC,IAAA,CAAAC,SAAA,CAAAC,MAAA,CAAAC,IAAA,KAAAC,KAAA,CAAAJ,IAAA,EAAAK,IAAA,GAAAA,IAAA,CAAAL,IAAA,CAAAK,IAAA,IAAAF,IAAA,CAAAE,IAAA,EAAAJ,SAAA,CAAAI,IAAA,GAAAN,MAAA,CAAAD,YAAA,CAAApB,IAAA,CAAA4B,KAAA,CAAAR,YAAA,QAAAS,MAAA,CAAAJ,IAAA,SAAAJ,MAAA;;;;;;;AAOjBhB,OAAO,CAAG,UAAM;AACfgB,MAAA,CAAKS,KAAK,CAACC,IAAI,CAAC1B,OAAO,CAAC,CAAC;AAC1B,CAAC,CAAAgB,MAAA;AACDW,YAAY,CAAG,SAACC,CAAQ,CAAK;AAC5B,GAAM,CAAAC,KAAK,CAAID,CAAC,CAACE,MAAM,CAAuBD,KAAK;AACnDb,MAAA,CAAKS,KAAK,CAACC,IAAI,CAACjB,SAAS,CAACoB,KAAK,CAAC;AACjC,CAAC,CAAAb,MAAA;AACDe,YAAY,CAAG,SAACH,CAAQ,CAAK,KAAAI,WAAA,CAAAC,YAAA;AAC5BL,CAAC,CAACM,cAAc,CAAC,CAAC;AAClB,GAAM,CAAAC,MAAM,EAAAH,WAAA,CAAGhB,MAAA,CAAKoB,IAAI,UAAAJ,WAAA,CAATA,WAAA,CAAWK,aAAa,yBAA2C,CAAC,eAApEL,WAAA,CAAsEH,KAAK;AAC1F,GAAM,CAAAS,YAAY,EAAAL,YAAA,CAAGjB,MAAA,CAAKoB,IAAI,UAAAH,YAAA,CAATA,YAAA,CAAWI,aAAa,2BAA6C,CAAC,eAAtEJ,YAAA,CAAwEJ,KAAK;AAClGb,MAAA,CAAKS,KAAK,CAACC,IAAI,CAAC5B,OAAO,EAAMqC,MAAM,EAAI,EAAE,OAAIG,YAAY,EAAI,EAAE,CAAE;AACjEtB,MAAA,CAAKhB,OAAO,CAAC,CAAC;AACf,CAAC,QAAAgB,MAAA,EAAAV,cAAA,CAAAQ,YAAA,CAAAC,YAAA,MAAAwB,OAAA,CAAAzB,YAAA,CAAAN,SAAA,CAAA+B,OAAA;AACDC,gBAAgB,CAAhB,SAAAA,gBAAgBA,CAACC,MAAkB,CAAE;AACpC,GAAM,CAAA5C,MAAM,CAAG4C,MAAM,CAACC,EAAE,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AACtC,GAAM,CAAAC,aAAa,CAAG,MAAO,CAAAH,MAAM,CAACN,MAAM,GAAK,QAAQ,UAAYM,MAAM,CAACN,MAAM,CAAKM,MAAM,CAACN,MAAM;AAClG,MAAO,CAAAU,MAAA,CAAAC,CAAA,QAAKC,GAAG,CAAEN,MAAM,CAACC,EAAG,EAACG,MAAA,CAAAC,CAAA,MAAGE,IAAI,KAAMP,MAAM,CAACC,EAAK,CAAC,QAAM,WAAW;AACrEE,aAAa,EAAIC,MAAA,CAAAC,CAAA,UAAOG,KAAK,CAAC,aAAa,EAAC,GAAC,CAACL,aAAa,CAAC,GAAQ,CAAC;AACtEC,MAAA,CAAAC,CAAA,cAAO,GAAC,CAACjD,MAAM,CAAC,GAAQ,CAAC,CAAAgD,MAAA,CAAAC,CAAA,UAAK,CAAC;AAC/BD,MAAA,CAAAC,CAAA,OAAI,QAAM,IAAI,EAAEL,MAAM,CAACS,EAAO,CAAC,IAAC,CAAAL,MAAA,CAAAC,CAAA,UAAO,QAAM,IAAI,EAAC,KAAU,CAAC,IAAC,CAAAD,MAAA,CAAAC,CAAA,OAAI,QAAM,IAAI,EAAEL,MAAM,CAACU,EAAO;AAC1F,CAAM,CAAC;AACX,CAAC,CAAAZ,OAAA;AACQa,MAAM,CAAf,QAAS,CAAAA,MAAMA,CAAA,CAAG,KAAAC,MAAA;AACjB,GAAM,CAAA3B,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI;AAC5B,MAAO,CAAAmB,MAAA,CAAAC,CAAA,CAACQ,cAAc,EAAC5B,IAAI,CAAEA,IAAK,CAAC6B,UAAU,OAACV,MAAA,CAAAC,CAAA,QAAK,QAAM,KAAK;AAC7DD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAACG,KAAK,CAAC,2CAA2C,CAACO,IAAI,CAAC,WAAW;AACxFX,MAAA,CAAAC,CAAA,MAAG,QAAM,aAAa,CAAC,kBAAW,CAAI,CAAC;AAChC,CAAC;AACTD,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU;AACpBD,MAAA,CAAAC,CAAA;AACCD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAACU,IAAI,CAAC,SAAS,CAACC,OAAO,CAAE,IAAI,CAACzD,OAAQ;AAC3D6C,MAAA,CAAAC,CAAA,MAAG,QAAM,eAAe,CAAC,kBAAW,CAAI,CAAC;AAClC,CAAC,IAAC;AACVD,MAAA,CAAAC,CAAA;AACCG,KAAK,CAAE7C,GAAG,CAACsD,cAAc,CAAC,oBAAoB,CAAC,CAAG,6CAA8C,CAAC,QAAM,OAAO;AAC9GC,KAAK,CAAC,4FAA4F;AAC5F;AACL,CAAC;;AAEJd,MAAA,CAAAC,CAAA;AACCD,MAAA,CAAAC,CAAA,UAAO,QAAM,OAAO,EAAC,SAAc,CAAC,CAAAD,MAAA,CAAAC,CAAA,CAACc,cAAc,EAACC,QAAQ,CAAE,IAAI,CAAClC,YAAa,CAACmC,WAAW,CAAC,eAAe,CAAE;AAC5G,CAAC;AACJjB,MAAA,CAAAC,CAAA,cAAO,eACO;AAAAD,MAAA,CAAAC,CAAA,WAAQU,IAAI,CAAC,WAAW,CAACK,QAAQ,CAAE,IAAI,CAAC9B,YAAa;AACjEc,MAAA,CAAAC,CAAA,WAAQjB,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC,CAAAgB,MAAA,CAAAC,CAAA,WAAQjB,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC,CAAAgB,MAAA,CAAAC,CAAA,WAAQjB,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC;AACtGgB,MAAA,CAAAC,CAAA,WAAQjB,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC,CAAAgB,MAAA,CAAAC,CAAA,WAAQjB,KAAK,CAAC,MAAM,EAAC,MAAY,CAAC,CAAAgB,MAAA,CAAAC,CAAA,WAAQjB,KAAK,CAAC,MAAM,EAAC,MAAY;AAC9F;AACF,CAAC;;AAERgB,MAAA,CAAAC,CAAA,SAAM,QAAM,QAAQ,CAACiB,QAAQ,CAAE,IAAI,CAAChC,YAAa;AAChDc,MAAA,CAAAC,CAAA;AACCD,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,MAAM,CAACR,IAAI,CAAC,cAAc,CAAC,QAAM,SAAS,CAACM,WAAW,CAAC,iBAAiB,CAAE,CAAC;AACvFjB,MAAA,CAAAC,CAAA,WAAQkB,IAAI,CAAC,QAAQ,CAAC,QAAM,QAAQ,EAAC,QAAc;AACjD;AACE,CAAC;AACPnB,MAAA,CAAAC,CAAA,QAAK,QAAM,MAAM,EAAE,CAACpB,IAAI,CAAC3B,OAAO;AAC/B8C,MAAA,CAAAC,CAAA,UAAG,YAAa,CAAC;AACd,CAACpB,IAAI,CAAC3B,OAAO,CAACoB,MAAM;AACvB0B,MAAA,CAAAC,CAAA,UAAG,yBAA0B,CAAC;AAC1BD,MAAA,CAAAC,CAAA,CAAAD,MAAA,CAAAoB,QAAA;AACJpB,MAAA,CAAAC,CAAA,UAAIpB,IAAI,CAAC3B,OAAO,CAACoB,MAAM,GAAK,GAAG;AACrBO,IAAI,CAAC3B,OAAO,CAACoB,MAAM,CAAC,GAAC,CAACO,IAAI,CAAC3B,OAAO,CAACoB,MAAM,CAAG,CAAC,mBAA2B,CAAC;AAClFO,IAAI,CAAC3B,OAAO,CAACmE,GAAG,CAAC,SAAAzB,MAAM,QAAI,CAAAY,MAAI,CAACb,gBAAgB,CAACC,MAAM,CAAC;AACxD;AACK;AACH;AACD,CAAiB,CAAC;AACxB,CAAC,QAAA3B,YAAA,GA3EyBqD,WAAW,EAAhCrD,YAAY,CACD4B,EAAE,CAAG,SAAS,CADzB5B,YAAY,CAEDsD,MAAM,CAAG,CAAC,SAAS,CAAC,CAF/BtD,YAAY,CAGDuD,KAAK,CAAG9E,WAAW,CAH9BuB,YAAY,CAIDwD,QAAQ,CAAG,OAAO,CAJ7BxD,YAAY,CAKDyD,IAAI,CAAG1B,MAAA,CAAAC,CAAA,MAAG,QAAM,4BAA4B,CAAC,kBAAW,CAAI,CAAC,CALxEhC,YAAY,CAMD6C,KAAK,CAAG,SAAS;;;AAwErBa,UAAU,UAAAC,SAAA,WAAAD,WAAA,MAAAE,MAAA,SAAAC,KAAA,CAAAzD,SAAA,CAAAC,MAAA,CAAAC,IAAA,KAAAC,KAAA,CAAAsD,KAAA,EAAAC,KAAA,GAAAA,KAAA,CAAAD,KAAA,CAAAC,KAAA,IAAAxD,IAAA,CAAAwD,KAAA,EAAA1D,SAAA,CAAA0D,KAAA,GAAAF,MAAA,CAAAD,SAAA,CAAA9E,IAAA,CAAA4B,KAAA,CAAAkD,SAAA,QAAAjD,MAAA,CAAAJ,IAAA,SAAAsD,MAAA;AACJ9E,SAAS,CAAG,QAAQ,CAAA8E,MAAA;;;;;;AAM7BjC,MAAM,CAAW,IAAI,CAAAiC,MAAA;;AAE9BG,IAAI,CAAiC,IAAI,CAAAH,MAAA;AACzCI,OAAO,CAAyB,IAAI,CAAAJ,MAAA;AACpCK,OAAO,CAA+B,IAAI,CAAAL,MAAA;AAC1CM,kBAAkB,CAAmB,IAAI,QAAAN,MAAA,EAAApE,cAAA,CAAAkE,UAAA,CAAAC,SAAA,MAAAQ,OAAA,CAAAT,UAAA,CAAAhE,SAAA,CAAAyE,OAAA;;AAEzCC,UAAU,CAAV,SAAAA,UAAUA,CAAA,CAAG,KAAAC,MAAA;AACZ,GAAM,CAAAC,QAAQ,CAAG,IAAI,CAAC1C,EAAE,CAAC2C,KAAK,CAAC,CAAC,CAAC;AACjCC,GAAG,uCAAuCF,QAAQ,QAAO,CAAC,CAACG,GAAG,CAAC,CAAC,SAAM,CAAC,CAAC,CAACC,IAAI,CAAC,SAAAC,IAAI,CAAI;AACrF,GAAI;AACH,GAAM,CAAAC,MAAM,CAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC;AAC/BN,MAAI,CAACxB,KAAK,KAAO+B,MAAM,CAAC7F,MAAM,MAAK6F,MAAM,CAACG,OAAO,CAACC,IAAI,CAAC,OAAO,CAAG;AACjEX,MAAI,CAAC1C,MAAM,CAACsD,SAAS,CAAGL,MAAM,CAACM,GAAG,CAACrD,KAAK,CAAC,IAAI,CAAC;AAC9CwC,MAAI,CAAC1C,MAAM,CAACwD,UAAU,CAAG,KAAK;AAC9Bd,MAAI,CAAC1C,MAAM,CAACyD,KAAK,CAAC,CAAC;AACnBf,MAAI,CAAC1C,MAAM,CAAC0D,QAAQ,CAAC,CAAC,CAAC;AACvBhB,MAAI,CAACiB,SAAS,CAAG,aAAa;AAC9BjB,MAAI,CAACzE,MAAM,CAAC,IAAI,CAAC;AAClB,CAAE,MAAA2F,OAAA,CAAM;AACPlB,MAAI,CAACmB,WAAW,CAAC,CAAC,OAAO,CAAE,kBAAkB,CAAC,CAAC;AAChD;AACD,CAAC,CAAC;AACH,CAAC,QAAA9B,UAAA,GA9B8B+B,QAAQ;;;AAiClCC,SAAS,UAAAC,iBAAA,WAAAD,UAAA,SAAAC,iBAAA,CAAAlF,KAAA,MAAAL,SAAA,SAAAZ,cAAA,CAAAkG,SAAA,CAAAC,iBAAA,MAAAC,OAAA,CAAAF,SAAA,CAAAhG,SAAA,CAAAkG,OAAA;AACLC,qBAAqB,CAA9B,QAAS,CAAAA,qBAAqBA,CAAA,CAAG;AAChC,MAAO,MAAK;AACb,CAAC,CAAAD,OAAA;AACQE,iBAAiB,CAA1B,QAAS,CAAAA,iBAAiBA,CAAA,CAAG;AAC5B,GAAM,CAAAlF,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI;AAC5B,GAAIA,IAAI,CAACe,MAAM,CAAE;AAChB,IAAI,CAACL,IAAI,CAAEyE,YAAY,CAACnF,IAAI,CAACe,MAAM,CAACqE,KAAK,CAACC,MAAM,CAAE,CAAC,CAAC,CAAE,IAAI,CAAC3E,IAAI,CAAE4E,UAAW,CAAC;AAC9E;AACD,CAAC,CAAAN,OAAA;AACQtD,MAAM,CAAf,QAAS,CAAAA,MAAMA,CAAA,CAAG;AACjB,MAAO,CAAAP,MAAA,CAAAC,CAAA,YAAKD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,CAAM,CAAM,CAAC;AAC7C,CAAC,QAAA0D,SAAA,GAZsB3D,MAAM,CAACoE,SAAS;;;AAelCC,WAAW,UAAAC,kBAAA,WAAAD,YAAA,MAAAE,MAAA,SAAAC,KAAA,CAAAnG,SAAA,CAAAC,MAAA,CAAAC,IAAA,KAAAC,KAAA,CAAAgG,KAAA,EAAAC,KAAA,GAAAA,KAAA,CAAAD,KAAA,CAAAC,KAAA,IAAAlG,IAAA,CAAAkG,KAAA,EAAApG,SAAA,CAAAoG,KAAA,GAAAF,MAAA,CAAAD,kBAAA,CAAAxH,IAAA,CAAA4B,KAAA,CAAA4F,kBAAA,QAAA3F,MAAA,CAAAJ,IAAA,SAAAgG,MAAA;AAChBG,aAAa,CAAkB,IAAI,QAAAH,MAAA,EAAA9G,cAAA,CAAA4G,WAAA,CAAAC,kBAAA,MAAAK,OAAA,CAAAN,WAAA,CAAA1G,SAAA,CAAAgH,OAAA;AAC1BC,oBAAoB,CAA7B,QAAS,CAAAA,oBAAoBA,CAAA,CAAG;AAC/B,GAAI,IAAI,CAACF,aAAa,CAAE;AACvBG,aAAa,CAAC,IAAI,CAACH,aAAa,CAAC;AACjC,IAAI,CAACA,aAAa,CAAG,IAAI;AAC1B;AACD,CAAC,CAAAC,OAAA;AACDG,aAAa,CAAb,SAAAA,aAAaA,CAACC,OAAsB,CAAE;AACrC,GAAIA,OAAO,GAAK,IAAI,CAAE,MAAO,MAAM;AACnC,GAAM,CAAAC,OAAO,CAAGC,IAAI,CAACC,KAAK,CAACH,OAAO,CAAG,EAAE,CAAC;AACxCA,OAAO,EAAIC,OAAO,CAAG,EAAE;AACvB,MAAU,CAAAA,OAAO,MAAKD,OAAO,CAAG,EAAE,CAAG,GAAG,CAAG,EAAE,EAAIA,OAAO;AACzD,CAAC,CAAAJ,OAAA;AACDpE,MAAM,CAAN,SAAAA,MAAMA,CAAA,CAAG,KAAA4E,MAAA;AACR,GAAI,CAAAC,IAAI,CAAG,OAAO;AAClB,GAAM,CAAAvG,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI;AAC5B,GAAI,CAAC,IAAI,CAAC6F,aAAa,EAAI7F,IAAI,CAACe,MAAM,CAACyF,eAAe,CAAE;;AAEvD,IAAI,CAACX,aAAa,CAAGY,WAAW,CAAC,UAAM;AACtC,GAAI,MAAO,CAAAzG,IAAI,CAACe,MAAM,CAACyF,eAAe,GAAK,QAAQ,EAAIxG,IAAI,CAACe,MAAM,CAACyF,eAAe,CAAG,CAAC,CAAE;AACvFxG,IAAI,CAACe,MAAM,CAACyF,eAAe,EAAE;AAC7B,GAAIxG,IAAI,CAACe,MAAM,CAAC2F,aAAa,CAAE1G,IAAI,CAACe,MAAM,CAAC2F,aAAa,EAAE,CAAC;AACtD,GAAI1G,IAAI,CAACe,MAAM,CAAC4F,aAAa,CAAE3G,IAAI,CAACe,MAAM,CAAC4F,aAAa,EAAE;AAChE;AACAL,MAAI,CAACM,WAAW,CAAC,CAAC;AACnB,CAAC,CAAE,IAAI,CAAC;AACT,CAAC,IAAM,IAAI,IAAI,CAACf,aAAa,EAAI,CAAC7F,IAAI,CAACe,MAAM,CAACyF,eAAe,CAAE;AAC9DR,aAAa,CAAC,IAAI,CAACH,aAAa,CAAC;AACjC,IAAI,CAACA,aAAa,CAAG,IAAI;AAC1B;;AAEA,GAAI,CAAAgB,YAAY,CAAI7G,IAAI,CAACe,MAAM,CAACyF,eAAe;AAC9CxG,IAAI,CAACoD,OAAO,EAAIpD,IAAI,CAACoD,OAAO,CAAC0D,WAAW,GAAK,MAAM,EAAK9G,IAAI,CAACqD,OAAO,EAAI,CAACrD,IAAI,CAACqD,OAAO,CAAC0D,MAAM,CAAC,CAAE;AAC/F,iBAAiB,CAAG,EAAE;;AAEvB,GAAI/G,IAAI,CAACe,MAAM,CAACyF,eAAe,CAAE;AAChC,GAAM,CAAAQ,WAAW,CAAGhH,IAAI,CAACe,MAAM,CAACyF,eAAe;AAC/CD,IAAI,CAAG,IAAI,CAACN,aAAa,CAACe,WAAW,CAAC;AACtC,GAAIA,WAAW,GAAK,IAAI,CAAE;AACzB,GAAIA,WAAW,EAAI,EAAE,EAAIH,YAAY,CAAE;AACtCA,YAAY,CAAG,uBAAuB;AACvC;;AAEA,GAAI7G,IAAI,CAACe,MAAM,CAAC4F,aAAa,CAAE;AAC9B,GAAM,CAAAM,SAAS,CAAG,IAAI,CAAChB,aAAa,CAACjG,IAAI,CAACe,MAAM,CAAC4F,aAAa,CAAC;AAC/DJ,IAAI,SAAWU,SAAS,SAAQ;AACjC;AACD;AACD;;AAEA,MAAO,CAAA9F,MAAA,CAAAC,CAAA;AACNG,KAAK,CAAE,CAAE2F,QAAQ,CAAE,UAAU,CAAEC,KAAK,CAAE,MAAO,CAAE,CAAC,YAAU,aAAa,CAAC,iBAAgBN,YAAe,CAACO,IAAI,CAAC,OAAO;;AAEpHjG,MAAA,CAAAC,CAAA,MAAG,QAAM,uBAAuB,CAAC,kBAAW,CAAI,CAAC,IAAC,CAACmF;AAC5C,CAAC;AACV,CAAC,QAAAf,WAAA,GAxDwBrE,MAAM,CAACoE,SAAS;AAyDzC,CAAC;;AAEI8B,WAAW,UAAAC,aAAA,WAAAD,YAAA,MAAAE,MAAA,SAAAC,KAAA,CAAAhI,SAAA,CAAAC,MAAA,CAAAC,IAAA,KAAAC,KAAA,CAAA6H,KAAA,EAAAC,KAAA,GAAAA,KAAA,CAAAD,KAAA,CAAAC,KAAA,IAAA/H,IAAA,CAAA+H,KAAA,EAAAjI,SAAA,CAAAiI,KAAA,GAAAF,MAAA,CAAAD,aAAA,CAAArJ,IAAA,CAAA4B,KAAA,CAAAyH,aAAA,QAAAxH,MAAA,CAAAJ,IAAA,SAAA6H,MAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDhBG,IAAI,CAA2B,IAAI,CAAAH,MAAA;AACnCtI,IAAI,CAAG,SAAC0I,IAAY,CAAEC,IAAkB,CAAK;AAC5CL,MAAA,CAAKxH,KAAK,CAACC,IAAI,CAACf,IAAI,CAAC0I,IAAI,CAAEC,IAAI,CAAC;AACjC,CAAC,CAAAL,MAAA;AACDM,kBAAkB,CAAG,UAAM,KAAAC,oBAAA;AAC1B,GAAI,CAAAC,MAAM,CAACC,YAAY,SAAAF,oBAAA,CAAnBC,MAAM,CAACC,YAAY,CAAG,CAAC,eAAvBF,oBAAA,CAAyBxF,IAAI,IAAK,OAAO,CAAE;AAC/CiF,MAAA,CAAKU,KAAK,CAAC,CAAC;AACb,CAAC,CAAAV,MAAA;AACDW,KAAK,CAAG,SAAChI,CAAgB,CAAK;AAC7B,GAAIA,CAAC,CAACiI,OAAO,GAAK,EAAE,CAAE;AACrB,GAAM,CAAAC,OAAO,CAAGb,MAAA,CAAK7G,IAAI,CAAE2H,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAmB;AAClFD,OAAO,CAACE,SAAS,CAAGF,OAAO,CAACE,SAAS,CAAGF,OAAO,CAACG,YAAY,CAAG,EAAE;AACjE,MAAO,KAAI;AACZ,CAAC,IAAM,IAAIrI,CAAC,CAACiI,OAAO,GAAK,EAAE,CAAE;AAC5B,GAAM,CAAAC,QAAO,CAAGb,MAAA,CAAK7G,IAAI,CAAE2H,sBAAsB,CAAC,UAAU,CAAC,CAAC,CAAC,CAAmB;AAClFD,QAAO,CAACE,SAAS,CAAGF,QAAO,CAACE,SAAS,CAAGF,QAAO,CAACG,YAAY,CAAG,EAAE;AACjE,MAAO,KAAI;AACZ;AACA,MAAO,MAAK;AACb,CAAC,CAAAhB,MAAA;AACDiB,iBAAiB,CAAG,SAACtI,CAAQ,CAAK;AACjC,GAAM,CAAAuI,QAAQ,CAAGvI,CAAC,CAACwI,aAAiC;AACpD,GAAM,CAAArF,OAAO,CAAGkE,MAAA,CAAKxH,KAAK,CAACC,IAAI,CAACqD,OAAO;AACvC,GAAI,CAACA,OAAO,CAAE;AACd,OAAQoF,QAAQ,CAAC3G,IAAI;AACrB,IAAK,MAAM;AACVuB,OAAO,CAACsF,OAAO,CAACC,IAAI,CAAGH,QAAQ,CAACI,OAAO;AACvC;AACD,IAAK,OAAO;AACXxF,OAAO,CAACsF,OAAO,CAACG,KAAK,CAAGL,QAAQ,CAACI,OAAO;AACxCxF,OAAO,CAACsF,OAAO,CAACI,KAAK,CAAG,KAAK;AAC7B;AACD,IAAK,OAAO;AACX1F,OAAO,CAACsF,OAAO,CAACI,KAAK,CAAGN,QAAQ,CAACI,OAAO;AACxCxF,OAAO,CAACsF,OAAO,CAACG,KAAK,CAAG,KAAK;AAC7B;AACD,IAAK,OAAO;AACXzF,OAAO,CAACsF,OAAO,CAACK,KAAK,CAAGP,QAAQ,CAACI,OAAO;AACxC;AACD,IAAK,GAAG;AACPxF,OAAO,CAACsF,OAAO,CAACM,CAAC,CAAGR,QAAQ,CAACI,OAAO;AACpC;AACD,IAAK,KAAK;AACTxF,OAAO,CAACsF,OAAO,CAACO,GAAG,CAAGT,QAAQ,CAACI,OAAO;AACtC;AACD,IAAK,MAAM;AACVxF,OAAO,CAACsF,OAAO,CAACQ,IAAI,CAAGV,QAAQ,CAACI,OAAO;AACvC;AACD;AACAtB,MAAA,CAAKxH,KAAK,CAACC,IAAI,CAAChB,MAAM,CAAC,IAAI,CAAC;AAC7B,CAAC,CAAAuI,MAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuCD6B,YAAY,CAAG,GAAG,CAAA7B,MAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwoBlB8B,oBAAoB,CAAG,SAACnJ,CAAa,CAAK;AACzC,GAAI,CAAAF,IAAI,CAAGuH,MAAA,CAAKxH,KAAK,CAACC,IAAI;AAC1B,GAAM,CAAAI,MAAM,CAAGF,CAAC,CAACwI,aAAkC;;AAEnD,GAAI,CAAAY,QAAQ,CAAG,CAACtJ,IAAI,CAACe,MAAM,CAACwI,IAAI,EAAI,QAAQ,EAAEC,OAAO,CAAC,eAAe,CAAE,EAAE,CAAC;AAC1E,GAAI,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC;AACrBJ,QAAQ,MAAQG,IAAI,CAACE,WAAW,CAAC,CAAG;AACpCL,QAAQ,OAAQG,IAAI,CAACG,QAAQ,CAAC,CAAC,EAAI,CAAC,CAAG,EAAE,CAAG,GAAG,GAAGH,IAAI,CAACG,QAAQ,CAAC,CAAC,CAAG,CAAC,CAAE;AACvEN,QAAQ,OAAQG,IAAI,CAACI,OAAO,CAAC,CAAC,EAAI,EAAE,CAAG,EAAE,CAAG,GAAG,EAAGJ,IAAI,CAACI,OAAO,CAAC,CAAG;AAClEP,QAAQ,EAAI,GAAG,CAAGpK,IAAI,CAACc,IAAI,CAACe,MAAM,CAACS,EAAE,CAACM,IAAI,CAAC;AAC3CwH,QAAQ,EAAI,GAAG,CAAGpK,IAAI,CAACc,IAAI,CAACe,MAAM,CAACU,EAAE,CAACK,IAAI,CAAC;AAC3C1B,MAAM,CAACkB,IAAI,CAAGyG,MAAM,CAAC+B,SAAS,CAACC,oBAAoB,CAAC/J,IAAI,CAAC;AACzDI,MAAM,CAAC4J,QAAQ,CAAGV,QAAQ,CAAG,OAAO;AACpCpJ,CAAC,CAAC+J,eAAe,CAAC,CAAC;AACpB,CAAC,QAAA1C,MAAA,EAAA3I,cAAA,CAAAyI,WAAA,CAAAC,aAAA,EAAAD,WAAA,CA/xBM6C,UAAU,CAAjB,QAAO,CAAAA,UAAUA,CAACC,EAAa,CAAE,KAAAC,gBAAA,CAChC,GAAM,CAAAC,IAAI,EAAAD,gBAAA,CAAGD,EAAE,CAACG,YAAY,UAAAF,gBAAA,CAAfA,gBAAA,CAAiBG,KAAK,eAAtBH,gBAAA,CAAyB,CAAC,CAAC,CACxC,GAAI,CAAAC,IAAI,cAAJA,IAAI,CAAE/H,IAAI,IAAK,WAAW,CAAE,CAC/B,GAAI,CAAAkI,OAAO,CAAG,CAAC,CACf,KAAOA,OAAO,CAAG,GAAG,CAAEA,OAAO,EAAE,CAAE,CAChC,GAAI,CAACjM,EAAE,CAACkM,KAAK,oBAAoBD,OAAO,CAAG,CAAE,MAC9C,CACAH,IAAI,CAAC1C,IAAI,CAAC,CAAC,CAAC7D,IAAI,CAAC,SAAA4G,IAAI,CAAI,CACxB,GAAM,CAAAC,UAAU,CAAGD,IAAI,CAACE,OAAO,CAAC,SAAS,CAAC,CAC1C,GAAM,CAAAC,QAAQ,CAAGH,IAAI,CAACE,OAAO,CAAC,UAAU,CAAC,CACzC,GAAI,CAAA3I,KAAK,CAAG,iBAAiB,CAC7B,GAAI0I,UAAU,EAAI,CAAC,EAAIE,QAAQ,CAAGF,UAAU,CAAE,CAC7C1I,KAAK,CAAGyI,IAAI,CAAC/G,KAAK,CAACgH,UAAU,CAAG,CAAC,CAAEE,QAAQ,CAAG,CAAC,CAAC,CAChD,GAAM,CAAAC,UAAU,CAAG7I,KAAK,CAAC2I,OAAO,CAAC,GAAG,CAAC,CACrC,GAAM,CAAAG,WAAW,CAAG9I,KAAK,CAAC+I,WAAW,CAAC,GAAG,CAAC,CAC1C,GAAID,WAAW,CAAGD,UAAU,CAAG,CAAC,CAAE,CACjC7I,KAAK,CAAGA,KAAK,CAACgJ,SAAS,CAACH,UAAU,CAAG,CAAC,CAAEC,WAAW,CAAG,CAAC,CAAC,CACzD,CAAC,IAAM,CACN9I,KAAK,CAAGA,KAAK,CAACgJ,SAAS,CAACH,UAAU,CAAG,CAAC,CAAC,CACxC,CACD,CACA,GAAM,CAAAI,MAAM,CAAGR,IAAI,CAACE,OAAO,CAAC,oDAAoD,CAAC,CACjF,GAAM,CAAAO,MAAM,CAAGT,IAAI,CAACE,OAAO,CAAC,wCAAwC,CAAC,CACrE,GAAIM,MAAM,CAAG,CAAC,EAAIC,MAAM,CAAG,CAAC,CAAE,CAC7B5M,EAAE,CAAC6M,KAAK,CAAC,0DAA0D,CAAC,CACpE,OACD,CACA,GAAIF,MAAM,EAAI,CAAC,CAAE,CAChBR,IAAI,CAAGA,IAAI,CAAC/G,KAAK,CAACuH,MAAM,CAAG,EAAE,CAAC,CAC/B,CAAC,IAAM,IAAIC,MAAM,EAAI,CAAC,CAAE,CACvBT,IAAI,CAAGA,IAAI,CAAC/G,KAAK,CAACwH,MAAM,CAAG,EAAE,CAAC,CAC/B,CACA,GAAM,CAAAE,MAAM,CAAGX,IAAI,CAACE,OAAO,CAAC,WAAW,CAAC,CACxCF,IAAI,CAAGA,IAAI,CAAC/G,KAAK,CAAC,CAAC,CAAE0H,MAAM,CAAC,CAC5BX,IAAI,CAAGA,IAAI,CAAClB,OAAO,CAAC,OAAO,CAAE,GAAG,CAAC,CAEjCjL,EAAE,CAAC6F,IAAI,oBAAoBoG,OAAmB,CAAC,CAC/C,GAAM,CAAAxK,IAAI,CAAGzB,EAAE,CAACkM,KAAK,oBAAoBD,OAAO,CAAiB,CACjE,GAAI,CAACxK,IAAI,CAAE,OAEXA,IAAI,CAACiC,KAAK,CAAGA,KAAK,CAClBjC,IAAI,CAAC0E,SAAS,CAAG,aAAa,CAC9BnG,EAAE,CAAC+M,OAAO,qBAAqBd,OAAO,MAAKE,IAAM,CAAC,CACnD,CAAC,CAAC,CACF,MAAO,KAAI,CACZ,CACD,CAAC,KAAAa,OAAA,CAAAlE,WAAA,CAAAvI,SAAA,CAAAyM,OAAA,CAqDQrG,iBAAiB,CAA1B,QAAS,CAAAA,iBAAiBA,CAAA,CAAG,KAAAsG,aAAA,CAAAC,MAAA,MAC5B,GAAM,CAAAzL,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAM,CAAA0L,KAAK,CAAGC,CAAC,CAAC,IAAI,CAACjL,IAAK,CAAC,CAE3B,GAAI,CAAAkL,QAAQ,CAAG5L,IAAI,CAACgB,EAAY,CAChC,GAAIhB,IAAI,CAACgB,EAAE,CAAC6K,UAAU,CAAC,SAAS,CAAC,CAAE,CAClC,GAAM,CAAAC,QAAQ,CAAG9L,IAAI,CAACgB,EAAE,CAAC2C,KAAK,CAAC,CAAC,CAAC,CAAC1C,KAAK,CAAC,GAAG,CAAC,CAC5C2K,QAAQ,CAAGE,QAAQ,CAAC,CAAC,CAAC,CACvB,CAEA,GAAM,CAAA/K,MAAM,CAAIf,IAAI,CAACe,MAAM,GAAXf,IAAI,CAACe,MAAM,CAAK,GAAI,CAAAgL,MAAM,CAAC,CAC1C/K,EAAE,CAAEhB,IAAI,CAACgB,EAAS,CAClBqE,MAAM,CAAEqG,KAAK,CAACM,IAAI,CAAC,SAAS,CAAC,CAC7BC,SAAS,CAAEP,KAAK,CAACM,IAAI,CAAC,aAAa,CAAC,CACpC1H,GAAG,EAAAkH,aAAA,CAAExL,IAAI,CAACkM,OAAO,eAAZV,aAAA,CAAchJ,GAAG,CAAC,SAAA9C,IAAI,QAAI,GAAG,CAAGA,IAAI,CAAC0E,IAAI,CAAC,GAAG,CAAC,GAAC,CACpDwH,QAAQ,CAAEA,QACX,CAAC,CAAC,CAAC,CAEH,GAAM,CAAAxG,KAAK,CAAGrE,MAAM,CAACqE,KAAoB,CACzCpF,IAAI,CAACkM,OAAO,CAAG,IAAI,CACnBlM,IAAI,CAACsE,GAAG,GAARtE,IAAI,CAACsE,GAAG,CAAKc,KAAK,CAACd,GAAG,EACtBtE,IAAI,CAACsE,GAAG,CAAC6H,YAAY,CAAGnM,IAAI,CAACoM,eAAe,CAC5ChH,KAAK,CAACiH,QAAQ,CAACC,MAAM,CAACZ,KAAK,CAACM,IAAI,CAAC,4BAA4B,CAAC,CAAC,CAC/D5G,KAAK,CAACiH,QAAQ,CAACC,MAAM,CAAClH,KAAK,CAACd,GAAG,CAACsD,IAAI,CAAC,CACrCN,aAAA,CAAAxI,SAAA,CAAMoG,iBAAiB,CAAAjH,IAAA,OACvB8C,MAAM,CAAC0D,QAAQ,CAAC8H,QAAQ,CAAC,CAEzB,GAAIxE,MAAM,CAACyE,gBAAgB,EAAIzE,MAAM,CAACyE,gBAAgB,CAACZ,QAAQ,CAAC,CAAE,CACjE,GAAM,CAAAa,KAAK,CAAG1E,MAAM,CAACyE,gBAAgB,CAACZ,QAAQ,CAAC,CAC/C7K,MAAM,CAAC2L,GAAG,CAAGhO,GAAG,CAACiO,GAAG,CAACF,KAAK,CAAC,CAC3BG,OAAO,CAACC,KAAK,CAAC,+BAA+B,CAAE9L,MAAM,CAAC2L,GAAG,CAACI,KAAK,CAAE,aAAa,CAAElB,QAAQ,CAAC,CAC1F,CAAC,IAAM,CACN7K,MAAM,CAAC2L,GAAG,CAAGhO,GAAG,CAACqO,SAAS,CAACnB,QAAQ,CAAC,CACpCgB,OAAO,CAACC,KAAK,CAAC,+BAA+B,CAAEjB,QAAQ,CAAC,CACzD,CACA7K,MAAM,CAACiM,SAAS,CAAC,iBAAM,CAAAvB,MAAI,CAAC7E,WAAW,CAAC,CAAC,GAAC,CAE3C,CAAC,CAAA2E,OAAA,CAED0B,YAAY,CAAZ,SAAAA,YAAYA,CAAA,CAAG,CACd,GAAI,CAAC,IAAI,CAACvM,IAAI,CAAE,OAChB,GAAM,CAAAV,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAM,CAAAkN,KAAK,CAAG,IAAI,CAACxM,IAAI,CAACyM,WAAW,CACnC,GAAID,KAAK,EAAIA,KAAK,CAAG,GAAG,CAAE,KAAAE,YAAA,CACzB,GAAM,CAAAC,KAAK,CAAIH,KAAK,CAAG,GAAI,CAC3B,CAAAE,YAAA,CAAApN,IAAI,CAACe,MAAM,SAAXqM,YAAA,CAAahI,KAAK,CAACC,MAAM,CAAEiI,GAAG,CAAC,WAAW,UAAWD,KAAK,IAAG,CAAC,CAC9D,IAAI,CAACjE,YAAY,CAAGhD,IAAI,CAACmH,KAAK,CAAC,GAAG,CAAGF,KAAK,CAAC,CAC5C,CAAC,IAAM,KAAAG,aAAA,CACN,CAAAA,aAAA,CAAAxN,IAAI,CAACe,MAAM,SAAXyM,aAAA,CAAapI,KAAK,CAACC,MAAM,CAAEiI,GAAG,CAAC,WAAW,CAAE,MAAM,CAAC,CACnD,IAAI,CAAClE,YAAY,CAAG,GAAG,CACxB,CACD,CAAC,CAAAmC,OAAA,CACQ3G,WAAW,CAApB,QAAS,CAAAA,WAAWA,CAAClF,IAAU,CAAE,CAChC,GAAM,CAAAM,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,OAAQN,IAAI,CAAC,CAAC,CAAC,EACf,IAAK,UAAU,CACdM,IAAI,CAACe,MAAM,CAAC0D,QAAQ,CAAC8H,QAAQ,CAAC,CAC9B,OACD,IAAK,SAAS,CACb,IAAI,CAACkB,cAAc,CAAC/N,IAAI,CAAC,CAAC,CAAC,CAAGuE,IAAI,CAACC,KAAK,CAACxE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAG,IAAI,CAAC,CACzD,OACD,IAAK,KAAK,CAAE,IAAK,KAAK,CACrB,IAAI,CAAC+N,cAAc,CAAC,IAAI,CAAC,CACzB,MACD,IAAK,GAAG,CAAE,IAAK,IAAI,CAAE,IAAK,MAAM,CAAE,IAAK,SAAS,CAAE,IAAK,UAAU,CAChEzN,IAAI,CAACe,MAAM,CAAC2M,UAAU,CAAC,GAAG,CAAGhO,IAAI,CAAC0E,IAAI,CAAC,GAAG,CAAC,CAAC,CAC5C,OACD,IAAK,OAAO,CACX,GAAI1E,IAAI,CAAC,CAAC,CAAC,CAACmM,UAAU,CAAC,kBAAkB,CAAC,EAAI7L,IAAI,CAACoD,OAAO,CAAE,CAC3DpD,IAAI,CAACqD,OAAO,CAAG,GAAI,CAAAsK,mBAAmB,CAAC3N,IAAI,CAACoD,OAAO,CAAC,CACpDpD,IAAI,CAAChB,MAAM,CAAC,IAAI,CAAC,CAClB,CACA,MACD,CACAgB,IAAI,CAACe,MAAM,CAAC6M,GAAG,CAAC,GAAG,CAAGlO,IAAI,CAAC0E,IAAI,CAAC,GAAG,CAAC,CAAC,CACrC,GAAI7F,EAAE,CAACC,KAAK,CAACqP,MAAM,CAAE,IAAI,CAAC9N,KAAK,CAACC,IAAI,CAACe,MAAM,CAAC0D,QAAQ,CAAC8H,QAAQ,CAAC,CAC/D,CAAC,CAAAhB,OAAA,CACDkC,cAAc,CAAd,SAAAA,cAAcA,CAACrK,OAA6B,CAAE,CAC7C,GAAM,CAAApD,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAI,CAACoD,OAAO,CAAE,CACbpD,IAAI,CAACoD,OAAO,CAAG,IAAI,CACnBpD,IAAI,CAACqD,OAAO,CAAG,IAAI,CACnB,OACD,CAEA,GAAI9E,EAAE,CAACC,KAAK,CAACsP,SAAS,EAAI,CAAC9N,IAAI,CAACe,MAAM,CAACyF,eAAe,EAAI,CAACxG,IAAI,CAACsD,kBAAkB,CAAE,CACnF,IAAI,CAACrE,IAAI,CAAC,WAAW,CAAC,CACtBe,IAAI,CAACsD,kBAAkB,CAAG,IAAI,CAC/B,CAEAqK,mBAAmB,CAACI,UAAU,CAAC3K,OAAO,CAAEpD,IAAI,CAACe,MAAM,CAAC,CAEpD,GAAIqC,OAAO,CAACD,IAAI,CAAE,CACjBnD,IAAI,CAACe,MAAM,CAACiN,SAAS,CAAG5K,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAC5CjO,IAAI,CAACe,MAAM,CAACmN,YAAY,CAAC9K,OAAO,CAACD,IAAI,CAACnC,EAAE,CAAC,CACzChB,IAAI,CAACmD,IAAI,CAAGC,OAAO,CAACD,IAAI,CACzB,CAEAnD,IAAI,CAACoD,OAAO,CAAGA,OAAO,CACtBpD,IAAI,CAACqD,OAAO,CAAG,GAAI,CAAAsK,mBAAmB,CAACvK,OAAO,CAAC,CAC/C,IAAI,CAAC+K,aAAa,CAAC,CAAC,CACpBnO,IAAI,CAAChB,MAAM,CAAC,IAAI,CAAC,CAClB,CAAC,CAAAuM,OAAA,CACD4C,aAAa,CAAb,SAAAA,aAAaA,CAAA,CAAG,KAAAC,aAAA,CACf,GAAM,CAAApO,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAI,CAAAqO,KAAK,CAAGrO,IAAI,CAACe,MAAM,CAACuN,OAAO,CAACxM,IAAI,CACpC,GAAIuM,KAAK,CAAEA,KAAK,CAAG,WAAW,CAAGA,KAAK,CACtC,QAAAD,aAAA,CAAQpO,IAAI,CAACoD,OAAO,eAAZgL,aAAA,CAActH,WAAW,EACjC,IAAK,MAAM,CACV9G,IAAI,CAACuO,MAAM,CAAC,CAAEtM,KAAK,CAAE,YAAY,CAAEuM,IAAI,CAAE,qBAAqB,CAAGH,KAAM,CAAC,CAAC,CACzE,MACD,IAAK,QAAQ,CACZrO,IAAI,CAACuO,MAAM,CAAC,CAAEtM,KAAK,CAAE,cAAc,CAAEuM,IAAI,CAAE,uBAAuB,CAAGH,KAAM,CAAC,CAAC,CAC7E,MACD,IAAK,MAAM,CACVrO,IAAI,CAACuO,MAAM,CAAC,CAAEtM,KAAK,CAAE,eAAe,CAAEuM,IAAI,CAAE,uCAAuC,CAAGH,KAAM,CAAC,CAAC,CAC9F,MACD,CACD,CAAC,CAAA9C,OAAA,CACDkD,cAAc,CAAd,SAAAA,cAAcA,CAAA,CAAG,CAChB,GAAM,CAAAzO,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAI,CAACA,IAAI,CAACe,MAAM,CAAE,MAAO,KAAI,CAC7B,GAAIf,IAAI,CAACe,MAAM,CAAC2N,KAAK,CAAE,MAAO,KAAI,CAACC,yBAAyB,CAAC,CAAC,CAC9D,GAAI3O,IAAI,CAACmD,IAAI,EAAInD,IAAI,CAACoD,OAAO,CAAE,CAC9B,MAAO,KAAI,CAACwL,oBAAoB,CAAC5O,IAAI,CAACoD,OAAO,CAAC,CAC/C,CACA,GAAM,CAAAyL,OAAO,CAAG,CAAC7O,IAAI,CAACe,MAAM,CAAC+N,OAAO,CACpC,GAAM,CAAAC,KAAK,CAAG/O,IAAI,CAACe,MAAM,CAACwD,UAAU,CACpC,MAAO,CAAApD,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,UACE2N,KAAK,CACL5N,MAAA,CAAAC,CAAA,WAAQ,QAAM,iBAAiB,CAAC,oBAAa,CAAC,WAAS,OAAO,CAACG,KAAK,CAAC,iBAAiB,EACrFJ,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,OACrC,CAAC,CACNpB,IAAI,CAACe,MAAM,CAACiO,MAAM,CACrB7N,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,OAAO,CAACG,KAAK,CAAC,iBAAiB,EAC9DJ,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,OACrC,CAAC,CAETD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,QAAQ,CAACG,KAAK,CAAC,iBAAiB,EAC/DJ,MAAA,CAAAC,CAAA,MAAG,QAAM,aAAa,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,QACtC,CACR,CAAC,GAAC,CACHD,MAAA,CAAAC,CAAA,WAAQ,QAAO,qBAAqB,EAAIyN,OAAO,CAAG,WAAW,CAAG,EAAE,CAAE,CAAC,WAAS,SAAS,CAACtN,KAAK,CAAC,kBAAkB,EAC/GJ,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,aACrC,CAAC,CACTD,MAAA,CAAAC,CAAA,WAAQ,QAAO,qBAAqB,EAAIyN,OAAO,CAAG,WAAW,CAAG,EAAE,CAAE,CAAC,WAAS,UAAU,EACvF1N,MAAA,CAAAC,CAAA,MAAG,QAAM,qBAAqB,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,YAC9C,CAAC,CACTD,MAAA,CAAAC,CAAA,WAAQ,QAAO,oBAAoB,EAAI2N,KAAK,CAAG,WAAW,CAAG,EAAE,CAAE,CAAC,WAAS,UAAU,CAACxN,KAAK,CAAC,kBAAkB,EAC7GJ,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,YAC7C,CAAC,CACTD,MAAA,CAAAC,CAAA,WAAQ,QAAO,oBAAoB,EAAI2N,KAAK,CAAG,WAAW,CAAG,EAAE,CAAE,CAAC,WAAS,WAAW,EACrF5N,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,cAC7C,CACN,CAAC,CACJD,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,cAAc,EAC7CD,MAAA,CAAAC,CAAA,MAAG,QAAM,cAAc,CAAC,kBAAW,CAAI,CAAC,oBACjC,CACN,CACC,CAAC,CACP,CAAC,CAAAmK,OAAA,CACD0D,gBAAgB,CAAhB,SAAAA,gBAAgBA,CAAClP,KAGT,CAAE,CACT,GAAI,CAACA,KAAK,CAAE,CACX,MAAO,CAAAoB,MAAA,CAAAC,CAAA,WAAQ,QAAM,YAAY,CAAC8N,QAAQ,OAAC,MAAc,CAAC,CAC3D,CACA,GAAM,CAAAC,EAAE,CAAGpP,KAAK,CAACqP,QAAQ,CAACC,KAAK,CAAMtP,KAAK,CAACqP,QAAQ,CAACD,EAAE,KAAKpP,KAAK,CAACqP,QAAQ,CAACC,KAAK,CAAK,QAAQ,CAC5F,MAAO,CAAAlO,MAAA,CAAAC,CAAA,WACN,WAAUrB,KAAK,CAACuP,GAAI,CAAC,eAAcvP,KAAK,CAACwP,OAAQ,CACjD,mCAAiCxP,KAAK,CAACqP,QAAQ,CAACF,QAAQ,CAAG,UAAU,SAAWnP,KAAK,CAACuC,IAAM,CAAG,CAC/F,gBAAevC,KAAK,CAACqP,QAAQ,CAACF,QAAS,EAEtCnP,KAAK,CAAC+B,IAAI,CAACX,MAAA,CAAAC,CAAA,UAAK,CAAC,CAClBD,MAAA,CAAAC,CAAA,UAAO,QAAM,MAAM,EAAErB,KAAK,CAACuC,IAAY,CAAC,IAAC,CAAAnB,MAAA,CAAAC,CAAA,UAAO,QAAM,IAAI,EAAE+N,EAAU,CAAC,OAChE,CAAC,CACV,CAAC,CAAA5D,OAAA,CACDiE,mBAAmB,CAAnB,SAAAA,mBAAmBA,CAACzP,KAEnB,CAAE,CACF,GAAM,CAAAkO,OAAO,CAAGlO,KAAK,CAACkO,OAAO,CAC7B,GAAI,CAACA,OAAO,CAAE,CACb,MAAO,CAAA9M,MAAA,CAAAC,CAAA,WACN,WAAUrB,KAAK,CAACuP,GAAI,CAAC,SAAUvP,KAAK,CAACmP,QAAQ,CAAG,WAAW,CAAG,EAAE,eAAc,CAC9E,gBAAenP,KAAK,CAACmP,QAAS,CAC9B3N,KAAK,CAAExB,KAAK,CAACmP,QAAQ,GAAK,MAAM,CAAG,cAAc,CAAG,EAAG,CAAC,eAAcnP,KAAK,CAACwP,OAAQ,EACpF,cAEO,CAAC,CACV,CAEA,GAAI,CAAAE,YAAY,CAChB,OAAQC,WAAW,CAACC,UAAU,CAAC1B,OAAO,CAAC,EACvC,IAAK,GAAG,CAAEwB,YAAY,CAAG,oBAAoB,CAAE,MAC/C,IAAK,GAAG,CAAEA,YAAY,CAAG,iBAAiB,CAAE,MAC5C,QAASA,YAAY,CAAG,OAAO,CAAE,MACjC,CAEA,MAAO,CAAAtO,MAAA,CAAAC,CAAA,WACN,WAAUrB,KAAK,CAACuP,GAAI,CAAC,SAAUvP,KAAK,CAACmP,QAAQ,CAAG,WAAW,CAAG,EAAE,eAAc,CAC9E,gBAAenP,KAAK,CAACmP,QAAS,CAC9B3N,KAAK,CAAExB,KAAK,CAACmP,QAAQ,GAAK,MAAM,CAAG,cAAc,CAAG,EAAG,CAAC,eAAcnP,KAAK,CAACwP,OAAQ,EAEnFK,MAAM,CAAC,CAAE3B,OAAO,CAAPA,OAAQ,CAAC,CAAC,CACnBA,OAAO,CAACnM,IAAI,CAEZ,CAAC/B,KAAK,CAAC8P,OAAO,EAAI,CAAC5B,OAAO,CAAC6B,OAAO,EAClC3O,MAAA,CAAAC,CAAA,SAAM,QAAOqO,YAAa,EACzBtO,MAAA,CAAAC,CAAA,SAAMG,KAAK,CAAE,CAAE2L,KAAK,CAAE9G,IAAI,CAACmH,KAAK,CAACU,OAAO,CAAC8B,EAAE,CAAG,EAAE,CAAG9B,OAAO,CAAC+B,KAAK,CAAC,EAAI,CAAE,CAAE,CAAO,CAC3E,CAAC,CAEP,CAACjQ,KAAK,CAAC8P,OAAO,EAAI5B,OAAO,CAACgC,MAAM,EAAI9O,MAAA,CAAAC,CAAA,SAAM,kBAAiB6M,OAAO,CAACgC,MAAS,CAAO,CAC7E,CAAC,CACV,CAAC,CAAA1E,OAAA,CACD2E,cAAc,CAAd,SAAAA,cAAcA,CAAC7M,OAA4B,CAAE,CAC5C,GAAM,CAAA8M,WAAW,CAAG9M,OAAO,CAAC+M,kBAAkB,CAAC,CAAE,CAEjD,GAAM,CAAAC,UAAU,CAAGF,WAAW,CAACE,UAAU,EAAI,CAAChN,OAAO,CAACiN,UAAU,CAChE,GAAM,CAAAC,UAAU,CAAGJ,WAAW,CAACI,UAAU,EAAI,CAAClN,OAAO,CAACmN,WAAW,CACjE,GAAM,CAAAC,WAAW,CAAGN,WAAW,CAACM,WAAW,EAAI,CAACpN,OAAO,CAACmN,WAAW,CACnE,GAAM,CAAAE,WAAW,CAAGP,WAAW,CAACO,WAAW,EAAI,CAACrN,OAAO,CAACmN,WAAW,CACnE,GAAM,CAAAG,QAAQ,CAAGR,WAAW,CAACS,MAAM,EAAI,CAACvN,OAAO,CAACwN,QAAQ,CACxD,GAAM,CAAAC,aAAa,CAAGX,WAAW,CAACW,aAAa,CAC/C,GAAM,CAAAC,eAAe,CAAGZ,WAAW,CAACY,eAAe,CAEnD,GAAM,CAAAC,aAAa,CAAGb,WAAW,CAACa,aAAa,CAC/C,GAAM,CAAAC,WAAW,CAAGd,WAAW,CAACc,WAAW,CAE3C,MAAO,CAAA9P,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC1B4P,aAAa,EAAI7P,MAAA,CAAAC,CAAA,UAAGD,MAAA,CAAAC,CAAA,OAAI,QAAM,aAAa,EAAC,MACxC,CAAAD,MAAA,CAAAC,CAAA,eAAQ,OAAa,CAAC,uEACvB,CAAI,CAAC,CACR6P,WAAW,EAAI9P,MAAA,CAAAC,CAAA,UAAGD,MAAA,CAAAC,CAAA,OAAI,QAAM,aAAa,EAAC,MACtC,CAAAD,MAAA,CAAAC,CAAA,eAAQ,OAAa,CAAC,2BAAwB,CAClDD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,mBAAmB,EAAC,kBAAwB,CAAC,IAAC,CAAE,uCAE7E,CAAI,CAAC,CACR,IAAI,CAAC8P,kBAAkB,CAACf,WAAW,CAAE9M,OAAO,CAAC,CAC9ClC,MAAA,CAAAC,CAAA,QAAK,QAAM,aAAa,EACtBiP,UAAU,EAAIlP,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACO,GAAG,CAAG,MAAM,CAAG,EAAE,CAAG,EAC1E/H,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,KAAK,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACO,GAAI,CAAC/G,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CACpG2H,WAAW,CAACgB,UAAU,CAAG,YAAY,CAAG,SACnC,CAAC,CACPZ,UAAU,EAAIpP,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACC,IAAI,CAAG,MAAM,CAAG,EAAE,CAAG,EAC3EzH,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,MAAM,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACC,IAAK,CAACzG,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CAAE,gBAEnG,CAAC,CACPiI,WAAW,EAAItP,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACC,IAAI,CAAG,MAAM,CAAG,EAAE,CAAG,EAC5EzH,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,OAAO,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACG,KAAM,CAAC3G,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CAAE,kBAErG,CAAC,CACPkI,WAAW,EAAIvP,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACC,IAAI,CAAG,MAAM,CAAG,EAAE,CAAG,EAC5EzH,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,OAAO,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACI,KAAM,CAAC5G,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CAAE,kBAErG,CAAC,CACPsI,aAAa,EAAI3P,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACK,KAAK,CAAG,MAAM,CAAG,EAAE,CAAG,EAC/E7H,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,OAAO,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACK,KAAM,CAAC7G,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CAAE,aAErG,CAAC,CACPmI,QAAQ,EAAIxP,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACM,CAAC,CAAG,MAAM,CAAG,EAAE,CAAG,EACtE9H,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,GAAG,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACM,CAAE,CAAC9G,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CAAE,SAE7F,CAAC,CACPuI,eAAe,EAAI5P,MAAA,CAAAC,CAAA,UAAO,mBAAiBiC,OAAO,CAACsF,OAAO,CAACQ,IAAI,CAAG,MAAM,CAAG,EAAE,CAAG,EAChFhI,MAAA,CAAAC,CAAA,UAAOkB,IAAI,CAAC,UAAU,CAACR,IAAI,CAAC,MAAM,CAAC+G,OAAO,CAAExF,OAAO,CAACsF,OAAO,CAACQ,IAAK,CAAChH,QAAQ,CAAE,IAAI,CAACqG,iBAAkB,CAAE,CAAC,IAAC,CAAE,cAC7F,CAAArH,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAAD,MAAA,CAAAC,CAAA,SAAMgQ,uBAAuB,CAAE,CAAEC,MAAM,CAAE3S,GAAG,CAAC4S,WAAW,CAACP,eAAe,CAAE,CAAE,CAAE,CAC1F,CACH,CACD,CAAC,CACP,CAAC,CAAAxF,OAAA,CACD2F,kBAAkB,CAAlB,SAAAA,kBAAkBA,CAACK,MAAkC,CAAElO,OAA4B,CAAE,KAAAmO,MAAA,MACpF,GAAM,CAAAzQ,MAAM,CAAG,IAAI,CAAChB,KAAK,CAACC,IAAI,CAACe,MAAM,CACrC,GAAM,CAAA2L,GAAG,CAAG3L,MAAM,CAAC2L,GAAG,CACtB,GAAM,CAAA+E,YAAY,CAAGpO,OAAO,CAACqO,KAAK,CAAC,CAAC,CACpC,GAAM,CAAAC,WAAW,CAAG5Q,MAAM,CAAC6Q,MAAM,CAACC,CAAC,CAAG,CAAC,CAAGJ,YAAY,CAAG1Q,MAAM,CAAC+Q,iBAAiB,CAAGL,YAAY,CAChG,GAAM,CAAAM,aAAa,CAAG1O,OAAO,CAACD,OAAO,CAACD,IAAI,CAAE8K,OAAO,CAACwD,YAAY,CAAC,CACjE,GAAM,CAAAO,YAAY,CAAG,GAAI,CAAAC,eAAe,CAAClR,MAAM,CAAEA,MAAM,CAACmR,QAAQ,CAACX,MAAM,CAACI,WAAW,CAAC,CAAGI,aAAa,CAAC,CACrG,GAAM,CAAA1F,QAAQ,CAAItL,MAAM,CAACqE,KAAK,CAAiBiH,QAAQ,CAEvD,GAAIhJ,OAAO,CAACsF,OAAO,CAACO,GAAG,EAAKqI,MAAM,CAACY,QAAQ,EAAI,CAACZ,MAAM,CAAClB,UAAW,CAAE,CACnE,GAAI,CAACkB,MAAM,CAACY,QAAQ,CAAE,CACrB,MAAO,CAAAhR,MAAA,CAAAC,CAAA,QAAK,QAAM,eAAe,EAAC,yBAA4B,CAAC,CAChE,CACA,GAAM,CAAAgR,IAAI,CAAGb,MAAM,CAACJ,UAAU,EAAIzE,GAAG,CAAC2F,KAAK,CAACxO,GAAG,CAAC0N,MAAM,CAACJ,UAAU,CAAC,CAClE,MAAO,CAAAI,MAAM,CAACc,KAAK,CAAC7P,GAAG,CAAC,SAAC4M,QAAQ,CAAEkD,CAAC,CAAK,CACxC,GAAM,CAAAC,IAAI,CAAG7F,GAAG,CAAC2F,KAAK,CAACxO,GAAG,CAACuL,QAAQ,CAACtN,IAAI,CAAC,CACzC,GAAM,CAAA0Q,QAAQ,CAAGnG,QAAQ,CAACoG,WAAW,CAACF,IAAI,CAAEP,YAAY,CAAEI,IAAI,EAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAC1E,GAAI,CAAAM,WAAqC,CAAGnB,MAAM,CAACY,QAAQ,CAAEG,CAAC,CAAC,CAC/D,GAAII,WAAW,CAAC5Q,IAAI,GAAK,WAAW,CAAE,CACrC4Q,WAAW,CAAGrG,QAAQ,CAACsG,kBAAkB,CAACH,QAAQ,CAAEJ,IAAI,CAAC,CAC1D,CACA,GAAM,CAAAQ,WAAW,CAAGF,WAAW,CAAC1R,EAAE,CAAC6K,UAAU,CAAC,MAAM,CAAC,KAAO6G,WAAW,CAAC1R,EAAE,GAAO,CACjF,GAAM,CAAAuO,OAAO,YAAcH,QAAQ,CAACtN,IAAI,KAAI2P,YAAY,CAAGmB,WAAa,CACxE,MAAO,CAAApB,MAAI,CAACvC,gBAAgB,CAAC,CAC5BnN,IAAI,CAAE4Q,WAAW,CAAC5Q,IAAI,CACtBwN,GAAG,WAAWgD,CAAC,CAAG,CAAC,QAAM,CACzBhQ,IAAI,CAAEkQ,QAAQ,CACdjD,OAAO,CAAPA,OAAO,CACPH,QAAQ,CAARA,QACD,CAAC,CAAC,CACH,CAAC,CAAC,CACH,CAEA,GAAI/L,OAAO,CAACsF,OAAO,CAACM,CAAC,CAAE,CACtB,GAAI,CAACsI,MAAM,CAACX,MAAM,CAAE,CACnB,MAAO,CAAAzP,MAAA,CAAAC,CAAA,QAAK,QAAM,eAAe,EAAC,YAAe,CAAC,CACnD,CACA,MAAO,CAAAmQ,MAAM,CAACc,KAAK,CAAC7P,GAAG,CAAC,SAAC4M,QAAQ,CAAEkD,CAAC,CAAK,CACxC,GAAM,CAAAO,SAAS,CAAGtB,MAAM,CAACX,MAAM,CAAE0B,CAAC,CAAC,CACnC,GAAI,CAACO,SAAS,CAAE,CACf,MAAO,CAAArB,MAAI,CAACvC,gBAAgB,CAAC,IAAI,CAAC,CACnC,CACA,GAAM,CAAA6D,WAAW,CAAGpG,GAAG,CAAC2F,KAAK,CAACxO,GAAG,CAACgP,SAAS,CAAC/Q,IAAI,CAAC,CACjD,GAAM,CAAAyQ,IAAI,CAAGO,WAAW,CAACC,MAAM,CAAGD,WAAW,CAAGpG,GAAG,CAAC2F,KAAK,CAACxO,GAAG,CAACuL,QAAQ,CAACtN,IAAI,CAAC,CAC5E,GAAM,CAAA0Q,QAAQ,CAAGnG,QAAQ,CAACoG,WAAW,CAACF,IAAI,CAAEP,YAAY,CAAC,CAAC,CAAC,CAAC,CAC5D,GAAM,CAAAzC,OAAO,UAAYH,QAAQ,CAACtN,IAAI,KAAI2P,YAAc,CACxD,MAAO,CAAAD,MAAI,CAACvC,gBAAgB,CAAC,CAC5BnN,IAAI,CAAE+Q,SAAS,CAAC/Q,IAAI,CACpBwN,GAAG,WAAWgD,CAAC,CAAG,CAAC,UAAQ,CAC3BhQ,IAAI,CAAEkQ,QAAQ,CACdjD,OAAO,CAAPA,OAAO,CACPH,QAAQ,CAAE,CAAED,EAAE,CAAE,CAAC,CAAEE,KAAK,CAAE,CAAE,CAC7B,CAAC,CAAC,CACH,CAAC,CAAC,CACH,CAEA,GAAM,CAAA2D,OAAO,CAAG3P,OAAO,CAAC4P,WAAW,CAAC5P,OAAO,CAACsF,OAAO,CAAC,CACpD,MAAO,CAAA4I,MAAM,CAACc,KAAK,CAAC7P,GAAG,CAAC,SAAC4M,QAAQ,CAAEkD,CAAC,CAAK,CACxC,GAAM,CAAAC,IAAI,CAAG7F,GAAG,CAAC2F,KAAK,CAACxO,GAAG,CAACuL,QAAQ,CAACtN,IAAI,CAAC,CACzC,GAAM,CAAA0Q,QAAQ,CAAGnG,QAAQ,CAACoG,WAAW,CAACF,IAAI,CAAEP,YAAY,CAAC,CAAC,CAAC,CAAC,CAC5D,GAAM,CAAAzC,OAAO,SAAWH,QAAQ,CAACtN,IAAI,KAAI2P,YAAc,CACvD,MAAO,CAAAD,MAAI,CAACvC,gBAAgB,CAAC,CAC5BnN,IAAI,CAAEyQ,IAAI,CAACzQ,IAAI,CACfwN,GAAG,WAAWgD,CAAC,CAAG,CAAC,EAAGU,OAAS,CAC/B1Q,IAAI,CAAEkQ,QAAQ,CACdjD,OAAO,CAAPA,OAAO,CACPH,QAAQ,CAARA,QACD,CAAC,CAAC,CACH,CAAC,CAAC,CACH,CAAC,CAAA7D,OAAA,CACD2H,wBAAwB,CAAxB,SAAAA,wBAAwBA,CAAC9P,OAA0B,CAAEC,OAA4B,CAAE,KAAA8P,oBAAA,CAAAC,MAAA,MAClF,GAAM,CAAArS,MAAM,CAAG,IAAI,CAAChB,KAAK,CAACC,IAAI,CAACe,MAAM,CACrC,GAAI,CAAAsS,UAAU,EAAAF,oBAAA,CAAG9P,OAAO,CAACiQ,WAAW,CAAC,CAAC,eAArBH,oBAAA,CAAuB/S,MAAM,CAC9C,GAAI,CAACiT,UAAU,GAAK,cAAc,EAAIA,UAAU,GAAK,aAAa,GAAKtS,MAAM,CAACwS,QAAQ,GAAK,YAAY,CAAE,CACxGF,UAAU,CAAG,QAAQ,CACtB,CACA,GAAM,CAAAG,UAAU,CAAGnQ,OAAO,CAACoQ,YAAY,CAACpQ,OAAO,CAACsF,OAAO,CAAC,CAExD,GAAM,CAAA+K,QAAQ,CAAGrQ,OAAO,CAACqO,KAAK,CAAC,CAAC,CAAGtL,IAAI,CAACC,KAAK,CAACtF,MAAM,CAAC6Q,MAAM,CAACC,CAAC,CAAG,CAAC,CAAC,CAAG9Q,MAAM,CAAC+Q,iBAAiB,CAC7F,GAAM,CAAA6B,aAAa,CAAG5S,MAAM,CAACuN,OAAO,CAACiD,MAAM,CAAC9R,MAAM,CAAG,CAAC,CAAGiU,QAAQ,CAEjE,MAAO,CACN3S,MAAM,CAACuN,OAAO,CAACiD,MAAM,CAAC/O,GAAG,CAAC,SAACyL,OAAO,CAAEqE,CAAC,CAAK,KAAAsB,QAAA,CACzC,GAAI,CAAA1E,QAAQ,CAAG,KAAK,CACpB,GAAImE,UAAU,GAAK,cAAc,EAAIA,UAAU,GAAK,oBAAoB,CAAE,CACzEnE,QAAQ,CAAG,IAAI,CAChB,CAAC,IAAM,IAAImE,UAAU,GAAK,QAAQ,EAAIA,UAAU,GAAK,aAAa,CAAE,CACnE,GAAIjN,IAAI,CAACyN,GAAG,CAACF,aAAa,CAAGrB,CAAC,CAAC,CAAG,CAAC,CAAEpD,QAAQ,CAAG,IAAI,CACrD,CAEA,IAAA0E,QAAA,CAAI3F,OAAO,SAAP2F,QAAA,CAAS9D,OAAO,CAAE7B,OAAO,CAAG,IAAI,CACpC,MAAO,CAAAmF,MAAI,CAAC5D,mBAAmB,CAAC,CAC/BvB,OAAO,CAAPA,OAAO,CACPqB,GAAG,CAAEJ,QAAQ,QAAYsE,UAAU,OAAKlB,CAAC,CAAG,CAAC,CAAE,CAC/CpD,QAAQ,CAAEA,QAAQ,EAAI,MAAM,CAC5BK,OAAO,oBAAqB+C,CAC7B,CAAC,CAAC,CACH,CAAC,CAAC,CAACwB,OAAO,CAAC,CAAC,CACZ3S,MAAA,CAAAC,CAAA,QAAKG,KAAK,CAAC,aAAa,CAAM,CAAC,CAC/BR,MAAM,CAACmR,QAAQ,CAACX,MAAM,CAAC/O,GAAG,CAAC,SAACyL,OAAO,CAAEqE,CAAC,CAAK,KAAAyB,SAAA,CAC1C,GAAI,CAAA7E,QAAQ,CAAG,KAAK,CACpB,GAAImE,UAAU,GAAK,aAAa,CAAE,CACjCnE,QAAQ,CAAG,IAAI,CAChB,CAAC,IAAM,IAAImE,UAAU,GAAK,QAAQ,EAAIA,UAAU,GAAK,cAAc,EAAIA,UAAU,GAAK,oBAAoB,CAAE,CAC3G,GAAIjN,IAAI,CAACyN,GAAG,CAACH,QAAQ,CAAGpB,CAAC,CAAC,CAAG,CAAC,CAAEpD,QAAQ,CAAG,IAAI,CAChD,CACA,GAAImE,UAAU,GAAK,oBAAoB,EAAIK,QAAQ,GAAKpB,CAAC,CAAEpD,QAAQ,CAAG,IAAI,CAE1E,IAAA6E,SAAA,CAAI9F,OAAO,SAAP8F,SAAA,CAASjE,OAAO,CAAE7B,OAAO,CAAG,IAAI,CACpC,MAAO,CAAAmF,MAAI,CAAC5D,mBAAmB,CAAC,CAC/BvB,OAAO,CAAPA,OAAO,CACPqB,GAAG,CAAEJ,QAAQ,QAAYsE,UAAU,OAAKlB,CAAC,CAAG,CAAC,CAAE,CAC/CpD,QAAQ,CAAEA,QAAQ,EAAI,MAAM,CAC5BK,OAAO,oBAAqB+C,CAC7B,CAAC,CAAC,CACH,CAAC,CAAC,CACF,CACF,CAAC,CAAA/G,OAAA,CACDyI,gBAAgB,CAAhB,SAAAA,gBAAgBA,CACf5Q,OAAgD,CAAEC,OAA4B,CAAE4Q,cAAwB,CACvG,KAAAC,qBAAA,CAAAC,sBAAA,CAAAC,OAAA,MACD,GAAM,CAAAC,SAAS,CAAGhR,OAAO,CAACiR,aAAa,CAAC,CAAC,CACzC,GAAM,CAAAC,YAAY,CAAG,CAACN,cAAc,IAAAC,qBAAA,CAAI7Q,OAAO,CAAC+M,kBAAkB,CAAC,CAAC,eAA5B8D,qBAAA,CAA8BK,YAAY,EAClF,GAAM,CAAAC,OAAO,CAAG,CAACP,cAAc,EAAI,CAACM,YAAY,IAAAJ,sBAAA,CAAI9Q,OAAO,CAAC+M,kBAAkB,CAAC,CAAC,eAA5B+D,sBAAA,CAA8BK,OAAO,EAEzF,MAAO,CAAArT,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY,EAC5BmT,YAAY,EAAIpT,MAAA,CAAAC,CAAA,OAAI,QAAM,aAAa,EAAC,MACpC,CAAAD,MAAA,CAAAC,CAAA,eAAQ,OAAa,CAAC,wDAAqD,CAAAD,MAAA,CAAAC,CAAA,UAAK,CACjF,CAAC,CACJoT,OAAO,EAAIrT,MAAA,CAAAC,CAAA,OAAI,QAAM,aAAa,EAAC,SAC5B,CAAAD,MAAA,CAAAC,CAAA,eAAQ,SAAe,CAAC,sBAAmB,CAAAD,MAAA,CAAAC,CAAA,UAAK,CACpD,CAAC,CACJgC,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACzL,GAAG,CAAC,SAACuP,aAAa,CAAEO,CAAC,CAAK,CAC/C,GAAM,CAAAmC,UAAU,CAAGD,OAAO,EAAIlC,CAAC,CAAG+B,SAAS,EAAIhR,OAAO,CAACqR,kBAAkB,CAACC,QAAQ,CAACrC,CAAC,CAAG,CAAC,CAAC,EAAIP,aAAa,CAACjC,OAAO,CAClH,MAAO,CAAAsE,OAAI,CAAC5E,mBAAmB,CAAC,CAC/BvB,OAAO,CAAE8D,aAAa,CACtBzC,GAAG,aAAagD,CAAC,CAAG,CAAC,CAAE,CACvBpD,QAAQ,CAAEuF,UAAU,CACpBlF,OAAO,kBAAmB+C,CAC3B,CAAC,CAAC,CACH,CAAC,CACG,CAAC,CACP,CAAC,CAAA/G,OAAA,CACDqJ,wBAAwB,CAAxB,SAAAA,wBAAwBA,CAACxR,OAA4B,CAAEC,OAA4B,CAAE,KAAAwR,OAAA,MACpF,MAAO,CAAAzR,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACzL,GAAG,CAAC,SAACuP,aAAa,CAAEO,CAAC,CAAK,CACrD,GAAM,CAAAmC,UAAU,CAAGpR,OAAO,CAACqR,kBAAkB,CAACC,QAAQ,CAACrC,CAAC,CAAG,CAAC,CAAC,CAC7D,MAAO,CAAAuC,OAAI,CAACrF,mBAAmB,CAAC,CAC/BvB,OAAO,CAAE8D,aAAa,CACtBzC,GAAG,aAAagD,CAAC,CAAG,CAAC,CAAE,CACvBpD,QAAQ,CAAEuF,UAAU,EAAI,MAAM,CAC9BlF,OAAO,kBAAmB+C,CAC3B,CAAC,CAAC,CACH,CAAC,CAAC,CACH,CAAC,CAAA/G,OAAA,CACDuJ,cAAc,CAAd,SAAAA,cAAcA,CAAA,CAAG,KAAAC,OAAA,MAChB,GAAM,CAAArN,IAAI,CAAG,IAAI,CAACA,IAAI,CACtB,GAAI,CAACA,IAAI,CAAE,OACX,MAAO,CAAAvG,MAAA,CAAAC,CAAA,QAAK,QAAM,gBAAgB,EACjCD,MAAA,CAAAC,CAAA,OAAI,QAAM,cAAc,EAAC,MAAQ,CAAC,CAClCD,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY,EACrBsG,IAAI,CAAClF,GAAG,CAAC,SAACuP,aAAa,CAAEO,CAAC,CAAK,CAC/B,MAAO,CAAAyC,OAAI,CAACvF,mBAAmB,CAAC,CAC/BvB,OAAO,CAAE8D,aAAa,CACtBzC,GAAG,CAAE,EAAE,CACPJ,QAAQ,CAAE,IAAI,CACdK,OAAO,kBAAmB+C,CAC3B,CAAC,CAAC,CACH,CAAC,CACG,CACD,CAAC,CACP,CAAC,CAAA/G,OAAA,CACDyJ,gBAAgB,CAAhB,SAAAA,gBAAgBA,CAAC5R,OAA0B,CAAEC,OAA4B,CAAE,KAAA4R,OAAA,MAC1E,MAAO,CAAA5R,OAAO,CAACqR,kBAAkB,CAAClS,GAAG,CAAC,SAAA0S,IAAI,CAAI,CAC7C,GAAM,CAAAnD,aAAa,CAAG3O,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACiH,IAAI,CAAG,CAAC,CAAC,CACpD,MAAO,CAAAD,OAAI,CAACzF,mBAAmB,CAAC,CAC/BvB,OAAO,CAAE8D,aAAa,CACtBzC,GAAG,YAAa4F,IAAM,CACtBhG,QAAQ,CAAE,IAAI,CACdK,OAAO,mBAAmB2F,IAAI,CAAG,CAAC,CACnC,CAAC,CAAC,CACH,CAAC,CAAC,CACH,CAAC,CAAA3J,OAAA,CACD4J,gBAAgB,CAAhB,SAAAA,gBAAgBA,CAAC/R,OAAsB,CAAEC,OAA4B,CAAE,CACtE,GAAI,CAACA,OAAO,CAAE,MAAO,KAAI,CACzB,GAAID,OAAO,CAAC0D,WAAW,GAAK,MAAM,EAAI1D,OAAO,CAAC0D,WAAW,GAAK,QAAQ,EAAI1D,OAAO,CAAC0D,WAAW,GAAK,MAAM,CAAE,OAC1G,GAAIzD,OAAO,CAAC+R,OAAO,CAAC,CAAC,CAAE,MAAO,KAAI,CAElC,GAAI,CAAAC,GAA4B,CAAG,CAClClU,MAAA,CAAAC,CAAA,WAAQ,WAAS,SAAS,CAAC,QAAM,QAAQ,EAACD,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAC,kBAAW,CAAI,CAAC,QAAa,CAAC,CAAE,GAAG,CAC3G,CACD,GAAIiC,OAAO,CAAC0D,MAAM,CAAC,CAAC,EAAI1D,OAAO,CAACiS,QAAQ,CAAE,CACzCD,GAAG,CAAG,CAAC,yBAAyB,CAAElU,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAC,CAC1C,CAAC,IAAM,IAAIiC,OAAO,CAAC0D,MAAM,CAAC,CAAC,EAAI1D,OAAO,CAACA,OAAO,CAAC5D,MAAM,EAAI,CAAC,CAAE,CAC3D4V,GAAG,CAAG,EAAE,CACT,CAEA,GAAM,CAAAtU,MAAM,CAAG,IAAI,CAAChB,KAAK,CAACC,IAAI,CAACe,MAAM,CACrC,IAAK,GAAI,CAAAuR,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGjP,OAAO,CAACA,OAAO,CAAC5D,MAAM,CAAE6S,CAAC,EAAE,CAAE,CAChD,GAAM,CAAAiD,YAAY,CAAGlS,OAAO,CAACA,OAAO,CAACiP,CAAC,CAAC,CACvC,GAAIiD,YAAY,GAAK,WAAW,CAAE,CACjCF,GAAG,CAACG,IAAI,CAAIpS,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACqE,CAAC,CAAC,CAACxQ,IAAI,0BAAyB,CAAC,CAClE,MAAO,CAAAuT,GAAG,CACX,CACA,GAAI,CAAAI,MAAM,QACV,GAAI,CACHA,MAAM,CAAGpS,OAAO,CAACqS,WAAW,CAACH,YAAY,CAAEjD,CAAC,CAAC,CAC9C,CAAE,MAAOqD,GAAQ,CAAE,CAClBN,GAAG,CAACG,IAAI,CAACrU,MAAA,CAAAC,CAAA,SAAM,QAAM,eAAe,EAAEuU,GAAG,CAACC,OAAc,CAAC,CAAC,CAC3D,CACA,GAAI,CAACH,MAAM,CAAE,SACb,GAAM,CAAAxH,OAAO,CAAG7K,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACqE,CAAC,CAAC,CACvC,GAAM,CAAAf,MAAM,CAAGnO,OAAO,CAAC0D,WAAW,GAAK,MAAM,CAAG1D,OAAO,CAACmO,MAAM,CAACe,CAAC,CAAC,CAAG,IAAI,CACxE,GAAImD,MAAM,CAACI,UAAU,GAAK,MAAM,CAAE,KAAAC,qBAAA,CACjCT,GAAG,CAACG,IAAI,CAAIvH,OAAO,CAACnM,IAAI,SAAQ,CAAC,CACjC,GAAI2T,MAAM,CAAC7M,IAAI,CAAEyM,GAAG,CAACG,IAAI,CAACrU,MAAA,CAAAC,CAAA,eAAQ,MAAY,CAAC,eAAgB,CAAC,CAChE,GAAIqU,MAAM,CAAC3M,KAAK,CAAEuM,GAAG,CAACG,IAAI,CAACrU,MAAA,CAAAC,CAAA,eAAQ,MAAY,CAAC,mBAAoB,CAAC,CACrE,GAAIqU,MAAM,CAAC1M,KAAK,CAAEsM,GAAG,CAACG,IAAI,CAACrU,MAAA,CAAAC,CAAA,eAAQ,MAAY,CAAC,mBAAoB,CAAC,CACrE,GAAIqU,MAAM,CAACzM,KAAK,CAAEqM,GAAG,CAACG,IAAI,CAACrU,MAAA,CAAAC,CAAA,eAAQ,OAAa,CAAC,cAAe,CAAC,CACjE,GAAIqU,MAAM,CAACtM,IAAI,CAAEkM,GAAG,CAACG,IAAI,kBAAmBrU,MAAA,CAAAC,CAAA,eAAS,CAAAmQ,MAAM,cAANA,MAAM,CAAER,eAAe,GAAI,KAAc,CAAC,SAAU,CAAC,CAC1G,GAAI0E,MAAM,CAACvM,GAAG,EAAIqI,MAAM,QAANA,MAAM,CAAElB,UAAU,CAAEgF,GAAG,CAACG,IAAI,CAACjE,MAAM,QAANA,MAAM,CAAEJ,UAAU,iCAAqC,CAAC,CACvGkE,GAAG,CAACG,IAAI,QAASrU,MAAA,CAAAC,CAAA,gBAAA0U,qBAAA,CAASzS,OAAO,CAACiQ,WAAW,CAACmC,MAAM,CAAEnD,CAAC,CAAC,eAA9BwD,qBAAA,CAAgChU,IAAa,CAAC,CAAC,CACzE,GAAI2T,MAAM,CAACM,SAAS,CAAG,CAAC,CAAE,CACzB,GAAM,CAAA3V,MAAM,CAAGW,MAAM,CAACuN,OAAO,CAACiD,MAAM,CAACkE,MAAM,CAACM,SAAS,CAAG,CAAC,CAAC,CAC1D,GAAI,CAAC3V,MAAM,CAAE,CACZiV,GAAG,CAACG,IAAI,aAAaC,MAAM,CAACM,SAAW,CAAC,CACzC,CAAC,IAAM,CACNV,GAAG,CAACG,IAAI,QAAQpV,MAAM,CAAC0B,IAAM,CAAC,CAC/B,CACD,CAAC,IAAM,IAAI2T,MAAM,CAACM,SAAS,CAAG,CAAC,CAAE,CAChC,GAAM,CAAA3V,OAAM,CAAGW,MAAM,CAACmR,QAAQ,CAACX,MAAM,CAAC,CAACkE,MAAM,CAACM,SAAS,CAAG,CAAC,CAAC,CAC5D,GAAI,CAAC3V,OAAM,CAAE,CACZiV,GAAG,CAACG,IAAI,kBAAkBC,MAAM,CAACM,SAAW,CAAC,CAC9C,CAAC,IAAM,CACNV,GAAG,CAACG,IAAI,aAAapV,OAAM,CAAC0B,IAAM,CAAC,CACpC,CACD,CACD,CAAC,IAAM,IAAI2T,MAAM,CAACI,UAAU,GAAK,QAAQ,CAAE,CAC1C,GAAM,CAAAzV,QAAM,CAAGgD,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACwH,MAAM,CAACO,aAAa,CAAG,CAAC,CAAC,CAC7DX,GAAG,CAACG,IAAI,CAAIvH,OAAO,CAACnM,IAAI,oBAAoBX,MAAA,CAAAC,CAAA,eAAShB,QAAM,CAAC0B,IAAa,CAAC,CAAC,CAC5E,CAAC,IAAM,IAAI2T,MAAM,CAACI,UAAU,GAAK,OAAO,CAAE,CACzCR,GAAG,CAACG,IAAI,CAAIvH,OAAO,CAACnM,IAAI,UAAUX,MAAA,CAAAC,CAAA,eAAQ,OAAa,CAAC,iBAAkB,CAAC,CAC5E,CAAC,IAAM,IAAIqU,MAAM,CAACI,UAAU,GAAK,MAAM,CAAE,CACxC,GAAM,CAAAzV,QAAM,CAAGgD,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACwH,MAAM,CAACO,aAAa,CAAG,CAAC,CAAC,CAC7DX,GAAG,CAACG,IAAI,eAAgBrU,MAAA,CAAAC,CAAA,eAAShB,QAAM,CAAC0B,IAAa,CAAC,CAAC,CACxD,CACAuT,GAAG,CAACG,IAAI,CAACrU,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAC,CACjB,CACA,MAAO,CAAAiU,GAAG,CACX,CAAC,CAAA9J,OAAA,CACD0K,2BAA2B,CAA3B,SAAAA,2BAA2BA,CAAA,CAAG,CAC7B,MAAO,CAAA9U,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,EAClBD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,WAAW,EAAC,iBAAe,CAAAD,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAC,kBAAW,CAAI,CAAS,CAC7G,CAAC,CACL,IAAI,CAAC0T,cAAc,CAAC,CACjB,CAAC,CACP,CAAC,CAAAvJ,OAAA,CACDqD,oBAAoB,CAApB,SAAAA,oBAAoBA,CAACxL,OAAsB,CAAE,CAC5C,GAAM,CAAApD,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAM,CAAA+O,KAAK,CAAG/O,IAAI,CAACe,MAAM,CAACwD,UAAU,CACpC,GAAI,CAACwK,KAAK,CAAE,MAAO,KAAI,CAACkH,2BAA2B,CAAC,CAAC,CAErD,GAAI,CAAA5S,OAAO,CAAGrD,IAAI,CAACqD,OAAO,CAC1B,GAAI,CAACA,OAAO,CAAE,MAAO,oCAAoC,CACzD,GAAIA,OAAO,CAACD,OAAO,GAAKA,OAAO,CAAE,CAChCC,OAAO,CAAG,GAAI,CAAAsK,mBAAmB,CAACvK,OAAO,CAAC,CAC1CpD,IAAI,CAACqD,OAAO,CAAGA,OAAO,CACvB,CAEA,GAAIA,OAAO,CAAC0D,MAAM,CAAC,CAAC,CAAE,CACrB,MAAO,CAAA5F,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,EACjB,IAAI,CAAC+T,gBAAgB,CAAC/R,OAAO,CAAEC,OAAO,CACnC,CAAC,CACNlC,MAAA,CAAAC,CAAA,QAAK,QAAM,KAAK,EACdiC,OAAO,CAACiS,QAAQ,CAAG,IAAI,CAAGnU,MAAA,CAAAC,CAAA,WAAQ,WAAS,SAAS,CAAC,QAAM,QAAQ,EAAC,QAAc,CAC/E,CAAC,CACL,IAAI,CAAC0T,cAAc,CAAC,CACjB,CAAC,CACP,CACA,GAAI1R,OAAO,CAACD,IAAI,CAAE,CACjBnD,IAAI,CAACe,MAAM,CAACiN,SAAS,CAAG5K,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAC5C,IAAI,CAACvG,IAAI,CAAGtE,OAAO,CAACD,IAAI,CAAC8K,OAAO,CACjC,CACA,OAAQ7K,OAAO,CAAC0D,WAAW,EAC3B,IAAK,MAAM,CAAE,CACZ,GAAM,CAAA4K,KAAK,CAAGrO,OAAO,CAACqO,KAAK,CAAC,CAAC,CAC7B,GAAM,CAAAzD,OAAO,CAAG7K,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAACyD,KAAK,CAAC,CAE3C,GAAIrO,OAAO,CAACsF,OAAO,CAAC4J,IAAI,CAAE,KAAA2D,qBAAA,CACzB,GAAM,CAAAC,QAAQ,EAAAD,qBAAA,CAAG7S,OAAO,CAACiQ,WAAW,CAAC,CAAC,eAArB4C,qBAAA,CAAuBpU,IAAI,CAC5C,MAAO,CAAAX,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,EACjB,IAAI,CAAC+T,gBAAgB,CAAC/R,OAAO,CAAEC,OAAO,CAAC,CACvC4K,OAAO,CAACnM,IAAI,CAAC,cAAY,CAAAX,MAAA,CAAAC,CAAA,eAAS+U,QAAiB,CAAC,cACjD,CAAC,CACNhV,MAAA,CAAAC,CAAA,QAAK,QAAM,gBAAgB,EAC1BD,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY,EACrB,IAAI,CAAC8R,wBAAwB,CAAC9P,OAAO,CAAEC,OAAO,CAC3C,CACD,CACD,CAAC,CACP,CAEA,GAAM,CAAA+S,QAAQ,CAAGpW,IAAI,CAACe,MAAM,CAACwS,QAAQ,GAAK,SAAS,EAAI7B,KAAK,GAAK,CAAC,CAElE,MAAO,CAAAvQ,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,EACjB,IAAI,CAAC+T,gBAAgB,CAAC/R,OAAO,CAAEC,OAAO,CAAC,CAAC,YAC/B,CAAAlC,MAAA,CAAAC,CAAA,eAAS6M,OAAO,CAACnM,IAAa,CAAC,OACrC,CAAC,CACNX,MAAA,CAAAC,CAAA,QAAK,QAAM,cAAc,EACxBD,MAAA,CAAAC,CAAA,OAAI,QAAM,YAAY,EAAC,QAAU,CAAC,CACjC,IAAI,CAAC8O,cAAc,CAAC7M,OAAO,CACxB,CAAC,CACNlC,MAAA,CAAAC,CAAA,QAAK,QAAM,gBAAgB,EACzBgV,QAAQ,EAAI,CACZjV,MAAA,CAAAC,CAAA,OAAI,QAAM,aAAa,EAAC,OAAS,CAAC,CAClCD,MAAA,CAAAC,CAAA,WAAQ,WAAS,QAAQ,EAAC,gBAAsB,CAAC,CACjD,CACDD,MAAA,CAAAC,CAAA,OAAI,QAAM,cAAc,EAAC,QAAU,CAAC,CACnC,IAAI,CAAC4S,gBAAgB,CAAC5Q,OAAO,CAAEC,OAAO,CACnC,CACD,CAAC,CACP,CAAE,IAAK,QAAQ,CAAE,CAChB,GAAM,CAAA4K,SAAO,CAAG7K,OAAO,CAACD,IAAI,CAAC8K,OAAO,CAAC5K,OAAO,CAACqO,KAAK,CAAC,CAAC,CAAC,CACrD,MAAO,CAAAvQ,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,EACjB,IAAI,CAAC+T,gBAAgB,CAAC/R,OAAO,CAAEC,OAAO,CAAC,CAAC,YAC/B,CAAAlC,MAAA,CAAAC,CAAA,eAAS6M,SAAO,CAACnM,IAAa,CAAC,OACrC,CAAC,CACNX,MAAA,CAAAC,CAAA,QAAK,QAAM,gBAAgB,EAC1BD,MAAA,CAAAC,CAAA,OAAI,QAAM,cAAc,EAAC,QAAU,CAAC,CACnC,IAAI,CAAC4S,gBAAgB,CAAC5Q,OAAO,CAAEC,OAAO,CAAE,IAAI,CACzC,CACD,CAAC,CACP,CAAE,IAAK,MAAM,CAAE,CACd,MAAO,CAAAlC,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,QAAK,QAAM,QAAQ,EACjBiC,OAAO,CAACqR,kBAAkB,CAACjV,MAAM,CAAG,CAAC,CACrC,CAAC0B,MAAA,CAAAC,CAAA,WAAQ,WAAS,SAAS,CAAC,QAAM,QAAQ,EAACD,MAAA,CAAAC,CAAA,MAAG,QAAM,oBAAoB,CAAC,kBAAW,CAAI,CAAC,QAAa,CAAC,CACtG,qCAAqC,CAAC,CAEvC,iCAEG,CAAC,CACND,MAAA,CAAAC,CAAA,QAAK,QAAM,gBAAgB,EAC1BD,MAAA,CAAAC,CAAA,OAAI,QAAM,cAAc,EAAC,SACjB,CAACiC,OAAO,CAACqR,kBAAkB,CAACjV,MAAM,EAAI,CAAC,iBAAoB4D,OAAO,CAACqR,kBAAkB,CAACjV,MAAM,CAAG,CAAC,CACpG,CAAC,CACL0B,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY,EACrB,IAAI,CAACwT,wBAAwB,CAACxR,OAAO,CAAEC,OAAO,CAAC,CAChDlC,MAAA,CAAAC,CAAA,QAAKG,KAAK,CAAC,YAAY,CAAM,CACzB,CACD,CAAC,CACNJ,MAAA,CAAAC,CAAA,QAAK,QAAM,gBAAgB,EACzBiC,OAAO,CAACqR,kBAAkB,CAACjV,MAAM,CAAG,CAAC,EAAI0B,MAAA,CAAAC,CAAA,OAAI,QAAM,cAAc,EAAC,aAAe,CAAC,CACnFD,MAAA,CAAAC,CAAA,QAAK,QAAM,YAAY,EACrB,IAAI,CAAC4T,gBAAgB,CAAC5R,OAAO,CAAEC,OAAO,CACnC,CACD,CACD,CAAC,CACP,CACA,CACA,MAAO,KAAI,CACZ,CAAC,CAAAkI,OAAA,CAEDoD,yBAAyB,CAAzB,SAAAA,yBAAyBA,CAAA,CAAG,CAC3B,GAAM,CAAA3O,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI,CAC5B,GAAM,CAAAqW,SAAS,CAAGrW,IAAI,CAACkN,KAAK,CAAG,GAAG,CAClC,MAAO,CAAA/L,MAAA,CAAAC,CAAA,QAAK,QAAM,UAAU,EAC3BD,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,SAAMG,KAAK,CAAC,cAAc,EACzBJ,MAAA,CAAAC,CAAA,MACCW,OAAO,CAAE,IAAI,CAACsH,oBAAqB,CACnC/H,IAAI,MAAOgV,MAAM,CAAC5T,MAAM,CAAC6T,OAAO,YAAY,CAC5C,QAAM,6BAA6B,EAEnCpV,MAAA,CAAAC,CAAA,MAAG,QAAM,gBAAgB,CAAC,kBAAW,CAAI,CAAC,mBAAmB,CAAC,CAC/DD,MAAA,CAAAC,CAAA,UAAK,CAAC,CACND,MAAA,CAAAC,CAAA,UAAK,CAAC,CACND,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,aAAa,EAC5CD,MAAA,CAAAC,CAAA,MAAG,QAAM,cAAc,CAAC,kBAAW,CAAI,CAAC,2BACjC,CACH,CAAC,CAEPD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,OAAO,CAACG,KAAK,CAAC,iBAAiB,EAC9DJ,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,SACrC,CAAC,IAAC,CACTiV,SAAS,EAAIlV,MAAA,CAAAC,CAAA,WAAQ,QAAM,qBAAqB,CAAC,WAAS,SAAS,CAACG,KAAK,CAAC,kBAAkB,EAC5FJ,MAAA,CAAAC,CAAA,MAAG,QAAM,YAAY,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,aACrC,CAAC,CACRiV,SAAS,EAAIlV,MAAA,CAAAC,CAAA,WAAQ,QAAM,qBAAqB,CAAC,WAAS,UAAU,EACpED,MAAA,CAAAC,CAAA,MAAG,QAAM,qBAAqB,CAAC,kBAAW,CAAI,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,YAC9C,CACN,CAAC,CACHpB,IAAI,CAACmD,IAAI,CACThC,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,QAAQ,EACvCD,MAAA,CAAAC,CAAA,eAAQ,WAAiB,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAAD,MAAA,CAAAC,CAAA,cAAO,sBAA2B,CAC3D,CAAC,IAAC,CACVD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,mCAAkCpB,IAAI,CAACe,MAAM,CAACuN,OAAO,CAACtN,EAAE,KAAIhB,IAAI,CAACe,MAAM,CAACwI,IAAO,EACrGpI,MAAA,CAAAC,CAAA,eAAQ,SAAe,CAAC,CAAAD,MAAA,CAAAC,CAAA,UAAK,CAAC,CAAAD,MAAA,CAAAC,CAAA,cAAO,sBAA2B,CACzD,CACN,CAAC,CAEJD,MAAA,CAAAC,CAAA,UACCD,MAAA,CAAAC,CAAA,WAAQ,QAAM,QAAQ,CAAC,WAAS,cAAc,EAACD,MAAA,CAAAC,CAAA,MAAG,QAAM,cAAc,CAAC,kBAAW,CAAI,CAAC,oBAAyB,CAC9G,CAEA,CAAC,CACP,CAAC,CAAAmK,OAAA;;AAkBQ7J,MAAM,CAAf,QAAS,CAAAA,MAAMA,CAAA,CAAG,KAAA8U,aAAA;AACjB,GAAM,CAAAxW,IAAI,CAAG,IAAI,CAACD,KAAK,CAACC,IAAI;AAC5B,IAAI,CAACiN,YAAY,CAAC,CAAC;AACnB,GAAM,CAAAjM,EAAE,SAAWhB,IAAI,CAACgB,EAAI;AAC5B,GAAM,CAAAyV,aAAa,CAAG,CAAAD,aAAA,CAAAxW,IAAI,CAACe,MAAM,SAAXyV,aAAA,CAAaE,YAAY,CAAGvV,MAAA,CAAAC,CAAA;AACjDgQ,uBAAuB,CAAE,CAAEC,MAAM,KAAMrQ,EAAE,qBAAoBA,EAAE,iDAAiD,CAAE;AAC3G,CAAC,CAAG,IAAI;;AAEhB,GAAIhB,IAAI,CAACkN,KAAK,CAAG,GAAG,CAAE;AACrB,MAAO,CAAA/L,MAAA,CAAAC,CAAA,CAACQ,cAAc,EAAC5B,IAAI,CAAEA,IAAK,CAAC2W,UAAU,MAAC9U,UAAU,CAAC,QAAQ;AAC/D4U,aAAa;AACdtV,MAAA,CAAAC,CAAA,CAAC0D,SAAS,EAAC9E,IAAI,CAAEA,IAAK,CAAE,CAAC;AACzBmB,MAAA,CAAAC,CAAA,CAACwV,OAAO;AACP,QAAM,wBAAwB,CAAC5W,IAAI,CAAEA,IAAK,CAAC6W,GAAG,CAAE,IAAI,CAACzN,YAAa,CAAC0N,cAAc;;AAEjF3V,MAAA,CAAAC,CAAA,QAAK,QAAM,iBAAiB,CAACgG,IAAI,CAAC,eAAe,CAAC,aAAW,iBAAiB;AAC5E,IAAI,CAACqH,cAAc,CAAC;AACjB;AACG,CAAC;AACVtN,MAAA,CAAAC,CAAA,CAAC2V,aAAa,EAAC/W,IAAI,CAAEA,IAAK,CAACgX,SAAS,CAAE,IAAI,CAAC/X,IAAK,CAACiJ,KAAK,CAAE,IAAI,CAACA,KAAM,CAAC+O,IAAI,CAAE,CAAE,CAAE,CAAC;AAC/E9V,MAAA,CAAAC,CAAA,CAAC8V,YAAY,EAAClX,IAAI,CAAEA,IAAK,CAAC6W,GAAG,CAAE,IAAI,CAACzN,YAAa,CAAC+N,SAAS,MAAE,CAAC;AAC9DhW,MAAA,CAAAC,CAAA;AACC,YAAU,eAAe,CAAC,QAAM,QAAQ;AACxCG,KAAK,CAAE,CAAE2F,QAAQ,CAAE,UAAU,CAAEC,KAAK,CAAE,MAAM,CAAE0P,GAAG,CAAE,IAAI,CAACzN,YAAa,CAAE;AACvE;;AAEO,CAAC;AACPpJ,IAAI,CAACe,MAAM,EAAI,CAACf,IAAI,CAACe,MAAM,CAAC2N,KAAK,EAAI1O,IAAI,CAACoD,OAAO,EAAIpD,IAAI,CAACe,MAAM,CAAC6Q,MAAM,CAAC5Q,EAAE,GAAKzC,EAAE,CAAC6Y,IAAI,CAACC,MAAM;AAC9FlW,MAAA,CAAAC,CAAA,CAACoE,WAAW,EAACxF,IAAI,CAAEA,IAAK,CAAE,CAAC;AAC5BmB,MAAA,CAAAC,CAAA,QAAK,QAAM,2BAA2B,CAAM;AAC7B,CAAC;AAClB;;AAEA,MAAO,CAAAD,MAAA,CAAAC,CAAA,CAACQ,cAAc,EAAC5B,IAAI,CAAEA,IAAK,CAAC2W,UAAU,MAAC9U,UAAU,CAAC,QAAQ;AAC/D4U,aAAa;AACdtV,MAAA,CAAAC,CAAA,CAAC0D,SAAS,EAAC9E,IAAI,CAAEA,IAAK,CAAE,CAAC;AACzBmB,MAAA,CAAAC,CAAA,CAACwV,OAAO;AACP,QAAM,wBAAwB,CAAC5W,IAAI,CAAEA,IAAK,CAACiX,IAAI,CAAE,GAAI,CAACH,cAAc;;;AAG5D,CAAC;AACV3V,MAAA,CAAAC,CAAA,CAAC2V,aAAa,EAAC/W,IAAI,CAAEA,IAAK,CAACgX,SAAS,CAAE,IAAI,CAAC/X,IAAK,CAACiJ,KAAK,CAAE,IAAI,CAACA,KAAM,CAAC+O,IAAI,CAAE,GAAI,CAAE,CAAC;AACjF9V,MAAA,CAAAC,CAAA,CAAC8V,YAAY,EAAClX,IAAI,CAAEA,IAAK,CAACiX,IAAI,CAAE,GAAI,CAACE,SAAS,MAAE,CAAC;AACjDhW,MAAA,CAAAC,CAAA;AACC,YAAU,eAAe,CAAC,QAAM,QAAQ;AACxCG,KAAK,CAAE,CAAE2F,QAAQ,CAAE,UAAU,CAAEC,KAAK,CAAE,MAAO,CAAE;AAC/C;;AAEO,CAAC;AACThG,MAAA,CAAAC,CAAA,QAAK,QAAM,2BAA2B;AACrCD,MAAA,CAAAC,CAAA,QAAK,QAAM,iBAAiB,CAACgG,IAAI,CAAC,eAAe,CAAC,aAAW,iBAAiB,CAAC7F,KAAK,CAAC,aAAa;AAC/FvB,IAAI,CAACe,MAAM,EAAI,CAACf,IAAI,CAACe,MAAM,CAAC2N,KAAK,EAAI1O,IAAI,CAACoD,OAAO,EAAIpD,IAAI,CAACe,MAAM,CAAC6Q,MAAM,CAAC5Q,EAAE,GAAKzC,EAAE,CAAC6Y,IAAI,CAACC,MAAM;AAC9FlW,MAAA,CAAAC,CAAA,CAACoE,WAAW,EAACxF,IAAI,CAAEA,IAAK,CAAE,CAAC;AAC3B,IAAI,CAACyO,cAAc,CAAC;AACjB;AACD;AACU,CAAC;AAClB,CAAC,QAAApH,WAAA,GA91BwB5E,WAAW,EAA/B4E,WAAW,CACArG,EAAE,CAAG,QAAQ,CADxBqG,WAAW,CAEA3E,MAAM,CAAG,CAAC,UAAU,CAAC,CAFhC2E,WAAW,CAGA1E,KAAK,CAAGG,UAAU;;;AA81BnCvE,EAAE,CAAC+Y,WAAW,CAACjQ,WAAW,CAAEjI,YAAY,CAAC","ignoreList":[]}