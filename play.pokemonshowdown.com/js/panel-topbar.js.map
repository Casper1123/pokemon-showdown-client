{"version":3,"file":"panel-topbar.js","names":["window","addEventListener","e","preventDefault","PSHeader","_preact$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","handleResize","_this$base$querySelec","_this$base$querySelec2","base","PS","leftPanelWidth","width","document","documentElement","clientWidth","oldNarrowMode","PSView","narrowMode","verticalHeaderWidth","NARROW_MODE_HEADER_WIDTH","VERTICAL_HEADER_WIDTH","style","textboxFocused","_document$documentEle","classList","add","_document$documentEle2","remove","update","_document$documentEle3","userbarLeft","querySelector","getBoundingClientRect","left","plusTabRight","right","overflow","display","_inheritsLoose","roomInfo","room","RoomType","roomTypes","type","icon","preact","h","title","idChunks","id","slice","split","formatName","BattleLog","_battle$p","_battle$p2","battle","p1","name","p2","startsWith","closeBracketIndex","indexOf","renderRoomTab","noAria","rooms","closable","cur","isVisible","notifying","isSubtleNotifying","hoverTitle","notifications","_i2","_PS$miniRoomList2","miniRoomList","_PS$rooms$roomid","roomid","miniNotifications","_i4","_notifications2","notif","body","className","_PSHeader$roomInfo","roomTitle","closeButton","value","aria","key","Object","assign","href","draggable","undefined","onDragEnter","handleDragEnter","onDragStart","handleDragStart","_proto","prototype","componentDidMount","_this2","user","subscribe","forceUpdate","componentDidUpdate","renderUser","_PS$connection","connection","connected","disabled","initializing","named","userColor","usernameColor","userid","renderVertical","role","onClick","scrollToHeader","src","Config","routes","client","alt","height","leftRoomList","map","rightRoomList","onDblClick","toggleMute","prefs","mute","render","Component","set","_PS$dragging","dragging","target","currentTarget","draggingRoom","draggedOverRoom","router","extractRoomID","leftIndex","dragOnto","rightIndex","PSMiniHeader","_preact$Component2","_this3","_len2","_key2","handleScroll","_proto2","componentWillUnmount","removeEventListener","notificationsCount","_i6","_PS$leftRoomList2","_PS$rooms$roomid2","_PSHeader$roomInfo2","panel","showMenuButton","scrollX","values","some","menuButton","scrollToRoom","getElementById"],"sources":["../src/panel-topbar.tsx"],"sourcesContent":["/**\r\n * Topbar Panel\r\n *\r\n * Topbar view - handles the topbar and some generic popups.\r\n *\r\n * Also handles global drag-and-drop support.\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\nimport preact from \"../js/lib/preact\";\r\nimport { Config, PS, type PSRoom, type RoomID } from \"./client-main\";\r\nimport { NARROW_MODE_HEADER_WIDTH, PSView, VERTICAL_HEADER_WIDTH } from \"./panels\";\r\nimport type { Battle } from \"./battle\";\r\nimport { BattleLog } from \"./battle-log\"; // optional\r\n\r\nwindow.addEventListener('dragover', e => {\r\n\t// this prevents the bounce-back animation\r\n\te.preventDefault();\r\n});\r\n\r\nexport class PSHeader extends preact.Component {\r\n\tstatic toggleMute = (e: Event) => {\r\n\t\tPS.prefs.set('mute', !PS.prefs.mute);\r\n\t\tPS.update();\r\n\t};\r\n\tstatic handleDragEnter = (e: DragEvent) => {\r\n\t\t// console.log('dragenter ' + e.dataTransfer!.dropEffect);\r\n\t\te.preventDefault();\r\n\t\tif (PS.dragging?.type !== 'room') return;\r\n\t\t/** the element being passed over */\r\n\t\tconst target = e.currentTarget as HTMLAnchorElement;\r\n\r\n\t\tconst draggingRoom = PS.dragging.roomid;\r\n\t\tif (draggingRoom === null) return;\r\n\r\n\t\tconst draggedOverRoom = PS.router.extractRoomID(target.href);\r\n\t\tif (draggedOverRoom === null) return; // should never happen\r\n\t\tif (draggingRoom === draggedOverRoom) return;\r\n\r\n\t\tconst leftIndex = PS.leftRoomList.indexOf(draggedOverRoom);\r\n\t\tif (leftIndex >= 0) {\r\n\t\t\tPS.dragOnto(PS.rooms[draggingRoom]!, 'left', leftIndex);\r\n\t\t} else {\r\n\t\t\tconst rightIndex = PS.rightRoomList.indexOf(draggedOverRoom);\r\n\t\t\tif (rightIndex >= 0) {\r\n\t\t\t\tPS.dragOnto(PS.rooms[draggingRoom]!, 'right', rightIndex);\r\n\t\t\t} else {\r\n\t\t\t\t// eslint-disable-next-line no-useless-return\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// dropEffect !== 'none' prevents bounce-back animation in\r\n\t\t// Chrome/Safari/Opera\r\n\t\t// if (e.dataTransfer) e.dataTransfer.dropEffect = 'move';\r\n\t};\r\n\tstatic handleDragStart = (e: DragEvent) => {\r\n\t\tconst roomid = PS.router.extractRoomID((e.currentTarget as HTMLAnchorElement).href);\r\n\t\tif (!roomid) return; // should never happen\r\n\r\n\t\tPS.dragging = { type: 'room', roomid };\r\n\t};\r\n\tstatic roomInfo(room: PSRoom) {\r\n\t\tconst RoomType = PS.roomTypes[room.type];\r\n\t\tlet icon = RoomType?.icon || <i class=\"fa fa-file-text-o\" aria-hidden></i>;\r\n\t\tlet title = room.title;\r\n\t\tswitch (room.type) {\r\n\t\tcase 'battle':\r\n\t\t\tlet idChunks = room.id.slice(7).split('-');\r\n\t\t\tlet formatName;\r\n\t\t\t// TODO: relocate to room implementation\r\n\t\t\tif (idChunks.length <= 1) {\r\n\t\t\t\tif (idChunks[0] === 'uploadedreplay') formatName = 'Uploaded Replay';\r\n\t\t\t} else {\r\n\t\t\t\tformatName = window.BattleLog ? BattleLog.formatName(idChunks[0]) : idChunks[0];\r\n\t\t\t}\r\n\t\t\tif (!title) {\r\n\t\t\t\tlet battle = (room as any).battle as Battle | undefined;\r\n\t\t\t\tlet p1 = battle?.p1?.name || '';\r\n\t\t\t\tlet p2 = battle?.p2?.name || '';\r\n\t\t\t\tif (p1 && p2) {\r\n\t\t\t\t\ttitle = `${p1} v. ${p2}`;\r\n\t\t\t\t} else if (p1 || p2) {\r\n\t\t\t\t\ttitle = `${p1}${p2}`;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttitle = `(empty room)`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ticon = <i class=\"text\">{formatName}</i>;\r\n\t\t\tbreak;\r\n\t\tcase 'html':\r\n\t\tdefault:\r\n\t\t\tif (title.startsWith('[')) {\r\n\t\t\t\tlet closeBracketIndex = title.indexOf(']');\r\n\t\t\t\tif (closeBracketIndex > 0) {\r\n\t\t\t\t\ticon = <i class=\"text\">{title.slice(1, closeBracketIndex)}</i>;\r\n\t\t\t\t\ttitle = title.slice(closeBracketIndex + 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn { icon, title };\r\n\t}\r\n\tstatic renderRoomTab(id: RoomID, noAria?: boolean) {\r\n\t\tconst room = PS.rooms[id];\r\n\t\tif (!room) return null;\r\n\t\tconst closable = (id === '' || id === 'rooms' ? '' : ' closable');\r\n\t\tconst cur = PS.isVisible(room) ? ' cur' : '';\r\n\t\tlet notifying = room.isSubtleNotifying ? ' subtle-notifying' : '';\r\n\t\tlet hoverTitle = '';\r\n\t\tlet notifications = room.notifications;\r\n\t\tif (id === '') {\r\n\t\t\tfor (const roomid of PS.miniRoomList) {\r\n\t\t\t\tconst miniNotifications = PS.rooms[roomid]?.notifications;\r\n\t\t\t\tif (miniNotifications?.length) notifications = [...notifications, ...miniNotifications];\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (notifications.length) {\r\n\t\t\tnotifying = ' notifying';\r\n\t\t\tfor (const notif of notifications) {\r\n\t\t\t\tif (!notif.body) continue;\r\n\t\t\t\thoverTitle += `${notif.title}\\n${notif.body}\\n`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet className = `roomtab button${notifying}${closable}${cur}`;\r\n\r\n\t\tlet { icon, title: roomTitle } = PSHeader.roomInfo(room);\r\n\t\tif (room.type === 'rooms' && PS.leftPanelWidth !== null) roomTitle = '';\r\n\t\tif (room.type === 'battle') className += ' roomtab-battle';\r\n\r\n\t\tlet closeButton = null;\r\n\t\tif (closable) {\r\n\t\t\tcloseButton = <button class=\"closebutton\" name=\"closeRoom\" value={id} aria-label=\"Close\">\r\n\t\t\t\t<i class=\"fa fa-times-circle\" aria-hidden></i>\r\n\t\t\t</button>;\r\n\t\t}\r\n\t\tconst aria: Record<string, string> = noAria ? {} : {\r\n\t\t\t\"role\": \"tab\", \"id\": `roomtab-${id}`, \"aria-selected\": cur ? \"true\" : \"false\",\r\n\t\t};\r\n\t\tif (id === 'rooms') aria['aria-label'] = \"Join chat\";\r\n\t\treturn <li class={id === '' ? 'home-li' : ''} key={id}>\r\n\t\t\t<a\r\n\t\t\t\tclass={className} href={`/${id}`} draggable={true} title={hoverTitle || undefined}\r\n\t\t\t\tonDragEnter={this.handleDragEnter} onDragStart={this.handleDragStart}\r\n\t\t\t\t{...aria}\r\n\t\t\t>\r\n\t\t\t\t{icon} {roomTitle}\r\n\t\t\t</a>\r\n\t\t\t{closeButton}\r\n\t\t</li>;\r\n\t}\r\n\thandleResize = () => {\r\n\t\tif (!this.base) return;\r\n\r\n\t\tif (PS.leftPanelWidth === null) {\r\n\t\t\tconst width = document.documentElement.clientWidth;\r\n\t\t\tconst oldNarrowMode = PSView.narrowMode;\r\n\t\t\tPSView.narrowMode = width <= 700;\r\n\t\t\tPSView.verticalHeaderWidth = PSView.narrowMode ? NARROW_MODE_HEADER_WIDTH : VERTICAL_HEADER_WIDTH;\r\n\t\t\tdocument.documentElement.style.width = PSView.narrowMode ? `${width + NARROW_MODE_HEADER_WIDTH}px` : 'auto';\r\n\t\t\tif (oldNarrowMode !== PSView.narrowMode) {\r\n\t\t\t\tif (PSView.narrowMode) {\r\n\t\t\t\t\tif (!PSView.textboxFocused) {\r\n\t\t\t\t\t\tdocument.documentElement.classList?.add('scroll-snap-enabled');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdocument.documentElement.classList?.remove('scroll-snap-enabled');\r\n\t\t\t\t}\r\n\t\t\t\tPS.update();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (PSView.narrowMode) {\r\n\t\t\tdocument.documentElement.classList?.remove('scroll-snap-enabled');\r\n\t\t\tPSView.narrowMode = false;\r\n\t\t}\r\n\r\n\t\tconst userbarLeft = this.base.querySelector('div.userbar')?.getBoundingClientRect()?.left;\r\n\t\tconst plusTabRight = this.base.querySelector('a.roomtab[aria-label=\"Join chat\"]')?.getBoundingClientRect()?.right;\r\n\t\tconst overflow = this.base.querySelector<HTMLElement>('.overflow');\r\n\r\n\t\tif (!overflow || !userbarLeft || !plusTabRight) return;\r\n\r\n\t\tif (plusTabRight > userbarLeft - 3) {\r\n\t\t\toverflow.style.display = 'block';\r\n\t\t} else {\r\n\t\t\toverflow.style.display = 'none';\r\n\t\t}\r\n\t};\r\n\toverride componentDidMount() {\r\n\t\tPS.user.subscribe(() => {\r\n\t\t\tthis.forceUpdate();\r\n\t\t});\r\n\t\twindow.addEventListener('resize', this.handleResize);\r\n\t\tthis.handleResize();\r\n\t}\r\n\toverride componentDidUpdate() {\r\n\t\tthis.handleResize();\r\n\t}\r\n\trenderUser() {\r\n\t\tif (!PS.connection?.connected) {\r\n\t\t\treturn <button class=\"button\" disabled><em>Offline</em></button>;\r\n\t\t}\r\n\t\tif (PS.user.initializing) {\r\n\t\t\treturn <button class=\"button\" disabled><em>Connecting...</em></button>;\r\n\t\t}\r\n\t\tif (!PS.user.named) {\r\n\t\t\treturn <a class=\"button\" href=\"login\">Choose name</a>;\r\n\t\t}\r\n\t\tconst userColor = window.BattleLog && `color:${BattleLog.usernameColor(PS.user.userid)}`;\r\n\t\treturn <span class=\"username\" style={userColor}>\r\n\t\t\t<span class=\"usernametext\">{PS.user.name}</span>\r\n\t\t</span>;\r\n\t}\r\n\trenderVertical() {\r\n\t\treturn <div\r\n\t\t\tid=\"header\" class=\"header-vertical\" role=\"navigation\"\r\n\t\t\tstyle={`width:${PSView.verticalHeaderWidth - 7}px`} onClick={PSView.scrollToHeader}\r\n\t\t>\r\n\t\t\t<div class=\"maintabbarbottom\"></div>\r\n\t\t\t<div class=\"scrollable-part\">\r\n\t\t\t\t<img\r\n\t\t\t\t\tclass=\"logo\"\r\n\t\t\t\t\tsrc={`https://${Config.routes.client}/favicon-256.png`}\r\n\t\t\t\t\talt=\"Pokémon Showdown! (beta)\"\r\n\t\t\t\t\twidth=\"50\" height=\"50\"\r\n\t\t\t\t/>\r\n\t\t\t\t<div class=\"tablist\" role=\"tablist\">\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t{PSHeader.renderRoomTab(PS.leftRoomList[0])}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t{PS.leftRoomList.slice(1).map(roomid => PSHeader.renderRoomTab(roomid))}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t\t<ul class=\"siderooms\">\r\n\t\t\t\t\t\t{PS.rightRoomList.map(roomid => PSHeader.renderRoomTab(roomid))}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{null /* overflow */}\r\n\t\t\t<div class=\"userbar\">\r\n\t\t\t\t{this.renderUser()} {}\r\n\t\t\t\t<div style=\"float:right\">\r\n\t\t\t\t\t<button class=\"icon button\" data-href=\"volume\" title=\"Sound\" aria-label=\"Sound\" onDblClick={PSHeader.toggleMute}>\r\n\t\t\t\t\t\t<i class={PS.prefs.mute ? 'fa fa-volume-off' : 'fa fa-volume-up'}></i>\r\n\t\t\t\t\t</button> {}\r\n\t\t\t\t\t<button class=\"icon button\" data-href=\"options\" title=\"Options\" aria-label=\"Options\">\r\n\t\t\t\t\t\t<i class=\"fa fa-cog\" aria-hidden></i>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\toverride render() {\r\n\t\tif (PS.leftPanelWidth === null) {\r\n\t\t\treturn this.renderVertical();\r\n\t\t}\r\n\t\treturn <div id=\"header\" class=\"header\" role=\"navigation\">\r\n\t\t\t<div class=\"maintabbarbottom\"></div>\r\n\t\t\t<div class=\"tabbar maintabbar\"><div class=\"inner-1\" role={PS.leftPanelWidth ? 'none' : 'tablist'}><div class=\"inner-2\">\r\n\t\t\t\t<ul class=\"maintabbar-left\" style={{ width: `${PS.leftPanelWidth}px` }} role={PS.leftPanelWidth ? 'tablist' : 'none'}>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tclass=\"logo\"\r\n\t\t\t\t\t\t\tsrc={`https://${Config.routes.client}/favicon-256.png`}\r\n\t\t\t\t\t\t\talt=\"Pokémon Showdown! (beta)\"\r\n\t\t\t\t\t\t\twidth=\"48\" height=\"48\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t{PSHeader.renderRoomTab(PS.leftRoomList[0])}\r\n\t\t\t\t\t{PS.leftRoomList.slice(1).map(roomid => PSHeader.renderRoomTab(roomid))}\r\n\t\t\t\t</ul>\r\n\t\t\t\t<ul class=\"maintabbar-right\" role={PS.leftPanelWidth ? 'tablist' : 'none'}>\r\n\t\t\t\t\t{PS.rightRoomList.map(roomid => PSHeader.renderRoomTab(roomid))}\r\n\t\t\t\t</ul>\r\n\t\t\t</div></div></div>\r\n\t\t\t<div class=\"overflow\">\r\n\t\t\t\t<button name=\"tablist\" class=\"button\" data-href=\"roomtablist\" aria-label=\"All tabs\" type=\"button\">\r\n\t\t\t\t\t<i class=\"fa fa-caret-down\" aria-hidden></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"userbar\">\r\n\t\t\t\t{this.renderUser()} {}\r\n\t\t\t\t<button class=\"icon button\" data-href=\"volume\" title=\"Sound\" aria-label=\"Sound\" onDblClick={PSHeader.toggleMute}>\r\n\t\t\t\t\t<i class={PS.prefs.mute ? 'fa fa-volume-off' : 'fa fa-volume-up'}></i>\r\n\t\t\t\t</button> {}\r\n\t\t\t\t<button class=\"icon button\" data-href=\"options\" title=\"Options\" aria-label=\"Options\">\r\n\t\t\t\t\t<i class=\"fa fa-cog\" aria-hidden></i>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n\r\nexport class PSMiniHeader extends preact.Component {\r\n\toverride componentDidMount() {\r\n\t\twindow.addEventListener('scroll', this.handleScroll);\r\n\t}\r\n\toverride componentWillUnmount() {\r\n\t\twindow.removeEventListener('scroll', this.handleScroll);\r\n\t}\r\n\thandleScroll = () => {\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\toverride render() {\r\n\t\tif (PS.leftPanelWidth !== null) return null;\r\n\r\n\t\tlet notificationsCount = 0;\r\n\t\tfor (const roomid of PS.leftRoomList) {\r\n\t\t\tconst miniNotifications = PS.rooms[roomid]?.notifications;\r\n\t\t\tif (miniNotifications?.length) notificationsCount++;\r\n\t\t}\r\n\t\tconst { icon, title } = PSHeader.roomInfo(PS.panel);\r\n\t\tconst userColor = window.BattleLog && `color:${BattleLog.usernameColor(PS.user.userid)}`;\r\n\t\tconst showMenuButton = PSView.narrowMode;\r\n\t\tconst notifying = (\r\n\t\t\t!showMenuButton && !window.scrollX && Object.values(PS.rooms).some(room => room!.notifications.length)\r\n\t\t) ? ' notifying' : '';\r\n\t\tconst menuButton = !showMenuButton ? (\r\n\t\t\tnull\r\n\t\t) : window.scrollX ? (\r\n\t\t\t<button onClick={PSView.scrollToHeader} class={`mini-header-left ${notifying}`} aria-label=\"Menu\">\r\n\t\t\t\t{!!notificationsCount && <div class=\"notification-badge\">{notificationsCount}</div>}\r\n\t\t\t\t<i class=\"fa fa-bars\" aria-hidden></i>\r\n\t\t\t</button>\r\n\t\t) : (\r\n\t\t\t<button onClick={PSView.scrollToRoom} class=\"mini-header-left\" aria-label=\"Menu\">\r\n\t\t\t\t<i class=\"fa fa-arrow-right\" aria-hidden></i>\r\n\t\t\t</button>\r\n\t\t);\r\n\t\treturn <div class=\"mini-header\" style={`left:${PSView.verticalHeaderWidth + (PSView.narrowMode ? 0 : -1)}px;`}>\r\n\t\t\t{menuButton}\r\n\t\t\t{icon} {title}\r\n\t\t\t<button data-href=\"options\" class=\"mini-header-right\" aria-label=\"Options\">\r\n\t\t\t\t{PS.user.named ? <strong style={userColor}>{PS.user.name}</strong> : <i class=\"fa fa-cog\" aria-hidden></i>}\r\n\t\t\t</button>\r\n\t\t</div>;\r\n\t}\r\n}\r\n\r\npreact.render(<PSView />, document.body, document.getElementById('ps-frame')!);\r\n"],"mappings":"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","ignoreList":[]}