{"version":3,"file":"panel-teamdropdown.js","names":["PSTeambuilder","exportPackedTeam","team","newFormat","sets","Teams","unpack","packedTeam","dex","Dex","forFormat","format","splitPrefix","buffer","delimiter","prefixOffset","arguments","length","undefined","delimIndex","indexOf","slice","splitLast","lastIndexOf","parseExportedTeamLine","line","isFirstLine","set","startsWith","_item","item","_line$split","split","trim","toID","endsWith","gender","ability","parenIndex","species","get","name","shiny","level","happiness","pokeball","hpType","dynamaxLevel","gigantamax","teraType","evLines","evs","hp","atk","def","spa","spd","spe","plus","minus","_i2","evLine","spaceIndex","statid","BattleStatIDs","charAt","parseInt","nature","getNature","ivLines","ivs","_i4","ivLine","statval","isNaN","exec","natureIndex","includes","moves","push","i","BattleNatures","importTeam","lines","curSet","shift","pop","_i6","PS","teams","unpackLine","importTeamBackup","curTeam","_i8","pack","folder","key","iconCache","isBox","_ref","_this$splitPrefix","dragStart","ev","_ev$currentTarget","href","currentTarget","getAttribute","byKey","dataTransfer","effectAllowed","setData","filename","$","replace","urlprefix","contents","downloadurl","encodeURIComponent","window","btoa","unescape","console","log","dragging","type","draggedTeam","TeamBox","props","unpackSpeciesOnly","map","pokemon","PSIcon","preact","h","modid","className","button","value","noLink","draggable","onDragStart","onClick","TeamDropdownPanel","_PSRoomPanel","_this","_len","args","Array","_key","call","apply","concat","gen","setFormat","target","preventDefault","stopImmediatePropagation","forceUpdate","click","e","curTarget","tagName","parentElement","loadTeam","chooseParentValue","_inheritsLoose","_proto","prototype","getTeams","_this2","list","filter","render","_this3","room","parentElem","PSPanelWrapper","baseFormat","isFirstLoad","availableWidth","document","body","offsetWidth","width","teamBuckets","_i0","_teams2","teamList","baseGen","genList","_i10","_PS$teams$list2","hasOtherGens","sort","isEmpty","style","display","PSRoomPanel","id","routes","location","noURL","FormatDropdownPanel","_PSRoomPanel2","_this4","_len2","_key2","search","_curTarget","updateSearch","toggleGen","_proto2","_this5","formatsLoaded","BattleFormats","curGen","searchBar","placeholder","autocomplete","onInput","onChange","selectType","curFormat","formats","Object","values","challengeShow","searchShow","tournamentShow","curSection","curColumnNum","curColumn","columns","searchID","_i12","column","section","unshift","Math","max","noResults","starredPrefs","prefs","starredformats","starred","keys","reverse","starredDone","test","addRoomType"],"sources":["../src/panel-teamdropdown.tsx"],"sourcesContent":["/**\r\n * Team Selector Panel\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\nimport { PS, type Team } from \"./client-main\";\r\nimport { PSIcon, PSPanelWrapper, PSRoomPanel } from \"./panels\";\r\nimport { Dex, toID, type ID } from \"./battle-dex\";\r\nimport { BattleNatures, BattleStatIDs, type StatNameExceptHP } from \"./battle-dex-data\";\r\nimport { Teams } from \"./battle-teams\";\r\n\r\nexport class PSTeambuilder {\r\n\tstatic exportPackedTeam(team: Team, newFormat?: boolean) {\r\n\t\tconst sets = Teams.unpack(team.packedTeam);\r\n\t\tconst dex = Dex.forFormat(team.format);\r\n\t\treturn Teams.export(sets, dex, newFormat);\r\n\t}\r\n\tstatic splitPrefix(buffer: string, delimiter: string, prefixOffset = 0): [string, string] {\r\n\t\tconst delimIndex = buffer.indexOf(delimiter);\r\n\t\tif (delimIndex < 0) return ['', buffer];\r\n\t\treturn [buffer.slice(prefixOffset, delimIndex), buffer.slice(delimIndex + delimiter.length)];\r\n\t}\r\n\tstatic splitLast(buffer: string, delimiter: string): [string, string] {\r\n\t\tconst delimIndex = buffer.lastIndexOf(delimiter);\r\n\t\tif (delimIndex < 0) return [buffer, ''];\r\n\t\treturn [buffer.slice(0, delimIndex), buffer.slice(delimIndex + delimiter.length)];\r\n\t}\r\n\tstatic parseExportedTeamLine(line: string, isFirstLine: boolean, set: Dex.PokemonSet) {\r\n\t\tif (isFirstLine || line.startsWith('[')) {\r\n\t\t\tlet item;\r\n\t\t\t[line, item] = line.split('@');\r\n\t\t\tline = line.trim();\r\n\t\t\titem = item?.trim();\r\n\t\t\tif (item) {\r\n\t\t\t\tset.item = item;\r\n\t\t\t\tif (toID(set.item) === 'noitem') set.item = '';\r\n\t\t\t}\r\n\t\t\tif (line.endsWith(' (M)')) {\r\n\t\t\t\tset.gender = 'M';\r\n\t\t\t\tline = line.slice(0, -4);\r\n\t\t\t}\r\n\t\t\tif (line.endsWith(' (F)')) {\r\n\t\t\t\tset.gender = 'F';\r\n\t\t\t\tline = line.slice(0, -4);\r\n\t\t\t}\r\n\t\t\tif (line.startsWith('[') && line.endsWith(']')) {\r\n\t\t\t\t// the ending `]` is necessary to establish this as ability\r\n\t\t\t\t// (rather than nickname starting with `[`)\r\n\t\t\t\tset.ability = line.slice(1, -1);\r\n\t\t\t\tif (toID(set.ability) === 'selectability') {\r\n\t\t\t\t\tset.ability = '';\r\n\t\t\t\t}\r\n\t\t\t} else if (line) {\r\n\t\t\t\tconst parenIndex = line.lastIndexOf(' (');\r\n\t\t\t\tif (line.endsWith(')') && parenIndex !== -1) {\r\n\t\t\t\t\tset.species = Dex.species.get(line.slice(parenIndex + 2, -1)).name;\r\n\t\t\t\t\tset.name = line.slice(0, parenIndex);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tset.species = Dex.species.get(line).name;\r\n\t\t\t\t\tset.name = '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (line.startsWith('Trait: ')) {\r\n\t\t\tset.ability = line.slice(7);\r\n\t\t} else if (line.startsWith('Ability: ')) {\r\n\t\t\tset.ability = line.slice(9);\r\n\t\t} else if (line.startsWith('Item: ')) {\r\n\t\t\tset.item = line.slice(6);\r\n\t\t} else if (line.startsWith('Nickname: ')) {\r\n\t\t\tset.name = line.slice(10);\r\n\t\t} else if (line.startsWith('Species: ')) {\r\n\t\t\tset.species = line.slice(9);\r\n\t\t} else if (line === 'Shiny: Yes' || line === 'Shiny') {\r\n\t\t\tset.shiny = true;\r\n\t\t} else if (line.startsWith('Level: ')) {\r\n\t\t\tset.level = +line.slice(7);\r\n\t\t} else if (line.startsWith('Happiness: ')) {\r\n\t\t\tset.happiness = +line.slice(11);\r\n\t\t} else if (line.startsWith('Pokeball: ')) {\r\n\t\t\tset.pokeball = line.slice(10);\r\n\t\t} else if (line.startsWith('Hidden Power: ')) {\r\n\t\t\tset.hpType = line.slice(14);\r\n\t\t} else if (line.startsWith('Dynamax Level: ')) {\r\n\t\t\tset.dynamaxLevel = +line.slice(15);\r\n\t\t} else if (line === 'Gigantamax: Yes' || line === 'Gigantamax') {\r\n\t\t\tset.gigantamax = true;\r\n\t\t} else if (line.startsWith('Tera Type: ')) {\r\n\t\t\tset.teraType = line.slice(11);\r\n\t\t} else if (line.startsWith('EVs: ')) {\r\n\t\t\tconst evLines = line.slice(5).split('(')[0].split('/');\r\n\t\t\tset.evs = { hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0 };\r\n\t\t\tlet plus = '', minus = '';\r\n\t\t\tfor (let evLine of evLines) {\r\n\t\t\t\tevLine = evLine.trim();\r\n\t\t\t\tconst spaceIndex = evLine.indexOf(' ');\r\n\t\t\t\tif (spaceIndex === -1) continue;\r\n\t\t\t\tconst statid = BattleStatIDs[evLine.slice(spaceIndex + 1)];\r\n\t\t\t\tif (!statid) continue;\r\n\t\t\t\tif (evLine.charAt(spaceIndex - 1) === '+') plus = statid;\r\n\t\t\t\tif (evLine.charAt(spaceIndex - 1) === '-') minus = statid;\r\n\t\t\t\tset.evs[statid] = parseInt(evLine.slice(0, spaceIndex), 10) || 0;\r\n\t\t\t}\r\n\t\t\tconst nature = this.getNature(plus as StatNameExceptHP, minus as StatNameExceptHP);\r\n\t\t\tif (nature !== 'Serious') {\r\n\t\t\t\tset.nature = nature as Dex.NatureName;\r\n\t\t\t}\r\n\t\t} else if (line.startsWith('IVs: ')) {\r\n\t\t\tconst ivLines = line.slice(5).split(' / ');\r\n\t\t\tset.ivs = { hp: 31, atk: 31, def: 31, spa: 31, spd: 31, spe: 31 };\r\n\t\t\tfor (let ivLine of ivLines) {\r\n\t\t\t\tivLine = ivLine.trim();\r\n\t\t\t\tconst spaceIndex = ivLine.indexOf(' ');\r\n\t\t\t\tif (spaceIndex === -1) continue;\r\n\t\t\t\tconst statid = BattleStatIDs[ivLine.slice(spaceIndex + 1)];\r\n\t\t\t\tif (!statid) continue;\r\n\t\t\t\tlet statval = parseInt(ivLine.slice(0, spaceIndex), 10);\r\n\t\t\t\tif (isNaN(statval)) statval = 31;\r\n\t\t\t\tset.ivs[statid] = statval;\r\n\t\t\t}\r\n\t\t} else if (/^[A-Za-z]+ (N|n)ature/.exec(line)) {\r\n\t\t\tlet natureIndex = line.indexOf(' Nature');\r\n\t\t\tif (natureIndex === -1) natureIndex = line.indexOf(' nature');\r\n\t\t\tif (natureIndex === -1) return;\r\n\t\t\tline = line.slice(0, natureIndex);\r\n\t\t\tif (line !== 'undefined') set.nature = line as Dex.NatureName;\r\n\t\t} else if (line.startsWith('-') || line.startsWith('~') || line.startsWith('Move:')) {\r\n\t\t\tif (line.startsWith('Move:')) line = line.slice(4);\r\n\t\t\tline = line.slice(line.charAt(1) === ' ' ? 2 : 1);\r\n\t\t\tif (line.startsWith('Hidden Power [')) {\r\n\t\t\t\tlet hpType = line.slice(14, line.indexOf(']')) as Dex.TypeName;\r\n\t\t\t\tif (hpType.includes(']') || hpType.includes('[')) hpType = '' as any;\r\n\t\t\t\tline = 'Hidden Power ' + hpType;\r\n\t\t\t\tset.hpType = hpType;\r\n\t\t\t}\r\n\t\t\tif (line === 'Frustration' && set.happiness === undefined) {\r\n\t\t\t\tset.happiness = 0;\r\n\t\t\t}\r\n\t\t\tset.moves.push(line);\r\n\t\t}\r\n\t}\r\n\tstatic getNature(plus: StatNameExceptHP | '', minus: StatNameExceptHP | '') {\r\n\t\tif (!plus || !minus) {\r\n\t\t\treturn 'Serious';\r\n\t\t}\r\n\t\tfor (const i in BattleNatures) {\r\n\t\t\tif (BattleNatures[i as 'Serious'].plus === plus && BattleNatures[i as 'Serious'].minus === minus) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 'Serious';\r\n\t}\r\n\tstatic importTeam(buffer: string): Dex.PokemonSet[] {\r\n\t\tconst lines = buffer.split(\"\\n\");\r\n\r\n\t\tconst sets: Dex.PokemonSet[] = [];\r\n\t\tlet curSet: Dex.PokemonSet | null = null;\r\n\r\n\t\twhile (lines.length && !lines[0]) lines.shift();\r\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\r\n\r\n\t\tif (lines.length === 1 && lines[0].includes('|')) {\r\n\t\t\treturn Teams.unpack(lines[0]);\r\n\t\t}\r\n\t\tfor (let line of lines) {\r\n\t\t\tline = line.trim();\r\n\t\t\tif (line === '' || line === '---') {\r\n\t\t\t\tcurSet = null;\r\n\t\t\t} else if (line.startsWith('===')) {\r\n\t\t\t\t// team backup format; ignore\r\n\t\t\t} else if (line.includes('|')) {\r\n\t\t\t\t// packed format\r\n\t\t\t\tconst team = PS.teams.unpackLine(line);\r\n\t\t\t\tif (!team) continue;\r\n\t\t\t\treturn Teams.unpack(team.packedTeam);\r\n\t\t\t} else if (!curSet) {\r\n\t\t\t\tcurSet = {\r\n\t\t\t\t\tname: '', species: '', gender: '',\r\n\t\t\t\t\tmoves: [],\r\n\t\t\t\t};\r\n\t\t\t\tsets.push(curSet);\r\n\t\t\t\tthis.parseExportedTeamLine(line, true, curSet);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parseExportedTeamLine(line, false, curSet);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn sets;\r\n\t}\r\n\tstatic importTeamBackup(buffer: string): Team[] {\r\n\t\tconst teams: Team[] = [];\r\n\t\tconst lines = buffer.split(\"\\n\");\r\n\r\n\t\tlet curTeam: Team | null = null;\r\n\t\tlet sets: Dex.PokemonSet[] | null = null;\r\n\r\n\t\tlet curSet: Dex.PokemonSet | null = null;\r\n\r\n\t\twhile (lines.length && !lines[0]) lines.shift();\r\n\t\twhile (lines.length && !lines[lines.length - 1]) lines.pop();\r\n\r\n\t\tfor (let line of lines) {\r\n\t\t\tline = line.trim();\r\n\t\t\tif (line === '' || line === '---') {\r\n\t\t\t\tcurSet = null;\r\n\t\t\t} else if (line.startsWith('===')) {\r\n\t\t\t\tif (curTeam) {\r\n\t\t\t\t\t// not the first team, store the previous team\r\n\t\t\t\t\tcurTeam.packedTeam = Teams.pack(sets);\r\n\t\t\t\t\tteams.push(curTeam);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurTeam = {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tformat: '' as ID,\r\n\t\t\t\t\tpackedTeam: '',\r\n\t\t\t\t\tfolder: '',\r\n\t\t\t\t\tkey: '',\r\n\t\t\t\t\ticonCache: '',\r\n\t\t\t\t\tisBox: false,\r\n\t\t\t\t};\r\n\t\t\t\tsets = [];\r\n\r\n\t\t\t\tline = line.slice(3, -3).trim();\r\n\t\t\t\t[curTeam.format, line] = this.splitPrefix(line, ']', 1) as [ID, string];\r\n\t\t\t\tif (!curTeam.format) curTeam.format = 'gen8' as ID;\r\n\t\t\t\telse if (!curTeam.format.startsWith('gen')) curTeam.format = `gen6${curTeam.format}` as ID;\r\n\r\n\t\t\t\t[curTeam.folder, curTeam.name] = this.splitPrefix(line, '/');\r\n\t\t\t} else if (line.includes('|')) {\r\n\t\t\t\tif (curTeam) {\r\n\t\t\t\t\t// not the first team, store the previous team\r\n\t\t\t\t\tcurTeam.packedTeam = Teams.pack(sets);\r\n\t\t\t\t\tteams.push(curTeam);\r\n\t\t\t\t}\r\n\t\t\t\tcurTeam = null;\r\n\t\t\t\tcurSet = null;\r\n\t\t\t\tconst team = PS.teams.unpackLine(line);\r\n\t\t\t\tif (team) teams.push(team);\r\n\t\t\t} else if (!curSet) {\r\n\t\t\t\tif (!sets) continue; // corruption\r\n\t\t\t\tcurSet = {\r\n\t\t\t\t\tname: '', species: '', gender: '',\r\n\t\t\t\t\tmoves: [],\r\n\t\t\t\t};\r\n\t\t\t\tsets.push(curSet);\r\n\t\t\t\tthis.parseExportedTeamLine(line, true, curSet);\r\n\t\t\t} else {\r\n\t\t\t\tthis.parseExportedTeamLine(line, false, curSet);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (curTeam) {\r\n\t\t\tcurTeam.packedTeam = Teams.pack(sets);\r\n\t\t\tteams.push(curTeam);\r\n\t\t}\r\n\t\treturn teams;\r\n\t}\r\n\r\n\tstatic draggedTeam: Team | null = null;\r\n\tstatic dragStart(ev: DragEvent) {\r\n\t\tconst href = (ev.currentTarget as HTMLAnchorElement)?.getAttribute('href');\r\n\t\tconst team = href ? PS.teams.byKey[href.slice(5)] : null;\r\n\t\tif (!team) return;\r\n\r\n\t\tconst dataTransfer = ev.dataTransfer;\r\n\t\tif (dataTransfer) {\r\n\t\t\tdataTransfer.effectAllowed = 'copyMove';\r\n\t\t\tdataTransfer.setData(\"text/plain\", \"[Team] \" + team.name);\r\n\t\t\tlet filename = team.name;\r\n\t\t\tif (team.format) filename = '[' + team.format + '] ' + filename;\r\n\t\t\tfilename = $.trim(filename).replace(/[\\\\/]+/g, '') + '.txt';\r\n\t\t\tconst urlprefix = \"data:text/plain;base64,\";\r\n\t\t\tconst contents = PSTeambuilder.exportPackedTeam(team).replace(/\\n/g, '\\r\\n');\r\n\t\t\tconst downloadurl = \"text/plain:\" + filename + \":\" + urlprefix + encodeURIComponent(window.btoa(unescape(encodeURIComponent(contents))));\r\n\t\t\tconsole.log(downloadurl);\r\n\t\t\tdataTransfer.setData(\"DownloadURL\", downloadurl);\r\n\t\t}\r\n\r\n\t\tPS.dragging = { type: 'team', team, folder: null };\r\n\t\t// app.draggingRoom = this.id;\r\n\t\t// app.draggingLoc = parseInt(e.currentTarget.dataset.value, 10);\r\n\t\t// var elOffset = $(e.currentTarget).offset();\r\n\t\t// app.draggingOffsetX = e.originalEvent.pageX - elOffset.left;\r\n\t\t// app.draggingOffsetY = e.originalEvent.pageY - elOffset.top;\r\n\t\t// this.finalOffset = null;\r\n\t\t// setTimeout(function () {\r\n\t\t// \t$(e.currentTarget).parent().addClass('dragging');\r\n\t\t// }, 0);\r\n\t}\r\n}\r\n\r\nexport function TeamBox(props: {\r\n\tteam: Team | null,\r\n\tnoLink?: boolean,\r\n\tbutton?: boolean,\r\n\tonClick?: () => void,\r\n}) {\r\n\tconst team = props.team;\r\n\tlet contents;\r\n\tif (team) {\r\n\t\tteam.iconCache ||= team.packedTeam ? (\r\n\t\t\tTeams.unpackSpeciesOnly(team.packedTeam).map(\r\n\t\t\t\t// can't use <PSIcon>, weird interaction with iconCache\r\n\t\t\t\t// don't try this at home; I'm a trained professional\r\n\t\t\t\tpokemon => PSIcon({ pokemon })\r\n\t\t\t)\r\n\t\t) : (\r\n\t\t\t<em>(empty {team.isBox ? 'box' : 'team'})</em>\r\n\t\t);\r\n\t\tlet format = team.format as string;\r\n\t\tif (format.startsWith(Dex.modid)) format = format.slice(4);\r\n\t\tformat = (format ? `[${format}] ` : ``) + (team.folder ? `${team.folder}/` : ``);\r\n\t\tcontents = [\r\n\t\t\t<strong>{team.isBox && <i class=\"fa fa-archive\"></i>} {format && <span>{format}</span>}{team.name}</strong>,\r\n\t\t\t<small>{team.iconCache}</small>,\r\n\t\t];\r\n\t} else {\r\n\t\tcontents = [\r\n\t\t\t<em>Select a team</em>,\r\n\t\t];\r\n\t}\r\n\tconst className = `team${team?.isBox ? ' pc-box' : ''}`;\r\n\tif (props.button) {\r\n\t\treturn <button class={className} value={team ? team.key : ''}>\r\n\t\t\t{contents}\r\n\t\t</button>;\r\n\t}\r\n\tif (props.noLink) {\r\n\t\treturn <div class={className}>\r\n\t\t\t{contents}\r\n\t\t</div>;\r\n\t}\r\n\treturn <a\r\n\t\thref={`team-${team ? team.key : ''}`} class={className} draggable\r\n\t\tonDragStart={PSTeambuilder.dragStart} onClick={props.onClick}\r\n\t>\r\n\t\t{contents}\r\n\t</a>;\r\n}\r\n\r\n/**\r\n * Team selector popup\r\n */\r\n\r\nclass TeamDropdownPanel extends PSRoomPanel {\r\n\tstatic readonly id = 'teamdropdown';\r\n\tstatic readonly routes = ['teamdropdown'];\r\n\tstatic readonly location = 'semimodal-popup';\r\n\tstatic readonly noURL = true;\r\n\tgen = '';\r\n\tformat: string | null = null;\r\n\tgetTeams() {\r\n\t\tif (!this.format && !this.gen) return PS.teams.list;\r\n\t\treturn PS.teams.list.filter(team => {\r\n\t\t\tif (this.gen && !team.format.startsWith(this.gen)) return false;\r\n\t\t\tif (this.format && team.format !== this.format) return false;\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\tsetFormat = (ev: MouseEvent) => {\r\n\t\tconst target = ev.currentTarget as HTMLButtonElement;\r\n\t\tthis.format = (target.name === 'format' && target.value) || '';\r\n\t\tthis.gen = (target.name === 'gen' && target.value) || '';\r\n\t\tev.preventDefault();\r\n\t\tev.stopImmediatePropagation();\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\tclick = (e: MouseEvent) => {\r\n\t\tlet curTarget = e.target as HTMLElement | null;\r\n\t\tlet target;\r\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\r\n\t\t\tif (curTarget.tagName === 'BUTTON') {\r\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\r\n\t\t\t}\r\n\t\t\tcurTarget = curTarget.parentElement;\r\n\t\t}\r\n\t\tif (!target) return;\r\n\r\n\t\tPS.teams.loadTeam(PS.teams.byKey[target.value], true);\r\n\t\tthis.chooseParentValue(target.value);\r\n\t};\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\tif (!room.parentElem) {\r\n\t\t\treturn <PSPanelWrapper room={room}>\r\n\t\t\t\t<p>Error: You tried to open a team selector, but you have nothing to select a team for.</p>\r\n\t\t\t</PSPanelWrapper>;\r\n\t\t}\r\n\t\tconst baseFormat = room.parentElem.getAttribute('data-format') || Dex.modid;\r\n\t\tlet isFirstLoad = this.format === null;\r\n\t\tif (isFirstLoad) {\r\n\t\t\tthis.format = baseFormat;\r\n\t\t}\r\n\t\tlet teams = this.getTeams();\r\n\t\tif (!teams.length && this.format && isFirstLoad) {\r\n\t\t\tthis.gen = this.format.slice(0, 4);\r\n\t\t\tthis.format = '';\r\n\t\t\tteams = this.getTeams();\r\n\t\t}\r\n\t\tif (!teams.length && this.gen && isFirstLoad) {\r\n\t\t\tthis.gen = '';\r\n\t\t\tteams = this.getTeams();\r\n\t\t}\r\n\r\n\t\tlet availableWidth = document.body.offsetWidth;\r\n\t\tlet width = 307;\r\n\t\tif (availableWidth > 636) width = 613;\r\n\t\tif (availableWidth > 945) width = 919;\r\n\r\n\t\tlet teamBuckets: { [folder: string]: Team[] } = {};\r\n\t\tfor (const team of teams) {\r\n\t\t\tconst list = teamBuckets[team.folder] || (teamBuckets[team.folder] = []);\r\n\t\t\tlist.push(team);\r\n\t\t}\r\n\r\n\t\tlet teamList = [];\r\n\r\n\t\tconst baseGen = baseFormat.slice(0, 4);\r\n\t\tlet genList: string[] = [];\r\n\t\tfor (const team of PS.teams.list) {\r\n\t\t\tconst gen = team.format.slice(0, 4);\r\n\t\t\tif (gen && !genList.includes(gen)) genList.push(gen);\r\n\t\t}\r\n\t\tconst hasOtherGens = genList.length > 1 || genList[0] !== baseGen;\r\n\r\n\t\tteamList.push(<p>\r\n\t\t\t{baseFormat.length > 4 && (\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass={'button' + (baseFormat === this.format ? ' disabled' : '')}\r\n\t\t\t\t\tonClick={this.setFormat} name=\"format\" value={baseFormat}\r\n\t\t\t\t>\r\n\t\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseFormat.slice(0, 4)}] {baseFormat.slice(4)}\r\n\t\t\t\t</button>\r\n\t\t\t)} {}\r\n\t\t\t<button\r\n\t\t\t\tclass={'button' + (baseGen === this.format ? ' disabled' : '')} onClick={this.setFormat} name=\"format\" value={baseGen}\r\n\t\t\t>\r\n\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseGen}] <em>(uncategorized)</em>\r\n\t\t\t</button> {}\r\n\t\t\t<button\r\n\t\t\t\tclass={'button' + (baseGen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={baseGen}\r\n\t\t\t>\r\n\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{baseGen}] <em>(all)</em>\r\n\t\t\t</button> {}\r\n\t\t\t{hasOtherGens && !this.gen && (\r\n\t\t\t\t<button class=\"button\" onClick={this.setFormat} name=\"gen\" value={baseGen}>Other gens</button>\r\n\t\t\t)}\r\n\t\t</p>);\r\n\r\n\t\tif (hasOtherGens && this.gen) {\r\n\t\t\tteamList.push(<h2>Other gens</h2>);\r\n\t\t\tteamList.push(<p>{genList.sort().map(gen => [\r\n\t\t\t\t<button class={'button' + (gen === this.gen ? ' disabled' : '')} onClick={this.setFormat} name=\"gen\" value={gen}>\r\n\t\t\t\t\t<i class=\"fa fa-folder-o\" aria-hidden></i> [{gen}] <em>(all)</em>\r\n\t\t\t\t</button>,\r\n\t\t\t\t\" \",\r\n\t\t\t])}</p>);\r\n\t\t}\r\n\r\n\t\tlet isEmpty = true;\r\n\t\tfor (let folder in teamBuckets) {\r\n\t\t\tif (folder && (this.gen || this.format)) {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open\" aria-hidden></i> {folder} + {}\r\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> {this.format || this.gen}\r\n\t\t\t\t</h2>);\r\n\t\t\t} else if (folder) {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open\" aria-hidden></i> {folder}\r\n\t\t\t\t</h2>);\r\n\t\t\t} else if (this.gen || this.format) {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> {this.format || this.gen}\r\n\t\t\t\t</h2>);\r\n\t\t\t} else {\r\n\t\t\t\tteamList.push(<h2>\r\n\t\t\t\t\t<i class=\"fa fa-folder-open-o\" aria-hidden></i> Teams not in any folders\r\n\t\t\t\t</h2>);\r\n\t\t\t}\r\n\t\t\tteamList.push(<ul class=\"teamdropdown\" onClick={this.click}>\r\n\t\t\t\t{teamBuckets[folder].map(team => <li key={team.key} style={{ display: 'inline-block' }}>\r\n\t\t\t\t\t<TeamBox team={team} button />\r\n\t\t\t\t</li>)}\r\n\t\t\t</ul>);\r\n\t\t\tisEmpty = false;\r\n\t\t}\r\n\r\n\t\treturn <PSPanelWrapper room={room} width={width}><div class=\"pad\">\r\n\t\t\t{teamList}\r\n\t\t\t{isEmpty && <p><em>No teams found</em></p>}\r\n\t\t</div></PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nexport interface FormatData {\r\n\tid: ID;\r\n\tname: string;\r\n\tteam?: 'preset' | null;\r\n\tsection: string;\r\n\tcolumn: number;\r\n\tsearchShow?: boolean;\r\n\tchallengeShow?: boolean;\r\n\ttournamentShow?: boolean;\r\n\trated: boolean;\r\n\tteambuilderLevel?: number | null;\r\n\tteambuilderFormat?: ID;\r\n\tbattleFormat?: string;\r\n\tisTeambuilderFormat: boolean;\r\n\teffectType: 'Format';\r\n}\r\n\r\ndeclare const BattleFormats: { [id: string]: FormatData };\r\n\r\nexport type SelectType = 'teambuilder' | 'challenge' | 'search' | 'tournament';\r\nclass FormatDropdownPanel extends PSRoomPanel {\r\n\tstatic readonly id = 'formatdropdown';\r\n\tstatic readonly routes = ['formatdropdown'];\r\n\tstatic readonly location = 'semimodal-popup';\r\n\tstatic readonly noURL = true;\r\n\tgen = '' as ID;\r\n\tformat: string | null = null;\r\n\tsearch = '';\r\n\tclick = (e: MouseEvent) => {\r\n\t\tlet curTarget = e.target as HTMLElement | null;\r\n\t\tlet target;\r\n\t\tif (curTarget?.tagName === 'I') return;\r\n\t\twhile (curTarget && curTarget !== e.currentTarget) {\r\n\t\t\tif (curTarget.tagName === 'BUTTON') {\r\n\t\t\t\ttarget = curTarget as HTMLButtonElement;\r\n\t\t\t}\r\n\t\t\tcurTarget = curTarget.parentElement;\r\n\t\t}\r\n\t\tif (!target) return;\r\n\r\n\t\tthis.chooseParentValue(target.value);\r\n\t};\r\n\tupdateSearch = (ev: Event) => {\r\n\t\tthis.search = (ev.currentTarget as HTMLInputElement).value;\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\ttoggleGen = (ev: Event) => {\r\n\t\tconst target = ev.currentTarget as HTMLButtonElement;\r\n\t\tthis.gen = this.gen === target.value ? '' as ID : target.value as ID;\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\toverride render() {\r\n\t\tconst room = this.props.room;\r\n\t\tif (!room.parentElem) {\r\n\t\t\treturn <PSPanelWrapper room={room}>\r\n\t\t\t\t<p>Error: You tried to open a format selector, but you have nothing to select a format for.</p>\r\n\t\t\t</PSPanelWrapper>;\r\n\t\t}\r\n\r\n\t\tlet formatsLoaded = !!window.BattleFormats;\r\n\t\tif (formatsLoaded) {\r\n\t\t\tformatsLoaded = false;\r\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\t\tfor (let i in window.BattleFormats) {\r\n\t\t\t\tformatsLoaded = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst curGen = (gen: string) => this.gen === gen ? ' cur' : '';\r\n\t\tconst searchBar = <div style=\"margin-bottom: 0.5em\">\r\n\t\t\t<input\r\n\t\t\t\ttype=\"search\" name=\"search\" placeholder=\"Search formats\" class=\"textbox autofocus\" autocomplete=\"off\"\r\n\t\t\t\tonInput={this.updateSearch} onChange={this.updateSearch}\r\n\t\t\t/> {}\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen9\" class={`button button-first${curGen('gen9')}`}>Gen 9</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen8\" class={`button button-middle${curGen('gen8')}`}>8</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen7\" class={`button button-middle${curGen('gen7')}`}>7</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen6\" class={`button button-middle${curGen('gen6')}`}>6</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen5\" class={`button button-middle${curGen('gen5')}`}>5</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen4\" class={`button button-middle${curGen('gen4')}`}>4</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen3\" class={`button button-middle${curGen('gen3')}`}>3</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen2\" class={`button button-middle${curGen('gen2')}`}>2</button>\r\n\t\t\t<button onClick={this.toggleGen} value=\"gen1\" class={`button button-last${curGen('gen1')}`}>1</button>\r\n\t\t</div>;\r\n\t\tif (!formatsLoaded) {\r\n\t\t\treturn <PSPanelWrapper room={room}><div class=\"pad\">\r\n\t\t\t\t{searchBar}\r\n\t\t\t\t<p>Loading...</p>\r\n\t\t\t</div></PSPanelWrapper>;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * 'challenge' hides search-only formats, and 'search' hides challenge-only\r\n\t\t * formats. 'teambuilder' shows teambuilder formats (removing parentheses\r\n\t\t * from format names).\r\n\t\t */\r\n\t\tconst selectType: SelectType = (\r\n\t\t\troom.parentElem.getAttribute('data-selecttype') as any || 'challenge'\r\n\t\t);\r\n\t\tconst curFormat = toID((room.parentElem as HTMLButtonElement).value);\r\n\t\tconst formats = Object.values(BattleFormats).filter(format => {\r\n\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return false;\r\n\t\t\tif (selectType === 'search' && format.searchShow === false) return false;\r\n\t\t\tif (selectType === 'tournament' && format.tournamentShow === false) return false;\r\n\t\t\tif (selectType === 'teambuilder' && format.team) return false;\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tlet curSection = '';\r\n\t\tlet curColumnNum = 0;\r\n\t\tlet curColumn: ({ id: ID, name: string, section: string } | { id: null, section: string })[] = [];\r\n\t\tconst columns = [curColumn];\r\n\t\tconst searchID = toID(this.search);\r\n\t\tfor (const format of formats) {\r\n\t\t\tif (searchID && !toID(format.name).includes(searchID)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (this.gen && !format.id.startsWith(this.gen)) continue;\r\n\r\n\t\t\tif (format.column !== curColumnNum) {\r\n\t\t\t\tif (curColumn.length) {\r\n\t\t\t\t\tcurColumn = [];\r\n\t\t\t\t\tcolumns.push(curColumn);\r\n\t\t\t\t}\r\n\t\t\t\tcurColumnNum = format.column;\r\n\t\t\t}\r\n\t\t\tif (format.section !== curSection) {\r\n\t\t\t\tcurSection = format.section;\r\n\t\t\t\tif (curSection) {\r\n\t\t\t\t\tcurColumn.push({ id: null, section: curSection });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcurColumn.push(format);\r\n\t\t}\r\n\t\tif (this.gen && selectType === 'teambuilder') {\r\n\t\t\tcolumns[0].unshift({\r\n\t\t\t\tid: this.gen,\r\n\t\t\t\tname: `[Gen ${this.gen.slice(3)}]`,\r\n\t\t\t\tsection: 'No Format',\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst width = Math.max(columns.length, 2.1) * 225 + 30;\r\n\t\tconst noResults = curColumn.length === 0;\r\n\t\tconst starredPrefs = PS.prefs.starredformats || {};\r\n\t\t// reverse because the newest starred format should be the default\r\n\t\tconst starred = Object.keys(starredPrefs).filter(id => starredPrefs[id] === true).reverse();\r\n\t\tlet starredDone = false;\r\n\r\n\t\treturn <PSPanelWrapper room={room} width={width}><div class=\"pad\">\r\n\t\t\t{searchBar}\r\n\t\t\t{columns.map(column => (\r\n\t\t\t\t<ul class=\"options\" onClick={this.click}>\r\n\t\t\t\t\t{!starredDone && starred?.map((id, i) => {\r\n\t\t\t\t\t\tif (this.gen && !id.startsWith(this.gen)) return null;\r\n\t\t\t\t\t\tlet format = BattleFormats[id] as FormatData | undefined;\r\n\t\t\t\t\t\tif (/^gen[1-9]$/.test(id)) {\r\n\t\t\t\t\t\t\tformat ||= {\r\n\t\t\t\t\t\t\t\tid: id as ID,\r\n\t\t\t\t\t\t\t\tname: `[Gen ${id.slice(3)}]`,\r\n\t\t\t\t\t\t\t\tsection: 'No Format',\r\n\t\t\t\t\t\t\t\tchallengeShow: false,\r\n\t\t\t\t\t\t\t\tsearchShow: false,\r\n\t\t\t\t\t\t\t} as any;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!format) return null;\r\n\t\t\t\t\t\tif (i === starred.length - 1) starredDone = true;\r\n\t\t\t\t\t\tif (selectType === 'challenge' && format.challengeShow === false) return null;\r\n\t\t\t\t\t\tif (selectType === 'search' && format.searchShow === false) return null;\r\n\t\t\t\t\t\tif (selectType === 'teambuilder' && format.team) return null;\r\n\t\t\t\t\t\treturn <li><button value={format.name} class={`option${curFormat === format.id ? ' cur' : ''}`}>\r\n\t\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\r\n\t\t\t\t\t\t\t{format.section === 'No Format' && <em> (uncategorized)</em>}\r\n\t\t\t\t\t\t\t<i class=\"star fa fa-star cur\" data-cmd={`/unstar ${format.id}`}></i>\r\n\t\t\t\t\t\t</button></li>;\r\n\t\t\t\t\t})}\r\n\t\t\t\t\t{column.map(format => {\r\n\t\t\t\t\t\t// do not include starred formats\r\n\t\t\t\t\t\tif (starred.includes(format.id || '')) return '';\r\n\t\t\t\t\t\tif (format.id) {\r\n\t\t\t\t\t\t\treturn <li><button\r\n\t\t\t\t\t\t\t\tvalue={format.name}\r\n\t\t\t\t\t\t\t\tclass={`option${curFormat === format.id ? ' cur' : ''}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{format.name.replace('[Gen 8 ', '[').replace('[Gen 9] ', '').replace('[Gen 7 ', '[')}\r\n\t\t\t\t\t\t\t\t{format.section === 'No Format' && <em> (uncategorized)</em>}\r\n\t\t\t\t\t\t\t\t<i class=\"star fa fa-star-o\" data-cmd={`/star ${format.id}`}></i>\r\n\t\t\t\t\t\t\t</button></li>;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn <li><h3>{format.section}</h3></li>;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t))}\r\n\t\t\t{noResults && <p>\r\n\t\t\t\t<em>No formats{!!searchID && ` matching \"${searchID}\"`} found</em>\r\n\t\t\t</p>}\r\n\t\t\t<div style=\"float: left\"></div>\r\n\t\t</div></PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nPS.addRoomType(TeamDropdownPanel, FormatDropdownPanel);\r\n"],"mappings":"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","ignoreList":[]}